module.exports=[60208,a=>{"use strict";a.s(["CheckboxGroup",()=>u],60208);var b=a.i(8933),c=a.i(72131),d=a.i(88170),e=a.i(34952),f=a.i(54200),g=a.i(91759),h=a.i(82769),i=a.i(34916),j=a.i(28084),k=a.i(39668),l=a.i(13727),m=a.i(70216),n=a.i(5554),o=a.i(36621),p=a.i(83147),q=a.i(58464),r=a.i(65248),s=a.i(87924),t=(0,r.forwardRef)((a,r)=>{let{children:t,context:u,label:v,description:w,isInvalid:x,errorMessage:y,getGroupProps:z,getLabelProps:A,getWrapperProps:B,getDescriptionProps:C,getErrorMessageProps:D}=function(a){var q,r;let s=(0,b.useProviderContext)(),{validationBehavior:t}=(0,p.useSlottedContext)(o.FormContext)||{},{as:u,ref:v,classNames:w,children:x,label:y,radius:z,value:A,name:B,defaultValue:C,isInvalid:D,validationState:E,size:F="md",color:G="primary",orientation:H="vertical",lineThrough:I=!1,isDisabled:J=!1,validationBehavior:K=null!=(q=null!=t?t:null==s?void 0:s.validationBehavior)?q:"native",disableAnimation:L=null!=(r=null==s?void 0:s.disableAnimation)&&r,isReadOnly:M,isRequired:N,onValueChange:O,description:P,errorMessage:Q,className:R,...S}=a,T=u||"div",U="string"==typeof T,V=(0,m.useDOMRef)(v),W=(0,c.useMemo)(()=>({...S,value:A,name:B,"aria-label":(0,n.safeAriaLabel)(S["aria-label"],y),defaultValue:C,isRequired:N,isReadOnly:M,orientation:H,validationBehavior:K,isInvalid:"invalid"===E||D,onChange:(0,n.chain)(a.onChange,O)}),[A,B,y,C,N,M,H,O,D,E,K,S["aria-label"],S]),X=function(a={}){var b,d;let[e,f]=(0,k.useControlledState)(a.value,a.defaultValue||[],a.onChange),[g]=(0,c.useState)(e),h=!!a.isRequired&&0===e.length,i=(0,c.useRef)(new Map),l=(0,j.useFormValidationState)({...a,value:e}),m=l.displayValidation.isInvalid;return{...l,value:e,defaultValue:null!=(b=a.defaultValue)?b:g,setValue(b){a.isReadOnly||a.isDisabled||f(b)},isDisabled:a.isDisabled||!1,isReadOnly:a.isReadOnly||!1,isSelected:a=>e.includes(a),addValue(b){a.isReadOnly||a.isDisabled||e.includes(b)||f(e=e.concat(b))},removeValue(b){a.isReadOnly||a.isDisabled||e.includes(b)&&f(e.filter(a=>a!==b))},toggleValue(b){a.isReadOnly||a.isDisabled||(e.includes(b)?f(e.filter(a=>a!==b)):f(e.concat(b)))},setInvalid(a,b){let c=new Map(i.current);b.isInvalid?c.set(a,b):c.delete(a),i.current=c,l.updateValidation((0,j.mergeValidation)(...c.values()))},validationState:null!=(d=a.validationState)?d:m?"invalid":null,isInvalid:m,isRequired:h}}(W),{labelProps:Y,groupProps:Z,descriptionProps:$,errorMessageProps:_,validationErrors:aa,validationDetails:ab}=function(a,b){let{isDisabled:c,name:d,form:j,validationBehavior:k="aria"}=a,{isInvalid:l,validationErrors:m,validationDetails:n}=b.displayValidation,{labelProps:o,fieldProps:p,descriptionProps:q,errorMessageProps:r}=(0,h.useField)({...a,labelElementType:"span",isInvalid:l,errorMessage:a.errorMessage||m});e.checkboxGroupData.set(b,{name:d,form:j,descriptionId:q.id,errorMessageId:r.id,validationBehavior:k});let s=(0,f.filterDOMProps)(a,{labelable:!0}),{focusWithinProps:t}=(0,i.useFocusWithin)({onBlurWithin:a.onBlur,onFocusWithin:a.onFocus,onFocusWithinChange:a.onFocusChange});return{groupProps:(0,g.mergeProps)(s,{role:"group","aria-disabled":c||void 0,...p,...t}),labelProps:o,descriptionProps:q,errorMessageProps:r,isInvalid:l,validationErrors:m,validationDetails:n}}(W,X),ac=(0,c.useMemo)(()=>({size:F,color:G,radius:z,lineThrough:I,isInvalid:X.isInvalid,isDisabled:J,disableAnimation:L,validationBehavior:K,groupState:X}),[F,G,z,I,J,L,K,X.value,X.isDisabled,X.isReadOnly,X.isInvalid,X.isSelected]),ad=(0,c.useMemo)(()=>(0,d.checkboxGroup)({isRequired:N,isInvalid:X.isInvalid,disableAnimation:L}),[N,X.isInvalid,,L]),ae=(0,n.clsx)(null==w?void 0:w.base,R),af=(0,c.useCallback)(()=>({ref:V,className:ad.base({class:ae}),...(0,n.mergeProps)(Z,(0,l.filterDOMProps)(S,{enabled:U}))}),[ad,V,ae,Z,S]),ag=(0,c.useCallback)(()=>({className:ad.label({class:null==w?void 0:w.label}),...Y}),[ad,Y,null==w?void 0:w.label]),ah=(0,c.useCallback)(()=>({className:ad.wrapper({class:null==w?void 0:w.wrapper}),role:"presentation","data-orientation":H}),[ad,H,null==w?void 0:w.wrapper]),ai=(0,c.useCallback)((a={})=>({...a,...$,className:ad.description({class:(0,n.clsx)(null==w?void 0:w.description,null==a?void 0:a.className)})}),[ad,$,null==w?void 0:w.description]),aj=(0,c.useCallback)((a={})=>({...a,..._,className:ad.errorMessage({class:(0,n.clsx)(null==w?void 0:w.errorMessage,null==a?void 0:a.className)})}),[ad,_,null==w?void 0:w.errorMessage]);return{Component:T,children:x,label:y,context:ac,description:P,isInvalid:X.isInvalid,errorMessage:"function"==typeof Q?Q({isInvalid:X.isInvalid,validationErrors:aa,validationDetails:ab}):Q||(null==aa?void 0:aa.join(" ")),getGroupProps:af,getLabelProps:ag,getWrapperProps:ah,getDescriptionProps:ai,getErrorMessageProps:aj}}({...a,ref:r});return(0,s.jsxs)("div",{...z(),children:[v&&(0,s.jsx)("span",{...A(),children:v}),(0,s.jsx)("div",{...B(),children:(0,s.jsx)(q.CheckboxGroupProvider,{value:u,children:t})}),x&&y?(0,s.jsx)("div",{...D(),children:y}):w?(0,s.jsx)("div",{...C(),children:w}):null]})});t.displayName="HeroUI.CheckboxGroup";var u=t},3772,46178,a=>{"use strict";a.s(["saveCard",()=>c],3772);var b=a.i(5050),c=(0,b.createServerReference)("40a3bbb419c634524d6a140ce21a9d53414721a5e0",b.callServer,void 0,b.findSourceMapURL,"saveCard");a.s(["saveCardTag",()=>d],46178);var d=(0,b.createServerReference)("4078128b005adbc059928acefd375a4f74350142f8",b.callServer,void 0,b.findSourceMapURL,"saveCardTag")},74855,a=>{"use strict";a.s(["getTagAll",()=>c]);var b=a.i(5050),c=(0,b.createServerReference)("40daacf7929ed0e0b7bcda0eacb8675896c9cabd7f",b.callServer,void 0,b.findSourceMapURL,"getTagAll")},9938,a=>{"use strict";a.s(["FamiliarityList",()=>g,"FilterType",()=>b,"FilterTypeList",()=>c,"TagAll",()=>e,"TagNo",()=>f,"TagUnspecified",()=>d]);var b=function(a){return a.Normal="normal",a.Easy="easy",a.Unspecified="unspecified",a.Uncomplete="uncomplete",a}({});let c=[{value:"unspecified",description:"all"},{value:"normal",description:"familiarity < 6"},{value:"easy",description:"familiarity = 6"},{value:"uncomplete",description:"question or answer is empty"}],d="unspecified",e="all tagged",f="not tagged",g=[{value:0,description:"Newly Added",label:"newly added",color:"bg-slate-200"},{value:1,description:"Still Unfamiliar",label:"strange",color:"bg-red-200"},{value:2,description:"Passive Understanding",label:"known",color:"bg-orange-200"},{value:3,description:"Recognition Without Understanding",label:"familiar",color:"bg-amber-200"},{value:4,description:"Understanding in Context",label:"skilled",color:"bg-cyan-200"},{value:5,description:"Active Recall",label:"practiced",color:"bg-green-200"},{value:6,description:"Natural Usage",label:"easy & never appear again",color:"bg-lime-200"}]},38092,a=>{"use strict";a.s(["getCardTag",()=>c]);var b=a.i(5050),c=(0,b.createServerReference)("60039c04f138630300e30241672b1e6451bbc24743",b.callServer,void 0,b.findSourceMapURL,"getCardTag")},85339,a=>{"use strict";a.s(["getCardAll",()=>c]);var b=a.i(5050),c=(0,b.createServerReference)("7e06f3ad82b10ca7e52c08a7d6970f225095ab9a82",b.callServer,void 0,b.findSourceMapURL,"getCardAll")},94462,a=>{"use strict";a.s(["default",()=>E],94462);var b=a.i(87924),c=a.i(72131),d=a.i(74855),e=a.i(20094),f=a.i(9938),g=a.i(60955),h=a.i(95032),i=a.i(13046),j=a.i(27700),k=a.i(40253),l=a.i(18745),m=a.i(47977),n=a.i(43107),o=a.i(3220),p=a.i(92481),q=a.i(88206),r=a.i(3772),s=a.i(46178),t=a.i(68114),u=a.i(24738),v=a.i(60208),w=a.i(95245);function x({user_id:a,card:f}){let[g,h]=(0,c.useState)([]),[i,j]=(0,c.useState)([]),{handleSubmit:k}=(0,w.useForm)();(0,c.useEffect)(()=>{(async()=>{let b=await (0,d.getTagAll)(a);"success"===b.status&&h(b.data)})()},[a]);let l=async()=>{let b={...f,uuid:(0,t.getUUID)(),user_id:a,familiarity:0,note:(f.note?f.note+"\n":"")+`{"collect_from":${JSON.stringify(f.user_id)}, "source_uuid":${JSON.stringify(f.uuid)}}`,updated_at:new Date};if("success"!==(await (0,r.saveCard)(b)).status)return void e.toast.error("save card failed");e.toast.success("save card successfully"),"success"===(await (0,s.saveCardTag)({uuid:f.uuid,tag_list_new:i})).status?e.toast.success("save tag successfully"):e.toast.error("save tag failed")};return(0,b.jsx)("form",{onSubmit:k(l),children:(0,b.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,b.jsx)("div",{className:"flex flex-row items-center justify-start gap-1",children:g.length>0?(0,b.jsx)(v.CheckboxGroup,{color:"success",value:i,onValueChange:j,children:g.map(a=>(0,b.jsx)(u.Checkbox,{value:a.uuid,children:a.tag},a.uuid))}):(0,b.jsx)("div",{className:"px-1 pt-1",children:"not tag found"})}),(0,b.jsx)("div",{className:"flex flex-row items-center justify-end gap-1",children:(0,b.jsx)(m.Link,{as:"button",type:"submit",className:"bg-blue-500 rounded-md text-slate-50 px-2",children:"save"})})]})})}var y=a.i(38092),z=a.i(27493);function A({user_id:a,card:d,tag_list:f}){let[g,h]=(0,c.useState)(!1),[i,j]=(0,c.useState)([]),[k,l]=(0,c.useState)([]),{handleSubmit:n}=(0,w.useForm)();(0,c.useEffect)(()=>{(async()=>{h(!0);let b=await (0,y.getCardTag)(a,d.uuid);"success"===b.status&&b.data.tag_list_added&&(j(b.data.tag_list_added.sort()),l(b.data.tag_list_added.filter(a=>f.map(a=>a.uuid).includes(a)).sort())),h(!1)})()},[a,d,f]);let o=async()=>{let a={uuid:d.uuid,tag_list_new:k.filter(a=>!i.includes(a)),tag_list_remove:i.filter(a=>!k.includes(a))};"success"===(await (0,s.saveCardTag)(a)).status?e.toast.success("save tag successfully"):e.toast.error("save tag failed")};return(0,b.jsx)("form",{onSubmit:n(o),children:(0,b.jsxs)("div",{className:"flex flex-col gap-4",children:[g?(0,b.jsx)(z.CircularProgress,{}):(0,b.jsx)(v.CheckboxGroup,{color:"success",value:k,onValueChange:a=>l(a.sort()),orientation:"vertical",children:f.map(a=>(0,b.jsx)(u.Checkbox,{value:a.uuid,children:a.tag},a.uuid))}),(0,b.jsx)("div",{className:"flex flex-row items-center justify-end gap-1",children:(0,b.jsx)(m.Link,{as:"button",type:"submit",className:"bg-blue-500 rounded-md text-slate-50 px-2",isDisabled:((a,b)=>{if(a.length!==b.length)return!1;let c=[...a].sort(),d=[...b].sort();return c.every((a,b)=>a===d[b])})(i,k),children:"save"})})]})})}var B=a.i(5050),C=(0,B.createServerReference)("6041f3c9aee25643115f6faf71529d5a74ef2b1fa8",B.callServer,void 0,B.findSourceMapURL,"setCardFamiliarity");function D({user_id:a,card:d,tag_list:r}){let[s,t]=(0,c.useState)(d.familiarity),u=d.user_id===a,v=a=>u?f.FamiliarityList.map(a=>a.color)[a]:f.FamiliarityList.map(a=>a.color)[0];return(0,b.jsxs)("div",{className:`flex flex-col w-full items-start rounded-md p-1 ${v(s)}`,children:[(0,b.jsx)("div",{className:"flex flex-row w-full items-center justify-start gap-2",children:(0,b.jsx)(m.Link,{target:"_blank",className:"text-2xl text-blue-600 hover:underline",href:`/card/${d.uuid}`,children:(0,b.jsx)("pre",{className:"font-roboto leading-none text-wrap",children:d.question})})}),!u&&(0,b.jsx)(m.Link,{target:"_blank",className:"text-sm text-gray-500 hover:underline",href:`/card/market?user_id=${d.user_id}`,children:`by ${d.user_id}`}),(0,b.jsxs)("div",{className:"flex flex-row w-full items-end justify-end gap-4",children:[u&&(0,b.jsx)(q.Tooltip,{content:`current: ${s}
${f.FamiliarityList.map(a=>a.description)[s]}`,children:(0,b.jsx)(g.ButtonGroup,{variant:"solid",color:"primary",children:(0,b.jsxs)(h.Dropdown,{placement:"bottom-end",children:[(0,b.jsx)(l.DropdownTrigger,{children:(0,b.jsx)(m.Link,{as:"button",isBlock:!0,className:"text-xl",children:"set familiarity"})}),(0,b.jsx)(j.DropdownMenu,{disallowEmptySelection:!0,className:"max-w-[300px]",selectionMode:"single",defaultSelectedKeys:[s],onSelectionChange:async a=>{if(a.currentKey){let b=parseInt(a.currentKey);t(b),await C(d.uuid,b)?e.toast.success("save familiarity successfully"):e.toast.error("save familiarity failed")}},children:(0,b.jsx)(k.DropdownSection,{items:f.FamiliarityList,children:f.FamiliarityList.map(a=>(0,b.jsx)(i.DropdownItem,{description:a.description,className:`${v(a.value)}`,children:`${a.value} - ${a.label}`},a.value))})})]})})}),u&&(0,b.jsxs)(n.Popover,{placement:"left",classNames:{content:"bg-slate-200"},children:[(0,b.jsx)(p.PopoverTrigger,{children:(0,b.jsx)(m.Link,{as:"button",isBlock:!0,className:"text-xl",children:"edit tag"})}),(0,b.jsx)(o.PopoverContent,{children:(0,b.jsx)(A,{user_id:a,card:d,tag_list:r})})]}),!u&&(0,b.jsxs)(n.Popover,{placement:"top-end",classNames:{content:"bg-slate-200"},children:[(0,b.jsx)(p.PopoverTrigger,{children:(0,b.jsx)(m.Link,{as:"button",isBlock:!0,className:"text-xl",children:"collect"})}),(0,b.jsx)(o.PopoverContent,{children:(0,b.jsx)(x,{user_id:a,card:d})})]})]})]})}function E({user_id:a,card_list:f}){let[g,h]=(0,c.useState)([]);return(0,c.useEffect)(()=>{(async()=>{let b=await (0,d.getTagAll)(a);"success"===b.status?h(b.data):(console.log(b.error),e.toast.error("load data error"))})()},[a]),(0,b.jsx)("div",{className:"flex flex-col w-full gap-2",children:f.map(c=>(0,b.jsx)(D,{user_id:a,card:c,tag_list:g},c.uuid))})}}];

//# sourceMappingURL=_3524ccc5._.js.map