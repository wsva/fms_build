module.exports=[54799,(a,b,c)=>{b.exports=a.x("crypto",()=>require("crypto"))},66680,(a,b,c)=>{b.exports=a.x("node:crypto",()=>require("node:crypto"))},60955,a=>{"use strict";a.s(["ButtonGroup",()=>k],60955);var b=a.i(43105),c=a.i(65248),d=a.i(8933),e=a.i(70216),f=a.i(72131),g=a.i(5554),h=a.i(57076),i=a.i(87924),j=(0,c.forwardRef)((a,j)=>{let{Component:k,domRef:l,context:m,children:n,classNames:o,getButtonGroupProps:p}=function(a){var h,i;let j=(0,d.useProviderContext)(),[k,l]=(0,c.mapPropsVariants)(a,b.buttonGroup.variantKeys),{ref:m,as:n,children:o,color:p="default",size:q="md",variant:r="solid",radius:s,isDisabled:t=!1,isIconOnly:u=!1,disableRipple:v=null!=(h=null==j?void 0:j.disableRipple)&&h,disableAnimation:w=null!=(i=null==j?void 0:j.disableAnimation)&&i,className:x,...y}=k,z=(0,e.useDOMRef)(m),A=(0,f.useMemo)(()=>(0,b.buttonGroup)({...l,className:x}),[(0,g.objectToDeps)(l),x]),B=(0,f.useMemo)(()=>({size:q,color:p,variant:r,radius:s,isIconOnly:u,isDisabled:t,disableAnimation:w,disableRipple:v,fullWidth:!!(null==a?void 0:a.fullWidth)}),[q,p,r,s,t,u,w,v,null==a?void 0:a.fullWidth]);return{Component:n||"div",children:o,domRef:z,context:B,classNames:A,getButtonGroupProps:(0,f.useCallback)(()=>({role:"group",...y}),[y])}}({...a,ref:j});return(0,i.jsx)(h.ButtonGroupProvider,{value:m,children:(0,i.jsx)(k,{ref:l,className:o,...p(),children:n})})});j.displayName="HeroUI.ButtonGroup";var k=j},70468,a=>{"use strict";a.s(["getTagAll",()=>c]);var b=a.i(5050),c=(0,b.createServerReference)("40cd43189d4eaf3fe9930825f57647d977c9eea7c7",b.callServer,void 0,b.findSourceMapURL,"getTagAll")},69532,9938,a=>{"use strict";a.s(["BaseSection",()=>d],69532);var b=a.i(72131);function c(a){return null}c.getCollectionNode=function*(a){let{children:c,title:d,items:e}=a;yield{type:"section",props:a,hasChildNodes:!0,rendered:d,"aria-label":a["aria-label"],*childNodes(){if("function"==typeof c){if(!e)throw Error("props.children was a function but props.items is missing");for(let a of e)yield{type:"item",value:a,renderer:c}}else{let a=[];b.default.Children.forEach(c,b=>{a.push({type:"item",element:b})}),yield*a}}}};let d=c;a.s(["FamiliarityList",()=>j,"FilterType",()=>e,"FilterTypeList",()=>f,"TagAll",()=>h,"TagNo",()=>i,"TagUnspecified",()=>g],9938);var e=function(a){return a.Normal="normal",a.Easy="easy",a.Unspecified="unspecified",a.Uncomplete="uncomplete",a}({});let f=[{value:"unspecified",description:"all"},{value:"normal",description:"familiarity < 6"},{value:"easy",description:"familiarity = 6"},{value:"uncomplete",description:"question or answer is empty"}],g="unspecified",h="all tagged",i="not tagged";!function(a){a[a.NewlyAdded=0]="NewlyAdded",a[a.StillUnfamiliar=1]="StillUnfamiliar",a[a.PassiveUnderstanding=2]="PassiveUnderstanding",a[a.RecognitionWithoutUnderstanding=3]="RecognitionWithoutUnderstanding",a[a.UnderstandingInContext=4]="UnderstandingInContext",a[a.ActiveRecall=5]="ActiveRecall",a[a.NaturalUsage=6]="NaturalUsage"}({});let j=[{value:0,description:"Newly Added",label:"newly added",color:"bg-slate-200"},{value:1,description:"Still Unfamiliar",label:"strange",color:"bg-red-200"},{value:2,description:"Passive Understanding",label:"known",color:"bg-orange-200"},{value:3,description:"Recognition Without Understanding",label:"familiar",color:"bg-amber-200"},{value:4,description:"Understanding in Context",label:"skilled",color:"bg-cyan-200"},{value:5,description:"Active Recall",label:"practiced",color:"bg-green-200"},{value:6,description:"Natural Usage",label:"easy & never appear again",color:"bg-lime-200"}]},28165,a=>{"use strict";a.s(["getCardTag",()=>c]);var b=a.i(5050),c=(0,b.createServerReference)("607b859224a98e3d82666c2f5f6125fae61b39999d",b.callServer,void 0,b.findSourceMapURL,"getCardTag")},66504,a=>{"use strict";a.s(["SelectSection",()=>b],66504);var b=a.i(69532).BaseSection},98495,a=>{"use strict";a.s(["default",()=>y],98495);var b=a.i(87924),c=a.i(68114),d=a.i(32496),e=a.i(60955),f=a.i(24738),g=a.i(60208),h=a.i(97488),i=a.i(47977),j=a.i(4655),k=a.i(24647),l=a.i(66504),m=a.i(84476),n=a.i(72131),o=a.i(50944),p=a.i(95245),q=a.i(20094),r=a.i(28165),s=a.i(70468),t=a.i(5050),u=(0,t.createServerReference)("4042b5da45a53726d46cca8fbfa1c30d438d2488e0",t.callServer,void 0,t.findSourceMapURL,"removeCard"),v=a.i(76193),w=a.i(83469),x=a.i(9938);function y({card_ext:a,email:t,edit_view:y,simple:z,create_new:A}){let B=(0,o.useSearchParams)(),[C,D]=(0,n.useState)(y),[E,F]=(0,n.useState)(),[G,H]=(0,n.useState)([]),[I,J]=(0,n.useState)([]),[K,L]=(0,n.useState)([]),{register:M,handleSubmit:N,formState:O,watch:P}=(0,p.useForm)({}),Q=(0,n.useRef)(null),{ref:R,...S}=M("answer"),T=(0,n.useRef)(null);(0,n.useEffect)(()=>{(async()=>{let b=await (0,s.getTagAll)(t);if("success"!==b.status)return;H(b.data);let d=a.uuid&&a.user_id===t?a.uuid:(0,c.getUUID)();F({uuid:d,user_id:t,question:a.question||"",suggestion:a.suggestion||"",answer:a.answer||"",familiarity:a.familiarity&&a.user_id===t?a.familiarity:0,note:a.note||"",created_at:a.created_at||new Date,updated_at:a.updated_at||new Date});let e=await (0,r.getCardTag)(t,d);"success"===e.status&&e.data.tag_list_added&&(J(e.data.tag_list_added),L((a.tag_list_suggestion?Array.from(new Set([...e.data.tag_list_added,...a.tag_list_suggestion])):e.data.tag_list_added).filter(a=>b.data.map(a=>a.uuid).includes(a))))})();let b=a=>{let b=navigator.userAgent.includes("Mac");(b&&a.metaKey&&"s"===a.key||!b&&a.ctrlKey&&"s"===a.key)&&(a.preventDefault(),Q.current?.requestSubmit())};return window.addEventListener("keydown",b),()=>{window.removeEventListener("keydown",b)}},[]);let U=b=>{if(a){let d=(0,c.getProperty)(a,b);if(d)return d}let d=B.get(b);if(d)return decodeURIComponent(d)},V=a=>x.FamiliarityList.map(a=>a.color)[a],W=async(a,b)=>{if(!T.current)return;let c=T.current,d=c.selectionStart,e=c.selectionEnd,f=c.value,g=f.slice(0,d)+a+f.slice(d,e)+b+f.slice(e);c.value=g,T.current.value=g,setTimeout(()=>{c.focus();let f=a.length+b.length;d<e?c.setSelectionRange(d,e+f):c.setSelectionRange(d+f,e+f)},0)},X=async a=>E?(a.familiarity||(a.familiarity=0),"string"==typeof a.familiarity&&(a.familiarity=parseInt(a.familiarity||"0",10)),"success"!==(await (0,v.saveCard)({...E,...a,created_at:E?.created_at?E.created_at:new Date,updated_at:new Date})).status)?void q.toast.error("save card failed"):(q.toast.success("save card success"),"success"!==(await (0,w.saveCardTag)({uuid:E.uuid,tag_list_new:K.filter(a=>!I.includes(a)),tag_list_remove:I.filter(a=>!K.includes(a))})).status)?void q.toast.error("save tag failed"):(q.toast.success("save tag successfully"),J(K),void(A&&setTimeout(()=>{window.location.reload()},1e3))):void q.toast.error("loading");return(0,b.jsx)("form",{ref:Q,onSubmit:N(X),children:(0,b.jsxs)("div",{className:"w-full space-y-4 mb-10 px-2",children:[E&&E.user_id!==t&&(0,b.jsx)("div",{className:"flex flex-row my-1 items-start justify-start gap-4",children:(0,b.jsx)(i.Link,{className:"text-blue-500 underline",target:"_blank",href:`/card/others?user_id=${E.user_id}`,children:E.user_id})}),(0,b.jsxs)("div",{className:"flex flex-row my-1 items-end justify-end gap-4",children:[(0,b.jsx)(d.Button,{color:"primary",variant:"solid",size:"sm",onPress:()=>D(!C),children:C?"View":"Edit"}),(0,b.jsx)(d.Button,{color:"primary",type:"submit",variant:"solid",size:"sm",isLoading:O.isSubmitting,children:"Save"}),(0,b.jsx)(d.Button,{color:"danger",variant:"solid",size:"sm",onPress:async()=>{E?.uuid&&("success"==(await u(E.uuid)).status?q.toast.error("remove card successfully"):q.toast.error("remove card failed"))},children:"Remove"})]}),C?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(m.Textarea,{label:"question",classNames:{input:"text-xl leading-tight font-roboto"},defaultValue:U("question")||"",...M("question")}),!z&&(0,b.jsx)(j.Select,{"aria-label":"select familiarity",selectionMode:"single",defaultSelectedKeys:[`${P("familiarity",U("familiarity")||0)}`],...M("familiarity"),children:(0,b.jsx)(l.SelectSection,{items:x.FamiliarityList,children:x.FamiliarityList.map(a=>(0,b.jsx)(k.SelectItem,{className:`${V(a.value)}`,children:`${a.value} - ${a.label}`},a.value))})}),(0,b.jsx)(g.CheckboxGroup,{color:"success",value:K,onValueChange:L,orientation:"horizontal",children:G.map(a=>(0,b.jsx)(f.Checkbox,{value:a.uuid,children:a.tag},a.uuid))}),!z&&(0,b.jsx)(m.Textarea,{label:"suggestion",classNames:{input:"text-xl leading-tight font-roboto"},minRows:1,maxRows:3,defaultValue:U("suggestion")||"",...M("suggestion")}),(0,b.jsxs)("div",{className:"flex flex-col gap-1 px-3 py-0.5 bg-default-100 hover:bg-default-200 rounded-medium",children:[(0,b.jsx)("label",{className:"text-foreground-500 text-small pb-0.5 pe-2 max-w-full text-ellipsis overflow-hidden",children:"answer"}),(0,b.jsxs)(e.ButtonGroup,{size:"sm",radius:"none",className:"flex flex-row items-center justify-start gap-1",children:[["#","â¬Œ","â– ","=","â‰ˆ","âž¤","ðŸ¡†"].map((a,c)=>(0,b.jsx)(d.Button,{isIconOnly:!0,className:"text-xl",onPress:()=>W(a,""),children:a},`char1-${c}`)),["Ã¤","Ã„","Ã¶","Ã–","Ã¼","Ãœ","ÃŸ","Ã©","â‚¬"].map((a,c)=>(0,b.jsx)(d.Button,{isIconOnly:!0,className:"text-xl",onPress:()=>W(a,""),children:a},`char2-${c}`)),[["B","**","**"],["â€žâ€œ","â€ž","â€œ"],["â€šâ€˜","â€š","â€˜"],["C","`````\n","\n`````"]].map((a,c)=>(0,b.jsx)(d.Button,{isIconOnly:!0,className:"text-xl",onPress:()=>W(a[1],a[2]),children:a[0]},`char3-${c}`))]}),(0,b.jsx)("textarea",{className:"w-full text-xl leading-tight font-roboto px-1.5 outline-none bg-transparent resize-none",defaultValue:U("answer")||"",rows:10,autoComplete:"off",autoCorrect:"off",spellCheck:"false",...S,ref:a=>{R(a),T.current=a}})]}),(0,b.jsx)(m.Textarea,{label:"note",classNames:{input:"text-xl leading-tight font-roboto"},defaultValue:U("note")||"",...M("note")})]}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("pre",{className:"text-3xl leading-tight font-roboto font-bold text-wrap",children:P("question",U("question")||"")}),(0,b.jsx)(h.Divider,{}),(0,b.jsx)(j.Select,{"aria-label":"select familiarity",selectionMode:"single",isDisabled:!0,defaultSelectedKeys:[`${P("familiarity",U("familiarity")||0)}`],...M("familiarity"),children:(0,b.jsx)(l.SelectSection,{items:x.FamiliarityList,children:x.FamiliarityList.map(a=>(0,b.jsx)(k.SelectItem,{className:`${V(a.value)}`,children:`${a.value} - ${a.label}`},a.value))})}),(0,b.jsx)(g.CheckboxGroup,{color:"success",value:K,onValueChange:L,orientation:"horizontal",isDisabled:!0,children:G.filter(a=>K.includes(a.uuid)).map(a=>(0,b.jsx)(f.Checkbox,{value:a.uuid,children:a.tag},a.uuid))}),(0,b.jsx)(h.Divider,{}),(0,b.jsx)("div",{className:"text-md font-roboto mx-8",children:P("suggestion",U("suggestion")||"")}),(0,b.jsx)(h.Divider,{}),(0,b.jsx)("div",{className:"MD my-1 text-xl leading-tight font-roboto indent-0 whitespace-pre-wrap break-words hyphens-auto",dangerouslySetInnerHTML:{__html:(0,c.getHTML)(P("answer",U("answer"))||"")}}),(0,b.jsx)(h.Divider,{}),(0,b.jsx)("pre",{className:"text-md font-roboto mx-8",children:P("note",U("note")||"")})]})]})})}},80672,a=>{a.v(b=>Promise.all(["server/chunks/ssr/node_modules_@heroui_dom-animation_dist_index_mjs_10ddab32._.js"].map(b=>a.l(b))).then(()=>b(61831)))}];

//# sourceMappingURL=%5Broot-of-the-server%5D__27e0ad7a._.js.map