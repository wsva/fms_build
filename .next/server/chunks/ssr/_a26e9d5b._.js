module.exports=[9938,a=>{"use strict";a.s(["FamiliarityList",()=>g,"FilterType",()=>b,"FilterTypeList",()=>c,"TagAll",()=>e,"TagNo",()=>f,"TagUnspecified",()=>d]);var b=function(a){return a.Normal="normal",a.Easy="easy",a.Unspecified="unspecified",a.Uncomplete="uncomplete",a}({});let c=[{value:"unspecified",description:"all"},{value:"normal",description:"familiarity < 6"},{value:"easy",description:"familiarity = 6"},{value:"uncomplete",description:"question or answer is empty"}],d="unspecified",e="all tagged",f="not tagged",g=[{value:0,description:"Newly Added",label:"newly added",color:"bg-slate-200"},{value:1,description:"Still Unfamiliar",label:"strange",color:"bg-red-200"},{value:2,description:"Passive Understanding",label:"known",color:"bg-orange-200"},{value:3,description:"Recognition Without Understanding",label:"familiar",color:"bg-amber-200"},{value:4,description:"Understanding in Context",label:"skilled",color:"bg-cyan-200"},{value:5,description:"Active Recall",label:"practiced",color:"bg-green-200"},{value:6,description:"Natural Usage",label:"easy & never appear again",color:"bg-lime-200"}]},42457,a=>{"use strict";a.s(["getTagAll",()=>c]);var b=a.i(5050),c=(0,b.createServerReference)("40f97ca1f6dc7d317adfb9bbd13080c1ce681a7b02",b.callServer,void 0,b.findSourceMapURL,"getTagAll")},60955,a=>{"use strict";a.s(["ButtonGroup",()=>k],60955);var b=a.i(43105),c=a.i(65248),d=a.i(8933),e=a.i(70216),f=a.i(72131),g=a.i(5554),h=a.i(57076),i=a.i(87924),j=(0,c.forwardRef)((a,j)=>{let{Component:k,domRef:l,context:m,children:n,classNames:o,getButtonGroupProps:p}=function(a){var h,i;let j=(0,d.useProviderContext)(),[k,l]=(0,c.mapPropsVariants)(a,b.buttonGroup.variantKeys),{ref:m,as:n,children:o,color:p="default",size:q="md",variant:r="solid",radius:s,isDisabled:t=!1,isIconOnly:u=!1,disableRipple:v=null!=(h=null==j?void 0:j.disableRipple)&&h,disableAnimation:w=null!=(i=null==j?void 0:j.disableAnimation)&&i,className:x,...y}=k,z=(0,e.useDOMRef)(m),A=(0,f.useMemo)(()=>(0,b.buttonGroup)({...l,className:x}),[(0,g.objectToDeps)(l),x]),B=(0,f.useMemo)(()=>({size:q,color:p,variant:r,radius:s,isIconOnly:u,isDisabled:t,disableAnimation:w,disableRipple:v,fullWidth:!!(null==a?void 0:a.fullWidth)}),[q,p,r,s,t,u,w,v,null==a?void 0:a.fullWidth]);return{Component:n||"div",children:o,domRef:z,context:B,classNames:A,getButtonGroupProps:(0,f.useCallback)(()=>({role:"group",...y}),[y])}}({...a,ref:j});return(0,i.jsx)(h.ButtonGroupProvider,{value:m,children:(0,i.jsx)(k,{ref:l,className:o,...p(),children:n})})});j.displayName="HeroUI.ButtonGroup";var k=j},74380,a=>{"use strict";a.s(["saveCardTag",()=>c]);var b=a.i(5050),c=(0,b.createServerReference)("40305d779f60c17fd2093520e6d1df9ced6325e5e7",b.callServer,void 0,b.findSourceMapURL,"saveCardTag")},60208,a=>{"use strict";a.s(["CheckboxGroup",()=>u],60208);var b=a.i(8933),c=a.i(72131),d=a.i(88170),e=a.i(34952),f=a.i(54200),g=a.i(91759),h=a.i(82769),i=a.i(34916),j=a.i(28084),k=a.i(39668),l=a.i(13727),m=a.i(70216),n=a.i(5554),o=a.i(36621),p=a.i(83147),q=a.i(58464),r=a.i(65248),s=a.i(87924),t=(0,r.forwardRef)((a,r)=>{let{children:t,context:u,label:v,description:w,isInvalid:x,errorMessage:y,getGroupProps:z,getLabelProps:A,getWrapperProps:B,getDescriptionProps:C,getErrorMessageProps:D}=function(a){var q,r;let s=(0,b.useProviderContext)(),{validationBehavior:t}=(0,p.useSlottedContext)(o.FormContext)||{},{as:u,ref:v,classNames:w,children:x,label:y,radius:z,value:A,name:B,defaultValue:C,isInvalid:D,validationState:E,size:F="md",color:G="primary",orientation:H="vertical",lineThrough:I=!1,isDisabled:J=!1,validationBehavior:K=null!=(q=null!=t?t:null==s?void 0:s.validationBehavior)?q:"native",disableAnimation:L=null!=(r=null==s?void 0:s.disableAnimation)&&r,isReadOnly:M,isRequired:N,onValueChange:O,description:P,errorMessage:Q,className:R,...S}=a,T=u||"div",U="string"==typeof T,V=(0,m.useDOMRef)(v),W=(0,c.useMemo)(()=>({...S,value:A,name:B,"aria-label":(0,n.safeAriaLabel)(S["aria-label"],y),defaultValue:C,isRequired:N,isReadOnly:M,orientation:H,validationBehavior:K,isInvalid:"invalid"===E||D,onChange:(0,n.chain)(a.onChange,O)}),[A,B,y,C,N,M,H,O,D,E,K,S["aria-label"],S]),X=function(a={}){var b,d;let[e,f]=(0,k.useControlledState)(a.value,a.defaultValue||[],a.onChange),[g]=(0,c.useState)(e),h=!!a.isRequired&&0===e.length,i=(0,c.useRef)(new Map),l=(0,j.useFormValidationState)({...a,value:e}),m=l.displayValidation.isInvalid;return{...l,value:e,defaultValue:null!=(b=a.defaultValue)?b:g,setValue(b){a.isReadOnly||a.isDisabled||f(b)},isDisabled:a.isDisabled||!1,isReadOnly:a.isReadOnly||!1,isSelected:a=>e.includes(a),addValue(b){a.isReadOnly||a.isDisabled||e.includes(b)||f(e=e.concat(b))},removeValue(b){a.isReadOnly||a.isDisabled||e.includes(b)&&f(e.filter(a=>a!==b))},toggleValue(b){a.isReadOnly||a.isDisabled||(e.includes(b)?f(e.filter(a=>a!==b)):f(e.concat(b)))},setInvalid(a,b){let c=new Map(i.current);b.isInvalid?c.set(a,b):c.delete(a),i.current=c,l.updateValidation((0,j.mergeValidation)(...c.values()))},validationState:null!=(d=a.validationState)?d:m?"invalid":null,isInvalid:m,isRequired:h}}(W),{labelProps:Y,groupProps:Z,descriptionProps:$,errorMessageProps:_,validationErrors:aa,validationDetails:ab}=function(a,b){let{isDisabled:c,name:d,form:j,validationBehavior:k="aria"}=a,{isInvalid:l,validationErrors:m,validationDetails:n}=b.displayValidation,{labelProps:o,fieldProps:p,descriptionProps:q,errorMessageProps:r}=(0,h.useField)({...a,labelElementType:"span",isInvalid:l,errorMessage:a.errorMessage||m});e.checkboxGroupData.set(b,{name:d,form:j,descriptionId:q.id,errorMessageId:r.id,validationBehavior:k});let s=(0,f.filterDOMProps)(a,{labelable:!0}),{focusWithinProps:t}=(0,i.useFocusWithin)({onBlurWithin:a.onBlur,onFocusWithin:a.onFocus,onFocusWithinChange:a.onFocusChange});return{groupProps:(0,g.mergeProps)(s,{role:"group","aria-disabled":c||void 0,...p,...t}),labelProps:o,descriptionProps:q,errorMessageProps:r,isInvalid:l,validationErrors:m,validationDetails:n}}(W,X),ac=(0,c.useMemo)(()=>({size:F,color:G,radius:z,lineThrough:I,isInvalid:X.isInvalid,isDisabled:J,disableAnimation:L,validationBehavior:K,groupState:X}),[F,G,z,I,J,L,K,X.value,X.isDisabled,X.isReadOnly,X.isInvalid,X.isSelected]),ad=(0,c.useMemo)(()=>(0,d.checkboxGroup)({isRequired:N,isInvalid:X.isInvalid,disableAnimation:L}),[N,X.isInvalid,,L]),ae=(0,n.clsx)(null==w?void 0:w.base,R),af=(0,c.useCallback)(()=>({ref:V,className:ad.base({class:ae}),...(0,n.mergeProps)(Z,(0,l.filterDOMProps)(S,{enabled:U}))}),[ad,V,ae,Z,S]),ag=(0,c.useCallback)(()=>({className:ad.label({class:null==w?void 0:w.label}),...Y}),[ad,Y,null==w?void 0:w.label]),ah=(0,c.useCallback)(()=>({className:ad.wrapper({class:null==w?void 0:w.wrapper}),role:"presentation","data-orientation":H}),[ad,H,null==w?void 0:w.wrapper]),ai=(0,c.useCallback)((a={})=>({...a,...$,className:ad.description({class:(0,n.clsx)(null==w?void 0:w.description,null==a?void 0:a.className)})}),[ad,$,null==w?void 0:w.description]),aj=(0,c.useCallback)((a={})=>({...a,..._,className:ad.errorMessage({class:(0,n.clsx)(null==w?void 0:w.errorMessage,null==a?void 0:a.className)})}),[ad,_,null==w?void 0:w.errorMessage]);return{Component:T,children:x,label:y,context:ac,description:P,isInvalid:X.isInvalid,errorMessage:"function"==typeof Q?Q({isInvalid:X.isInvalid,validationErrors:aa,validationDetails:ab}):Q||(null==aa?void 0:aa.join(" ")),getGroupProps:af,getLabelProps:ag,getWrapperProps:ah,getDescriptionProps:ai,getErrorMessageProps:aj}}({...a,ref:r});return(0,s.jsxs)("div",{...z(),children:[v&&(0,s.jsx)("span",{...A(),children:v}),(0,s.jsx)("div",{...B(),children:(0,s.jsx)(q.CheckboxGroupProvider,{value:u,children:t})}),x&&y?(0,s.jsx)("div",{...D(),children:y}):w?(0,s.jsx)("div",{...C(),children:w}):null]})});t.displayName="HeroUI.CheckboxGroup";var u=t},62963,a=>{"use strict";a.s(["saveCard",()=>c]);var b=a.i(5050),c=(0,b.createServerReference)("4014a919cd0df64d02968e6a57211f54eff41bcd8e",b.callServer,void 0,b.findSourceMapURL,"saveCard")},67428,a=>{"use strict";a.s(["getCardTag",()=>c]);var b=a.i(5050),c=(0,b.createServerReference)("608f8404354617f37415598d97b71d84aa29a1a9de",b.callServer,void 0,b.findSourceMapURL,"getCardTag")},94462,a=>{"use strict";a.s(["default",()=>E],94462);var b=a.i(87924),c=a.i(60955),d=a.i(47977),e=a.i(21694),f=a.i(3220),g=a.i(92481),h=a.i(88206),i=a.i(95032),j=a.i(13046),k=a.i(27700),l=a.i(40253),m=a.i(18745),n=a.i(72131),o=a.i(67428),p=a.i(42457),q=a.i(74380),r=a.i(24738),s=a.i(60208),t=a.i(27493),u=a.i(95245),v=a.i(20094);function w({email:a,card:c,tag_list:e}){let[f,g]=(0,n.useState)(!1),[h,i]=(0,n.useState)(e||[]),[j,k]=(0,n.useState)([]),[l,m]=(0,n.useState)([]),{handleSubmit:w}=(0,u.useForm)();(0,n.useEffect)(()=>{(async()=>{g(!0);let b=h;if(0==h.length){let c=await (0,p.getTagAll)(a);if("success"!==c.status)return;b=c.data,i(c.data)}let d=await (0,o.getCardTag)(a,c.uuid);"success"===d.status&&d.data.tag_list_added&&(k(d.data.tag_list_added),m(d.data.tag_list_added.filter(a=>b.map(a=>a.uuid).includes(a)))),g(!1)})()},[]);let x=async()=>{let a={uuid:c.uuid,tag_list_new:l.filter(a=>!j.includes(a)),tag_list_remove:j.filter(a=>!l.includes(a))};"success"===(await (0,q.saveCardTag)(a)).status?v.toast.success("save tag successfully"):v.toast.error("save tag failed")};return(0,b.jsx)(b.Fragment,{children:f?(0,b.jsx)(t.CircularProgress,{}):(0,b.jsx)("form",{onSubmit:w(x),children:(0,b.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,b.jsx)("div",{className:"flex flex-row items-center justify-start gap-1",children:h.length>0?(0,b.jsx)(s.CheckboxGroup,{color:"success",value:l,onValueChange:m,orientation:"vertical",children:h.map(a=>(0,b.jsx)(r.Checkbox,{value:a.uuid,children:a.tag},a.uuid))}):(0,b.jsx)("div",{children:"not tag found"})}),(0,b.jsx)("div",{className:"flex flex-row items-center justify-end gap-1",children:(0,b.jsx)(d.Link,{as:"button",type:"submit",className:"bg-blue-500 rounded-md text-slate-50 px-2",children:"save"})})]})})})}var x=a.i(9938),y=a.i(5050),z=(0,y.createServerReference)("6001e2a2fde33e3ddada6fd268033f9d1ec7d2ae1b",y.callServer,void 0,y.findSourceMapURL,"setCardFamiliarity"),A=a.i(62963),B=a.i(68114);function C({email:a,card:c}){let[e,f]=(0,n.useState)([]),[g,h]=(0,n.useState)([]),{handleSubmit:i}=(0,u.useForm)();(0,n.useEffect)(()=>{(async()=>{let b=await (0,p.getTagAll)(a);"success"===b.status&&f(b.data)})()},[]);let j=async()=>{let b={...c,uuid:(0,B.getUUID)(),user_id:a,familiarity:0,note:(c.note?c.note+"\n":"")+`{"collect_from":${JSON.stringify(c.user_id)}, "source_uuid":${JSON.stringify(c.uuid)}}`,updated_at:new Date};if("success"!==(await (0,A.saveCard)(b)).status)return void v.toast.error("save card failed");v.toast.success("save card successfully"),"success"===(await (0,q.saveCardTag)({uuid:c.uuid,tag_list_new:g})).status?v.toast.success("save tag successfully"):v.toast.error("save tag failed")};return(0,b.jsx)("form",{onSubmit:i(j),children:(0,b.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,b.jsx)("div",{className:"flex flex-row items-center justify-start gap-1",children:e.length>0?(0,b.jsx)(s.CheckboxGroup,{color:"success",value:g,onValueChange:h,children:e.map(a=>(0,b.jsx)(r.Checkbox,{value:a.uuid,children:a.tag},a.uuid))}):(0,b.jsx)("div",{className:"px-1 pt-1",children:"not tag found"})}),(0,b.jsx)("div",{className:"flex flex-row items-center justify-end gap-1",children:(0,b.jsx)(d.Link,{as:"button",type:"submit",className:"bg-blue-500 rounded-md text-slate-50 px-2",children:"save"})})]})})}function D({email:a,card:o,edit_view:p,tag_list:q}){let[r,s]=(0,n.useState)(o.familiarity),t=o.user_id===a,u=a=>t?x.FamiliarityList.map(a=>a.color)[a]:x.FamiliarityList.map(a=>a.color)[0];return(0,b.jsxs)("div",{className:`flex flex-col w-full items-start rounded-md p-1 ${u(r)}`,children:[(0,b.jsx)("div",{className:"flex flex-row w-full items-center justify-start gap-2",children:(0,b.jsx)(d.Link,{target:"_blank",href:`/card/${o.uuid}${p?"?edit=y":""}`,className:"text-2xl text-blue-600 hover:underline",children:(0,b.jsx)("pre",{className:"font-roboto leading-none text-wrap",children:o.question})})}),!t&&(0,b.jsx)(d.Link,{target:"_blank",href:`/card/market?user_id=${o.user_id}`,className:"text-sm text-gray-500 hover:underline",children:`by ${o.user_id}`}),(0,b.jsxs)("div",{className:"flex flex-row w-full items-end justify-end gap-4",children:[t&&(0,b.jsx)(h.Tooltip,{content:`current: ${r}
${x.FamiliarityList.map(a=>a.description)[r]}`,children:(0,b.jsx)(c.ButtonGroup,{variant:"solid",color:"primary",children:(0,b.jsxs)(i.Dropdown,{placement:"bottom-end",children:[(0,b.jsx)(m.DropdownTrigger,{children:(0,b.jsx)(d.Link,{as:"button",isBlock:!0,className:"text-xl",children:"set familiarity"})}),(0,b.jsx)(k.DropdownMenu,{disallowEmptySelection:!0,className:"max-w-[300px]",selectionMode:"single",defaultSelectedKeys:[r],onSelectionChange:async a=>{if(a.currentKey){let b=parseInt(a.currentKey);s(b),await z(o.uuid,b)?v.toast.success("save familiarity successfully"):v.toast.error("save familiarity failed")}},children:(0,b.jsx)(l.DropdownSection,{items:x.FamiliarityList,children:x.FamiliarityList.map(a=>(0,b.jsx)(j.DropdownItem,{description:a.description,className:`${u(a.value)}`,children:`${a.value} - ${a.label}`},a.value))})})]})})}),t&&(0,b.jsxs)(e.Popover,{placement:"top-end",classNames:{content:"bg-slate-200"},children:[(0,b.jsx)(g.PopoverTrigger,{children:(0,b.jsx)(d.Link,{as:"button",isBlock:!0,className:"text-xl",children:"edit tag"})}),(0,b.jsx)(f.PopoverContent,{children:(0,b.jsx)(w,{email:a,card:o,tag_list:q||[]})})]}),!t&&(0,b.jsxs)(e.Popover,{placement:"top-end",classNames:{content:"bg-slate-200"},children:[(0,b.jsx)(g.PopoverTrigger,{children:(0,b.jsx)(d.Link,{as:"button",isBlock:!0,className:"text-xl",children:"collect"})}),(0,b.jsx)(f.PopoverContent,{children:(0,b.jsx)(C,{email:a,card:o})})]})]})]})}function E({email:a,edit_view:c,card_list:d}){return(0,b.jsx)("div",{className:"flex flex-col w-full gap-2",children:d.map(d=>(0,b.jsx)(D,{email:a,card:d,edit_view:c},d.uuid))})}}];

//# sourceMappingURL=_a26e9d5b._.js.map