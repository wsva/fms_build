module.exports=[47977,a=>{"use strict";a.s(["Link",()=>s],47977);var b=a.i(93611),c=a.i(10475),d=(0,b.tv)({base:["relative inline-flex items-center outline-solid outline-transparent tap-highlight-transparent",...c.dataFocusVisibleClasses],variants:{size:{sm:"text-small",md:"text-medium",lg:"text-large"},color:{foreground:"text-foreground",primary:"text-primary",secondary:"text-secondary",success:"text-success",warning:"text-warning",danger:"text-danger"},underline:{none:"no-underline",hover:"hover:underline",always:"underline",active:"active:underline",focus:"focus:underline"},isBlock:{true:["px-2","py-1","hover:after:opacity-100","after:content-['']","after:inset-0","after:opacity-0","after:w-full","after:h-full","after:rounded-xl","after:transition-background","after:absolute"],false:"hover:opacity-hover active:opacity-disabled transition-opacity"},isDisabled:{true:"opacity-disabled cursor-default pointer-events-none"},disableAnimation:{true:"after:transition-none transition-none"}},compoundVariants:[{isBlock:!0,color:"foreground",class:"hover:after:bg-foreground/10"},{isBlock:!0,color:"primary",class:"hover:after:bg-primary/20"},{isBlock:!0,color:"secondary",class:"hover:after:bg-secondary/20"},{isBlock:!0,color:"success",class:"hover:after:bg-success/20"},{isBlock:!0,color:"warning",class:"hover:after:bg-warning/20"},{isBlock:!0,color:"danger",class:"hover:after:bg-danger/20"},{underline:["hover","always","active","focus"],class:"underline-offset-4"}],defaultVariants:{color:"primary",size:"md",isBlock:!1,underline:"none",isDisabled:!1}}),e=a.i(54200),f=a.i(91759),g=a.i(86546),h=a.i(7186),i=a.i(64373),j=a.i(65248),k=a.i(8933),l=a.i(70216),m=a.i(343),n=a.i(5554),o=a.i(72131),p=a.i(87924),q=a=>(0,p.jsxs)("svg",{"aria-hidden":"true",fill:"none",focusable:"false",height:"1em",shapeRendering:"geometricPrecision",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",viewBox:"0 0 24 24",width:"1em",...a,children:[(0,p.jsx)("path",{d:"M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"}),(0,p.jsx)("path",{d:"M15 3h6v6"}),(0,p.jsx)("path",{d:"M10 14L21 3"})]}),r=(0,j.forwardRef)((a,b)=>{let{Component:c,children:r,showAnchorIcon:s,anchorIcon:t=(0,p.jsx)(q,{className:"flex mx-1 text-current self-center"}),getLinkProps:u}=function(a){var b,c,p,q;let r=(0,k.useProviderContext)(),[s,t]=(0,j.mapPropsVariants)(a,d.variantKeys),{ref:u,as:v,children:w,anchorIcon:x,isExternal:y=!1,showAnchorIcon:z=!1,autoFocus:A=!1,className:B,onPress:C,onPressStart:D,onPressEnd:E,onClick:F,...G}=s,H=(0,l.useDOMRef)(u),I=null!=(c=null!=(b=null==a?void 0:a.disableAnimation)?b:null==r?void 0:r.disableAnimation)&&c,{linkProps:J}=function(a,b){let{elementType:c="a",onPress:d,onPressStart:j,onPressEnd:k,onClick:l,isDisabled:m,...n}=a,o={};"a"!==c&&(o={role:"link",tabIndex:m?void 0:0});let{focusableProps:p}=(0,h.useFocusable)(a,b),{pressProps:q,isPressed:r}=(0,i.usePress)({onClick:l,onPress:d,onPressStart:j,onPressEnd:k,isDisabled:m,ref:b}),s=(0,e.filterDOMProps)(n,{labelable:!0,isLink:"a"===c}),t=(0,f.mergeProps)(p,q),u=(0,g.useRouter)(),v=(0,g.useLinkProps)(a);return{isPressed:r,linkProps:(0,f.mergeProps)(s,v,{...t,...o,"aria-disabled":m||void 0,"aria-current":a["aria-current"],onClick:b=>{var c;null==(c=q.onClick)||c.call(q,b),(0,g.handleLinkClick)(b,u,a.href,a.routerOptions)}})}}({...G,onPress:C,onPressStart:D,onPressEnd:E,onClick:F,isDisabled:a.isDisabled,elementType:`${v}`},H),{isFocused:K,isFocusVisible:L,focusProps:M}=(0,m.useFocusRing)({autoFocus:A});y&&(G.rel=null!=(p=G.rel)?p:"noopener noreferrer",G.target=null!=(q=G.target)?q:"_blank");let N=(0,o.useMemo)(()=>d({...t,disableAnimation:I,className:B}),[(0,n.objectToDeps)(t),I,B]);return{Component:v||"a",children:w,anchorIcon:x,showAnchorIcon:z,getLinkProps:(0,o.useCallback)(()=>({ref:H,className:N,"data-focus":(0,n.dataAttr)(K),"data-disabled":(0,n.dataAttr)(a.isDisabled),"data-focus-visible":(0,n.dataAttr)(L),...(0,n.mergeProps)(M,J,G)}),[N,K,L,M,J,G])}}({ref:b,...a});return(0,p.jsx)(c,{...u(),children:(0,p.jsxs)(p.Fragment,{children:[r,s&&t]})})});r.displayName="HeroUI.Link";var s=r},45288,a=>{"use strict";a.s(["getTagAll",()=>c]);var b=a.i(5050),c=(0,b.createServerReference)("405119ae98e75213dfa280f56f6b7bf8a0a17f0152",b.callServer,void 0,b.findSourceMapURL,"getTagAll")},69532,9938,a=>{"use strict";a.s(["BaseSection",()=>d],69532);var b=a.i(72131);function c(a){return null}c.getCollectionNode=function*(a){let{children:c,title:d,items:e}=a;yield{type:"section",props:a,hasChildNodes:!0,rendered:d,"aria-label":a["aria-label"],*childNodes(){if("function"==typeof c){if(!e)throw Error("props.children was a function but props.items is missing");for(let a of e)yield{type:"item",value:a,renderer:c}}else{let a=[];b.default.Children.forEach(c,b=>{a.push({type:"item",element:b})}),yield*a}}}};let d=c;a.s(["FamiliarityList",()=>j,"FilterType",()=>e,"FilterTypeList",()=>f,"TagAll",()=>h,"TagNo",()=>i,"TagUnspecified",()=>g],9938);var e=function(a){return a.Normal="normal",a.Easy="easy",a.Unspecified="unspecified",a.Uncomplete="uncomplete",a}({});let f=[{value:"unspecified",description:"all"},{value:"normal",description:"familiarity < 6"},{value:"easy",description:"familiarity = 6"},{value:"uncomplete",description:"question or answer is empty"}],g="unspecified",h="all tagged",i="not tagged";!function(a){a[a.NewlyAdded=0]="NewlyAdded",a[a.StillUnfamiliar=1]="StillUnfamiliar",a[a.PassiveUnderstanding=2]="PassiveUnderstanding",a[a.RecognitionWithoutUnderstanding=3]="RecognitionWithoutUnderstanding",a[a.UnderstandingInContext=4]="UnderstandingInContext",a[a.ActiveRecall=5]="ActiveRecall",a[a.NaturalUsage=6]="NaturalUsage"}({});let j=[{value:0,description:"Newly Added",label:"newly added",color:"bg-slate-200"},{value:1,description:"Still Unfamiliar",label:"strange",color:"bg-red-200"},{value:2,description:"Passive Understanding",label:"known",color:"bg-orange-200"},{value:3,description:"Recognition Without Understanding",label:"familiar",color:"bg-amber-200"},{value:4,description:"Understanding in Context",label:"skilled",color:"bg-cyan-200"},{value:5,description:"Active Recall",label:"practiced",color:"bg-green-200"},{value:6,description:"Natural Usage",label:"easy & never appear again",color:"bg-lime-200"}]},40253,a=>{"use strict";a.s(["DropdownSection",()=>b],40253);var b=a.i(69532).BaseSection},45208,a=>{"use strict";a.s(["getCardTag",()=>c]);var b=a.i(5050),c=(0,b.createServerReference)("605460a27fe3737dfdbad9c0696d5e2942269d1b5a",b.callServer,void 0,b.findSourceMapURL,"getCardTag")},94462,a=>{"use strict";a.s(["default",()=>E],94462);var b=a.i(87924),c=a.i(60955),d=a.i(47977),e=a.i(21694),f=a.i(3220),g=a.i(92481),h=a.i(88206),i=a.i(95032),j=a.i(13046),k=a.i(27700),l=a.i(40253),m=a.i(18745),n=a.i(72131),o=a.i(45208),p=a.i(45288),q=a.i(94106),r=a.i(24738),s=a.i(60208),t=a.i(27493),u=a.i(95245),v=a.i(20094);function w({email:a,card:c,tag_list:e}){let[f,g]=(0,n.useState)(!1),[h,i]=(0,n.useState)(e||[]),[j,k]=(0,n.useState)([]),[l,m]=(0,n.useState)([]),{handleSubmit:w}=(0,u.useForm)();(0,n.useEffect)(()=>{(async()=>{g(!0);let b=h;if(0==h.length){let c=await (0,p.getTagAll)(a);if("success"!==c.status)return;b=c.data,i(c.data)}let d=await (0,o.getCardTag)(a,c.uuid);"success"===d.status&&d.data.tag_list_added&&(k(d.data.tag_list_added),m(d.data.tag_list_added.filter(a=>b.map(a=>a.uuid).includes(a)))),g(!1)})()},[]);let x=async()=>{let a={uuid:c.uuid,tag_list_new:l.filter(a=>!j.includes(a)),tag_list_remove:j.filter(a=>!l.includes(a))};"success"===(await (0,q.saveCardTag)(a)).status?v.toast.success("save tag successfully"):v.toast.error("save tag failed")};return(0,b.jsx)(b.Fragment,{children:f?(0,b.jsx)(t.CircularProgress,{}):(0,b.jsx)("form",{onSubmit:w(x),children:(0,b.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,b.jsx)("div",{className:"flex flex-row items-center justify-start gap-1",children:h.length>0?(0,b.jsx)(s.CheckboxGroup,{color:"success",value:l,onValueChange:m,orientation:"vertical",children:h.map(a=>(0,b.jsx)(r.Checkbox,{value:a.uuid,children:a.tag},a.uuid))}):(0,b.jsx)("div",{children:"not tag found"})}),(0,b.jsx)("div",{className:"flex flex-row items-center justify-end gap-1",children:(0,b.jsx)(d.Link,{as:"button",type:"submit",className:"bg-blue-500 rounded-md text-slate-50 px-2",children:"save"})})]})})})}var x=a.i(9938),y=a.i(5050),z=(0,y.createServerReference)("609bb923290cc50188fda9254aa3887f1619275333",y.callServer,void 0,y.findSourceMapURL,"setCardFamiliarity"),A=a.i(83309),B=a.i(68114);function C({email:a,card:c}){let[e,f]=(0,n.useState)([]),[g,h]=(0,n.useState)([]),{handleSubmit:i}=(0,u.useForm)();(0,n.useEffect)(()=>{(async()=>{let b=await (0,p.getTagAll)(a);"success"===b.status&&f(b.data)})()},[]);let j=async()=>{let b={...c,uuid:(0,B.getUUID)(),user_id:a,familiarity:0,note:(c.note?c.note+"\n":"")+`{"collect_from":${JSON.stringify(c.user_id)}, "source_uuid":${JSON.stringify(c.uuid)}}`,updated_at:new Date};if("success"!==(await (0,A.saveCard)(b)).status)return void v.toast.error("save card failed");v.toast.success("save card successfully"),"success"===(await (0,q.saveCardTag)({uuid:c.uuid,tag_list_new:g})).status?v.toast.success("save tag successfully"):v.toast.error("save tag failed")};return(0,b.jsx)("form",{onSubmit:i(j),children:(0,b.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,b.jsx)("div",{className:"flex flex-row items-center justify-start gap-1",children:e.length>0?(0,b.jsx)(s.CheckboxGroup,{color:"success",value:g,onValueChange:h,children:e.map(a=>(0,b.jsx)(r.Checkbox,{value:a.uuid,children:a.tag},a.uuid))}):(0,b.jsx)("div",{className:"px-1 pt-1",children:"not tag found"})}),(0,b.jsx)("div",{className:"flex flex-row items-center justify-end gap-1",children:(0,b.jsx)(d.Link,{as:"button",type:"submit",className:"bg-blue-500 rounded-md text-slate-50 px-2",children:"save"})})]})})}function D({email:a,card:o,edit_view:p,tag_list:q}){let[r,s]=(0,n.useState)(o.familiarity),t=o.user_id===a,u=a=>t?x.FamiliarityList.map(a=>a.color)[a]:x.FamiliarityList.map(a=>a.color)[0];return(0,b.jsxs)("div",{className:`flex flex-col w-full items-start rounded-md p-1 ${u(r)}`,children:[(0,b.jsx)("div",{className:"flex flex-row w-full items-center justify-start gap-2",children:(0,b.jsx)(d.Link,{target:"_blank",href:`/card/${o.uuid}${p?"?edit=y":""}`,className:"text-2xl text-blue-600 hover:underline",children:(0,b.jsx)("pre",{className:"font-roboto leading-none text-wrap",children:o.question})})}),!t&&(0,b.jsx)(d.Link,{target:"_blank",href:`/card/market?user_id=${o.user_id}`,className:"text-sm text-gray-500 hover:underline",children:`by ${o.user_id}`}),(0,b.jsxs)("div",{className:"flex flex-row w-full items-end justify-end gap-4",children:[t&&(0,b.jsx)(h.Tooltip,{content:`current: ${r}
${x.FamiliarityList.map(a=>a.description)[r]}`,children:(0,b.jsx)(c.ButtonGroup,{variant:"solid",color:"primary",children:(0,b.jsxs)(i.Dropdown,{placement:"bottom-end",children:[(0,b.jsx)(m.DropdownTrigger,{children:(0,b.jsx)(d.Link,{as:"button",isBlock:!0,className:"text-xl",children:"set familiarity"})}),(0,b.jsx)(k.DropdownMenu,{disallowEmptySelection:!0,className:"max-w-[300px]",selectionMode:"single",defaultSelectedKeys:[r],onSelectionChange:async a=>{if(a.currentKey){let b=parseInt(a.currentKey);s(b),await z(o.uuid,b)?v.toast.success("save familiarity successfully"):v.toast.error("save familiarity failed")}},children:(0,b.jsx)(l.DropdownSection,{items:x.FamiliarityList,children:x.FamiliarityList.map(a=>(0,b.jsx)(j.DropdownItem,{description:a.description,className:`${u(a.value)}`,children:`${a.value} - ${a.label}`},a.value))})})]})})}),t&&(0,b.jsxs)(e.Popover,{placement:"top-end",classNames:{content:"bg-slate-200"},children:[(0,b.jsx)(g.PopoverTrigger,{children:(0,b.jsx)(d.Link,{as:"button",isBlock:!0,className:"text-xl",children:"edit tag"})}),(0,b.jsx)(f.PopoverContent,{children:(0,b.jsx)(w,{email:a,card:o,tag_list:q||[]})})]}),!t&&(0,b.jsxs)(e.Popover,{placement:"top-end",classNames:{content:"bg-slate-200"},children:[(0,b.jsx)(g.PopoverTrigger,{children:(0,b.jsx)(d.Link,{as:"button",isBlock:!0,className:"text-xl",children:"collect"})}),(0,b.jsx)(f.PopoverContent,{children:(0,b.jsx)(C,{email:a,card:o})})]})]})]})}function E({email:a,edit_view:c,card_list:d}){return(0,b.jsx)("div",{className:"flex flex-col w-full gap-2",children:d.map(d=>(0,b.jsx)(D,{email:a,card:d,edit_view:c},d.uuid))})}}];

//# sourceMappingURL=_0b9b0dc6._.js.map