(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,377148,e=>{"use strict";e.s(["Textarea",()=>U],377148);var t=e.i(834738),r=e.i(75540),a=e.i(273830),n=e.i(271645);function i(){return(i=Object.assign.bind()).apply(null,arguments)}var o=n.useLayoutEffect,l=function(e){var t=n.default.useRef(e);return o(function(){t.current=e}),t},s=function(e,t){if("function"==typeof e)return void e(t);e.current=t},d=function(e,t){var r=n.default.useRef();return n.default.useCallback(function(a){e.current=a,r.current&&s(r.current,null),r.current=t,t&&s(t,a)},[t])},c={"min-height":"0","max-height":"none",height:"0",visibility:"hidden",overflow:"hidden",position:"absolute","z-index":"-1000",top:"0",right:"0",display:"block"},u=function(e){Object.keys(c).forEach(function(t){e.style.setProperty(t,c[t],"important")})},f=null,v=function(e,t){var r=e.scrollHeight;return"border-box"===t.sizingStyle.boxSizing?r+t.borderSize:r-t.paddingSize},g=function(){},m=["borderBottomWidth","borderLeftWidth","borderRightWidth","borderTopWidth","boxSizing","fontFamily","fontSize","fontStyle","fontWeight","letterSpacing","lineHeight","paddingBottom","paddingLeft","paddingRight","paddingTop","tabSize","textIndent","textRendering","textTransform","width","wordBreak","wordSpacing","scrollbarGutter"],x=!!document.documentElement.currentStyle,p=function(e){var t=window.getComputedStyle(e);if(null===t)return null;var r=m.reduce(function(e,r){return e[r]=t[r],e},{}),a=r.boxSizing;if(""===a)return null;x&&"border-box"===a&&(r.width=parseFloat(r.width)+parseFloat(r.borderRightWidth)+parseFloat(r.borderLeftWidth)+parseFloat(r.paddingRight)+parseFloat(r.paddingLeft)+"px");var n=parseFloat(r.paddingBottom)+parseFloat(r.paddingTop),i=parseFloat(r.borderBottomWidth)+parseFloat(r.borderTopWidth);return{sizingStyle:r,paddingSize:n,borderSize:i}};function h(e,t,r){var a=l(r);n.useLayoutEffect(function(){var r=function(e){return a.current(e)};if(e)return e.addEventListener(t,r),function(){return e.removeEventListener(t,r)}},[])}var b=function(e,t){h(document.body,"reset",function(r){e.current.form===r.target&&t(r)})},y=function(e){h(window,"resize",e)},S=function(e){h(document.fonts,"loadingdone",e)},w=["cacheMeasurements","maxRows","minRows","onChange","onHeightChange"],j=n.forwardRef(function(e,t){var r=e.cacheMeasurements,a=e.maxRows,o=e.minRows,l=e.onChange,s=void 0===l?g:l,c=e.onHeightChange,m=void 0===c?g:c,x=function(e,t){if(null==e)return{};var r={};for(var a in e)if(({}).hasOwnProperty.call(e,a)){if(-1!==t.indexOf(a))continue;r[a]=e[a]}return r}(e,w),h=void 0!==x.value,j=n.useRef(null),R=d(j,t),L=n.useRef(0),A=n.useRef(),U=function(){var e=j.current,t=r&&A.current?A.current:p(e);if(t){A.current=t;var n,i,l,s,d,c,g,x,h,b,y,S=(n=e.value||e.placeholder||"x",void 0===(i=o)&&(i=1),void 0===(l=a)&&(l=1/0),f||((f=document.createElement("textarea")).setAttribute("tabindex","-1"),f.setAttribute("aria-hidden","true"),u(f)),null===f.parentNode&&document.body.appendChild(f),s=t.paddingSize,d=t.borderSize,g=(c=t.sizingStyle).boxSizing,Object.keys(c).forEach(function(e){f.style[e]=c[e]}),u(f),f.value=n,x=v(f,t),f.value=n,x=v(f,t),f.value="x",b=(h=f.scrollHeight-s)*i,"border-box"===g&&(b=b+s+d),x=Math.max(b,x),y=h*l,"border-box"===g&&(y=y+s+d),[x=Math.min(y,x),h]),w=S[0],R=S[1];L.current!==w&&(L.current=w,e.style.setProperty("height",w+"px","important"),m(w,{rowHeight:R}))}};return n.useLayoutEffect(U),b(j,function(){if(!h){var e=j.current.value;requestAnimationFrame(function(){var t=j.current;t&&e!==t.value&&U()})}}),y(U),S(U),n.createElement("textarea",i({},x,{onChange:function(e){h||U(),s(e)},ref:R}))}),R=e.i(619110),L=e.i(843476),A=(0,a.forwardRef)((e,a)=>{let{style:i,minRows:o=3,maxRows:l=8,cacheMeasurements:s=!1,disableAutosize:d=!1,onHeightChange:c,...u}=e,{Component:f,label:v,description:g,startContent:m,endContent:x,hasHelper:p,shouldLabelBeOutside:h,shouldLabelBeInside:b,isInvalid:y,errorMessage:S,getBaseProps:w,getLabelProps:A,getInputProps:U,getInnerWrapperProps:N,getInputWrapperProps:k,getHelperWrapperProps:T,getDescriptionProps:C,getErrorMessageProps:z,isClearable:_,getClearButtonProps:E}=(0,t.useInput)({...u,ref:a,isMultiline:!0}),[M,O]=(0,n.useState)(o>1),[F,P]=(0,n.useState)(!1),B=v?(0,L.jsx)("label",{...A(),children:v}):null,H=U(),I=d?(0,L.jsx)("textarea",{...H,style:(0,r.mergeProps)(H.style,null!=i?i:{})}):(0,L.jsx)(j,{...H,cacheMeasurements:s,"data-hide-scroll":(0,r.dataAttr)(!F),maxRows:l,minRows:o,style:(0,r.mergeProps)(H.style,null!=i?i:{}),onHeightChange:(e,t)=>{1===o&&O(e>=2*t.rowHeight),l>o&&P(e>=l*t.rowHeight),null==c||c(e,t)}}),W=(0,n.useMemo)(()=>_?(0,L.jsx)("button",{...E(),children:(0,L.jsx)(R.CloseFilledIcon,{})}):null,[_,E]),D=(0,n.useMemo)(()=>m||x?(0,L.jsxs)("div",{...N(),children:[m,I,x]}):(0,L.jsx)("div",{...N(),children:I}),[m,H,x,N]),K=y&&S,V=K||g;return(0,L.jsxs)(f,{...w(),children:[h?B:null,(0,L.jsxs)("div",{...k(),"data-has-multiple-rows":(0,r.dataAttr)(M),children:[b?B:null,D,W]}),p&&V?(0,L.jsx)("div",{...T(),children:K?(0,L.jsx)("div",{...z(),children:S}):(0,L.jsx)("div",{...C(),children:g})}):null]})});A.displayName="HeroUI.Textarea";var U=A},330633,916630,e=>{"use strict";e.s(["removeAudio",()=>r],330633);var t=e.i(95187),r=(0,t.createServerReference)("60ca0554c1d4dc6bbeab7d5c9acf176aa147b46c74",t.callServer,void 0,t.findSourceMapURL,"removeAudio");e.s(["saveAudio",()=>a],916630);var a=(0,t.createServerReference)("7050b2770ec309b7da94c33b337b332332f0f85709",t.callServer,void 0,t.findSourceMapURL,"saveAudio")},192744,e=>{"use strict";e.s(["default",()=>y],192744);var t=e.i(843476),r=e.i(975157),a=e.i(736132),n=e.i(335889),i=e.i(356124),o=e.i(76220),l=e.i(112041),s=e.i(377148),d=e.i(271645),c=e.i(330633),u=e.i(916630),f=e.i(671508),v=e.i(95187),g=(0,v.createServerReference)("40e32540531136197be6071284ff2f5bb295086a7b",v.callServer,void 0,v.findSourceMapURL,"getAnswerAll"),m=(0,v.createServerReference)("40dae36d044496c2ca9d147157d8abaca74883676b",v.callServer,void 0,v.findSourceMapURL,"getQuestion"),x=(0,v.createServerReference)("4028cb472ff334588ba7d472bcb05bf4cd7d8eb884",v.callServer,void 0,v.findSourceMapURL,"removeAnswer"),p=(0,v.createServerReference)("404f2374ec1a7c89003ea6a01c84dc78638db43a87",v.callServer,void 0,v.findSourceMapURL,"saveAnswer"),h=e.i(24597);function b(e){let{user_id:r,item:a,handleDelete:n}=e;return(0,t.jsxs)("div",{className:"flex flex-col w-full items-start rounded-md p-1",children:[(0,t.jsx)("div",{className:"flex flex-row w-full items-center justify-start gap-2",children:a.content}),(0,t.jsxs)("div",{className:"flex flex-row w-full items-center justify-end gap-4",children:[(0,t.jsx)(h.Link,{target:"_blank",href:"/speak/practice?user_id=".concat(a.user_id),className:"text-sm text-gray-500 hover:underline w-full",children:"by ".concat(a.user_id)}),a.user_id===r&&(0,t.jsx)(h.Link,{as:"button",isBlock:!0,color:"danger",className:"text-xl",onPress:async()=>{window.confirm("Are you sure to delete?")&&await n(a)},children:"delete"})]})]})}function y(e){let{question_uuid:v,user_id:h}=e,[y,S]=(0,d.useState)(),[w,j]=(0,d.useState)([]),[R,L]=(0,d.useState)(1),[A,U]=(0,d.useState)(!1),[N,k]=(0,d.useState)(!1),[T,C]=(0,d.useState)("local"),[z,_]=(0,d.useState)("video"),[E,M]=(0,d.useState)(),[O,F]=(0,d.useState)([]),[P,B]=(0,d.useState)(!1),[H,I]=(0,d.useState)(!1),[W,D]=(0,d.useState)(),[K,V]=(0,d.useState)(),[q,G]=(0,d.useState)(),Q=(0,d.useRef)(null),J=async e=>{if(e.audio_path){let t=await (0,c.removeAudio)("ask","".concat(e.uuid,".wav"));if("error"===t.status){console.log(t.error),(0,a.addToast)({title:"remove data error",color:"danger"});return}}if(e.video_path){let t=await (0,c.removeAudio)("ask","".concat(e.uuid,".mp4"));if("error"===t.status){console.log(t.error),(0,a.addToast)({title:"remove data error",color:"danger"});return}}let t=await x(e.uuid);"success"===t.status?L(e=>e+1):(console.log(t.error),(0,a.addToast)({title:"remove data error",color:"danger"}))},X=async()=>{if(!q)return void alert("content is empty");if(!K)return void alert("audio is empty");let e=(0,r.getUUID)();if(k(!0),W){let t=await (0,u.saveAudio)(W.data,"ask","".concat(e,".mp4"));if("error"===t.status){console.log(t.error),(0,a.addToast)({title:"save data error",color:"danger"}),k(!1);return}}if(K){let t=await (0,u.saveAudio)(K.data,"ask","".concat(e,".wav"));if("error"===t.status){console.log(t.error),(0,a.addToast)({title:"save data error",color:"danger"}),k(!1);return}}let t=await p({uuid:e,user_id:h,question_uuid:v,audio_path:K?"/api/data/ask/".concat(e,".wav"):"",video_path:W?"/api/data/ask/".concat(e,".mp4"):"",content:q,created_by:h,created_at:new Date,updated_at:new Date});"success"===t.status?(G(""),W&&(URL.revokeObjectURL(W.url),D(void 0)),K&&(URL.revokeObjectURL(K.url),V(void 0)),L(e=>e+1)):(console.log(t.error),(0,a.addToast)({title:"save data error",color:"danger"})),k(!1)},Y=async()=>{W&&(URL.revokeObjectURL(W.url),D(void 0)),K&&(URL.revokeObjectURL(K.url),V(void 0));let e=async e=>{D({data:e,url:URL.createObjectURL(e)})},t=async(e,t)=>{V({data:t,url:URL.createObjectURL(t)}),G("success"===e.status?e.data:""),"error"===e.status&&(0,a.addToast)({title:e.error,color:"danger"})};await (0,f.toggleRecording)({mode:z,setStateStream:M,stateRecorder:O,setStateRecorder:F,stateRecording:P,setStateRecording:B,recognize:!0,sttEngine:T,setStateProcessing:I,handleVideo:e,handleAudio:t})};return(0,d.useEffect)(()=>{let e=async()=>{U(!0);let e=await g(v);"success"===e.status?j(e.data):(console.log(e.error),(0,a.addToast)({title:"load data error",color:"danger"})),U(!1)};(async()=>{U(!0);let e=await m(v);"success"===e.status?S(e.data):(console.log(e.error),(0,a.addToast)({title:"load data error",color:"danger"})),U(!1)})(),e(),Q.current&&E&&(Q.current.srcObject=E)},[v,R,Q,E]),(0,t.jsxs)("div",{className:"w-full space-y-4 mb-10",children:[!!y&&(y.user_id===h?(0,t.jsx)("div",{className:"flex flex-col w-full gap-2 my-4 p-2 rounded-lg bg-sand-300",children:(0,t.jsx)("div",{className:"flex flex-col w-full gap-2 my-4 p-2 rounded-lg bg-sand-300 text-xl",children:y.title})}):(0,t.jsx)("div",{className:"flex flex-col w-full gap-2 my-4 p-2 rounded-lg bg-sand-300 text-xl",children:y.title})),(0,t.jsxs)("div",{className:"flex flex-col lg:flex-row items-center justify-center gap-4 my-4",children:[(0,t.jsx)(i.Select,{"aria-label":"stt engine",className:"max-w-sm",selectedKeys:[T],onChange:e=>C(e.target.value),startContent:(0,t.jsx)("div",{className:"whitespace-nowrap font-bold",children:"AI Engine"}),children:f.EngineList.map(e=>(0,t.jsx)(o.SelectItem,{textValue:e.value,children:e.value},e.key))}),(0,t.jsxs)(i.Select,{"aria-label":"stt engine",className:"max-w-sm",selectedKeys:[z],onChange:e=>_(e.target.value),startContent:(0,t.jsx)("div",{className:"whitespace-nowrap font-bold",children:"Mode"}),children:[(0,t.jsx)(o.SelectItem,{textValue:"video",children:"video"},"video"),(0,t.jsx)(o.SelectItem,{textValue:"audio",children:"audio"},"audio")]}),(0,t.jsx)(n.Button,{variant:"solid",color:"primary",id:"button-toggel-recording",isDisabled:!P&&H,onPress:async()=>{await Y()},children:P?"â¹ Stop Recording (Ctrl+A)":H?"Processing":"ðŸŽ¤ Read a Sentence (Ctrl+A)"})]}),P?(0,t.jsx)("video",{ref:Q,autoPlay:!0,muted:!0,playsInline:!0}):(0,t.jsxs)("div",{className:"flex flex-col items-center justify-center w-full gap-2 my-4",children:[!!K&&(0,t.jsx)("audio",{controls:!0,src:K.url}),!!W&&(0,t.jsx)("video",{controls:!0,src:W.url}),(0,t.jsx)(s.Textarea,{size:"lg",className:"w-full",label:"content",classNames:{inputWrapper:"bg-sand-200",input:"text-xl"},value:q,onChange:e=>G(e.target.value)}),(0,t.jsx)(n.Button,{variant:"solid",color:"primary",id:"button-add-save",isDisabled:N,onPress:X,children:"Add & Save (Ctrl+S)"})]}),A&&(0,t.jsx)("div",{className:"flex flex-row w-full items-center justify-center gap-4 my-4",children:(0,t.jsx)(l.Spinner,{classNames:{label:"text-foreground mt-4"},variant:"simple"})}),(0,t.jsx)("div",{className:"flex flex-col w-full gap-4 my-4",children:w.map((e,r)=>(0,t.jsx)(b,{user_id:h,item:e,handleDelete:J},"".concat(r,"-").concat(e.uuid)))})]})}}]);