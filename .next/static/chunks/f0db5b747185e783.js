(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,99749,e=>{"use strict";function t(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}e.s(["_",()=>t])},20738,e=>{"use strict";e.s(["cacheBlobInMemory",()=>a,"dropWeakCache",()=>s,"getBlobFromWeakCache",()=>o]);let t=new Map,r=new FinalizationRegistry(e=>{t.delete(e)});function a(e,a){if("undefined"==typeof WeakRef)return;let o=new WeakRef(a);t.set(e,o);try{r.register(a,e,a)}catch(e){console.log(e)}}function o(e){let r=t.get(e);if(!r)return null;let a=r.deref();return a||(t.delete(e),null)}function s(e){t.delete(e)}},73101,e=>{"use strict";e.s(["deleteBlobFromIndexedDB",()=>s,"getBlobFromIndexedDB",()=>o,"saveBlobToIndexedDB",()=>a]);let t="blobs";function r(){return new Promise((e,r)=>{let a=indexedDB.open("audio-store",1);a.onupgradeneeded=e=>{let r=e.target.result;r.objectStoreNames.contains(t)||r.createObjectStore(t,{keyPath:"uuid"})},a.onsuccess=()=>{e(a.result)},a.onerror=()=>{r(a.error)}})}async function a(e,a){let o=await r();return new Promise((r,s)=>{let n=o.transaction(t,"readwrite").objectStore(t),i={uuid:e,audioBlob:a,createdAt:Date.now()},c=n.put(i);c.onsuccess=()=>r(),c.onerror=()=>s(c.error)})}async function o(e){let a=await r();return new Promise((r,o)=>{let s=a.transaction(t,"readonly").objectStore(t).get(e);s.onsuccess=()=>{let e=s.result;r(e?e.audioBlob:null)},s.onerror=()=>o(s.error)})}async function s(e){let a=await r();return new Promise((r,o)=>{let s=a.transaction(t,"readwrite").objectStore(t).delete(e);s.onsuccess=()=>r(),s.onerror=()=>o(s.error)})}},19448,e=>{"use strict";e.s(["saveAudio",()=>r]);var t=e.i(95187),r=(0,t.createServerReference)("703c17761ed731724d1495dbd3fc1ac8e87c0a8361",t.callServer,void 0,t.findSourceMapURL,"saveAudio")},48983,e=>{"use strict";e.s(["saveAudioDB",()=>r]);var t=e.i(95187),r=(0,t.createServerReference)("40a49a7b7611cee55d9f12d379f895329d192553d1",t.callServer,void 0,t.findSourceMapURL,"saveAudioDB")},22011,e=>{"use strict";e.s(["default",()=>u]);var t=e.i(43476),r=e.i(75157),a=e.i(35889),o=e.i(56124),s=e.i(76220),n=e.i(71645),i=e.i(70319);e.i(48983);var c=e.i(20738),l=e.i(73101);e.i(19448);var d=e.i(71508);function u(e){let{uuid:u,user_id:f}=e,[m,b]=(0,n.useState)(!1),[g,v]=(0,n.useState)("local"),[x,y]=(0,n.useState)(),[j,S]=(0,n.useState)([]),[p,h]=(0,n.useState)(!1),[w,B]=(0,n.useState)(!1),[R,I]=(0,n.useState)(),[U,D]=(0,n.useState)(""),[P,A]=(0,n.useState)(""),N=(0,n.useRef)(null),_=async()=>{D(""),A("");let e=async e=>{let t=(0,r.getUUID)();await (0,l.saveBlobToIndexedDB)(t,e),(0,c.cacheBlobInMemory)(t,e),D(URL.createObjectURL(e))},t=async(e,t)=>{let a=(0,r.getUUID)();console.log(a),await (0,l.saveBlobToIndexedDB)(a,t),(0,c.cacheBlobInMemory)(a,t),A(URL.createObjectURL(t)),I({uuid:a,user_id:f,text_uuid:u,recognized:"success"===e.status?e.data:"",audio_path:"/api/data/video/".concat(a,".mp4"),in_db:!1,on_fs:!1,modified_db:!0,modified_fs:!0}),"error"===e.status&&i.toast.error(e.error)};await (0,d.toggleRecording)({mode:"video",setStateStream:y,stateRecorder:j,setStateRecorder:S,stateRecording:p,setStateRecording:h,recognize:!0,sttEngine:g,setStateProcessing:B,handleVideo:e,handleAudio:t})};return(0,n.useEffect)(()=>{N.current&&x&&(N.current.srcObject=x)},[N,x]),(0,t.jsxs)("div",{className:"flex flex-col items-center justify-center w-full my-10",children:[(0,t.jsxs)("div",{className:"flex flex-row justify-between items-center gap-2 mb-4",children:[(0,t.jsx)(o.Select,{"aria-label":"stt engine",className:"max-w-sm",selectedKeys:[g],onChange:e=>v(e.target.value),startContent:(0,t.jsx)("div",{className:"whitespace-nowrap font-bold",children:"AI Engine"}),children:d.EngineList.map(e=>(0,t.jsx)(s.SelectItem,{textValue:e.value,children:e.value},e.key))}),(0,t.jsx)(a.Button,{color:"primary",size:"sm",onPress:_,children:p?"Stop":"Start"})]}),p&&(0,t.jsx)("video",{ref:N,autoPlay:!0,muted:!0,playsInline:!0}),!p&&(0,t.jsxs)("div",{className:"flex flex-col items-center justify-center gap-4",children:[!!U&&(0,t.jsx)("video",{controls:!0,src:U}),!!P&&(0,t.jsx)("audio",{controls:!0,src:P})]}),(0,t.jsxs)("div",{className:"mt-4 text-sm text-gray-700",children:[w&&"recognizing the audio ...",(null==R?void 0:R.recognized)&&(0,t.jsx)("div",{className:"p-2 border rounded-md bg-gray-50 mt-2",children:R.recognized})]})]})}}]);