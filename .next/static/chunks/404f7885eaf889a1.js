(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,96550,e=>{"use strict";e.s(["getCardTag",()=>t]);var s=e.i(95187),t=(0,s.createServerReference)("60a72527a950c024882899055e082d1552289182ed",s.callServer,void 0,s.findSourceMapURL,"getCardTag")},32049,e=>{"use strict";e.s(["DropdownSection",()=>s],32049);var s=e.i(99817).BaseSection},1138,e=>{"use strict";e.s(["default",()=>D],1138);var s=e.i(43476),t=e.i(86914),a=e.i(24597),i=e.i(42976),l=e.i(35577),r=e.i(46399),c=e.i(64925),n=e.i(33716),d=e.i(8870),o=e.i(76331),u=e.i(32049),x=e.i(72853),f=e.i(71645),m=e.i(96550),g=e.i(29899),p=e.i(94582),h=e.i(84735),v=e.i(52315),j=e.i(5483),y=e.i(53145),w=e.i(70319);function N(e){let{email:t,card:i,tag_list:l}=e,[r,c]=(0,f.useState)(!1),[n,d]=(0,f.useState)(l||[]),[o,u]=(0,f.useState)([]),[x,N]=(0,f.useState)([]),{handleSubmit:b}=(0,y.useForm)();(0,f.useEffect)(()=>{(async()=>{c(!0);let e=n;if(0==n.length){let s=await (0,g.getTagAll)(t);if("success"!==s.status)return;e=s.data,d(s.data)}let s=await (0,m.getCardTag)(t,i.uuid);"success"===s.status&&s.data.tag_list_added&&(u(s.data.tag_list_added),N(s.data.tag_list_added.filter(s=>e.map(e=>e.uuid).includes(s)))),c(!1)})()},[]);let S=async()=>{let e={uuid:i.uuid,tag_list_new:x.filter(e=>!o.includes(e)),tag_list_remove:o.filter(e=>!x.includes(e))};"success"===(await (0,p.saveCardTag)(e)).status?w.toast.success("save tag successfully"):w.toast.error("save tag failed")};return(0,s.jsx)(s.Fragment,{children:r?(0,s.jsx)(j.CircularProgress,{}):(0,s.jsx)("form",{onSubmit:b(S),children:(0,s.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,s.jsx)("div",{className:"flex flex-row items-center justify-start gap-1",children:n.length>0?(0,s.jsx)(v.CheckboxGroup,{color:"success",value:x,onValueChange:N,orientation:"vertical",children:n.map(e=>(0,s.jsx)(h.Checkbox,{value:e.uuid,children:e.tag},e.uuid))}):(0,s.jsx)("div",{children:"not tag found"})}),(0,s.jsx)("div",{className:"flex flex-row items-center justify-end gap-1",children:(0,s.jsx)(a.Link,{as:"button",type:"submit",className:"bg-blue-500 rounded-md text-slate-50 px-2",children:"save"})})]})})})}var b=e.i(49649),S=e.i(95187),C=(0,S.createServerReference)("602aa46b10c53f380f2f3263469e328d2ff8098d85",S.callServer,void 0,S.findSourceMapURL,"setCardFamiliarity"),T=e.i(33394),_=e.i(75157);function k(e){let{email:t,card:i}=e,[l,r]=(0,f.useState)([]),[c,n]=(0,f.useState)([]),{handleSubmit:d}=(0,y.useForm)();(0,f.useEffect)(()=>{(async()=>{let e=await (0,g.getTagAll)(t);"success"===e.status&&r(e.data)})()},[]);let o=async()=>{let e={...i,uuid:(0,_.getUUID)(),user_id:t,familiarity:0,note:(i.note?i.note+"\n":"")+'{"collect_from":'.concat(JSON.stringify(i.user_id),', "source_uuid":').concat(JSON.stringify(i.uuid),"}"),updated_at:new Date};if("success"!==(await (0,T.saveCard)(e)).status)return void w.toast.error("save card failed");w.toast.success("save card successfully"),"success"===(await (0,p.saveCardTag)({uuid:i.uuid,tag_list_new:c})).status?w.toast.success("save tag successfully"):w.toast.error("save tag failed")};return(0,s.jsx)("form",{onSubmit:d(o),children:(0,s.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,s.jsx)("div",{className:"flex flex-row items-center justify-start gap-1",children:l.length>0?(0,s.jsx)(v.CheckboxGroup,{color:"success",value:c,onValueChange:n,children:l.map(e=>(0,s.jsx)(h.Checkbox,{value:e.uuid,children:e.tag},e.uuid))}):(0,s.jsx)("div",{className:"px-1 pt-1",children:"not tag found"})}),(0,s.jsx)("div",{className:"flex flex-row items-center justify-end gap-1",children:(0,s.jsx)(a.Link,{as:"button",type:"submit",className:"bg-blue-500 rounded-md text-slate-50 px-2",children:"save"})})]})})}function L(e){let{email:m,card:g,edit_view:p,tag_list:h}=e,[v,j]=(0,f.useState)(g.familiarity),y=g.user_id===m,S=e=>y?b.FamiliarityList.map(e=>e.color)[e]:b.FamiliarityList.map(e=>e.color)[0];return(0,s.jsxs)("div",{className:"flex flex-col w-full items-start rounded-md p-1 ".concat(S(v)),children:[(0,s.jsx)("div",{className:"flex flex-row w-full items-center justify-start gap-2",children:(0,s.jsx)(a.Link,{target:"_blank",href:"/card/".concat(g.uuid).concat(p?"?edit=y":""),className:"text-2xl text-blue-600 hover:underline",children:(0,s.jsx)("pre",{className:"font-roboto leading-none text-wrap",children:g.question})})}),!y&&(0,s.jsx)(a.Link,{target:"_blank",href:"/card/market?user_id=".concat(g.user_id),className:"text-sm text-gray-500 hover:underline",children:"by ".concat(g.user_id)}),(0,s.jsxs)("div",{className:"flex flex-row w-full items-end justify-end gap-4",children:[y&&(0,s.jsx)(c.Tooltip,{content:"current: ".concat(v,"\n").concat(b.FamiliarityList.map(e=>e.description)[v]),children:(0,s.jsx)(t.ButtonGroup,{variant:"solid",color:"primary",children:(0,s.jsxs)(n.Dropdown,{placement:"bottom-end",children:[(0,s.jsx)(x.DropdownTrigger,{children:(0,s.jsx)(a.Link,{as:"button",isBlock:!0,className:"text-xl",children:"set familiarity"})}),(0,s.jsx)(o.DropdownMenu,{disallowEmptySelection:!0,className:"max-w-[300px]",selectionMode:"single",defaultSelectedKeys:[v],onSelectionChange:async e=>{if(e.currentKey){let s=parseInt(e.currentKey);j(s),await C(g.uuid,s)?w.toast.success("save familiarity successfully"):w.toast.error("save familiarity failed")}},children:(0,s.jsx)(u.DropdownSection,{items:b.FamiliarityList,children:b.FamiliarityList.map(e=>(0,s.jsx)(d.DropdownItem,{description:e.description,className:"".concat(S(e.value)),children:"".concat(e.value," - ").concat(e.label)},e.value))})})]})})}),y&&(0,s.jsxs)(i.Popover,{placement:"top-end",classNames:{content:"bg-slate-200"},children:[(0,s.jsx)(r.PopoverTrigger,{children:(0,s.jsx)(a.Link,{as:"button",isBlock:!0,className:"text-xl",children:"edit tag"})}),(0,s.jsx)(l.PopoverContent,{children:(0,s.jsx)(N,{email:m,card:g,tag_list:h||[]})})]}),!y&&(0,s.jsxs)(i.Popover,{placement:"top-end",classNames:{content:"bg-slate-200"},children:[(0,s.jsx)(r.PopoverTrigger,{children:(0,s.jsx)(a.Link,{as:"button",isBlock:!0,className:"text-xl",children:"collect"})}),(0,s.jsx)(l.PopoverContent,{children:(0,s.jsx)(k,{email:m,card:g})})]})]})]})}function D(e){let{email:t,edit_view:a,card_list:i}=e;return(0,s.jsx)("div",{className:"flex flex-col w-full gap-2",children:i.map(e=>(0,s.jsx)(L,{email:t,card:e,edit_view:a},e.uuid))})}},18553,e=>{"use strict";e.s(["default",()=>m],18553);var s=e.i(43476),t=e.i(71645),a=e.i(58033),i=e.i(5483),l=e.i(14060),r=e.i(212),c=e.i(98245),n=e.i(64925),d=e.i(1138),o=e.i(95187),u=(0,o.createServerReference)("7ef74299c869df98200b33fcda0fb967c930bf6843",o.callServer,void 0,o.findSourceMapURL,"getCardsOfMy"),x=e.i(49649),f=e.i(33401);function m(e){let{email:o,tag_list:m}=e,[g,p]=(0,t.useState)(x.FilterType.Normal),[h,v]=(0,t.useState)(!1),[j,y]=(0,t.useState)(x.TagUnspecified),[w,N]=(0,t.useState)([]),[b,S]=(0,t.useState)(1),[C,T]=(0,t.useState)(0),[_,k]=(0,t.useState)(""),[L,D]=(0,t.useState)(1);(0,t.useEffect)(()=>{(async()=>{v(!0);let e=await u(o,g,j,_,b,20);"success"===e.status?(N(e.data),T(e.total_pages||0)):console.log(e.error),v(!1)})()},[L]);let P=(e,t)=>(0,s.jsx)(a.Chip,{color:j===e?"success":"default",isDisabled:h,onClick:async()=>{y(e),S(1),D(L+1)},children:t},e);return(0,s.jsxs)("div",{className:"flex flex-col w-full gap-2 py-2 px-2",children:[(0,s.jsxs)("div",{className:"flex flex-row flex-wrap w-full items-center justify-start gap-1",children:[(0,s.jsx)("div",{className:"w-16",children:"Type"}),x.FilterTypeList.map(e=>{let t,i;return t=e.value,i=e.description,(0,s.jsx)(n.Tooltip,{placement:"top-end",className:"bg-slate-300",content:(0,s.jsx)("div",{className:"p-1",children:i}),children:(0,s.jsx)(a.Chip,{color:g===t?"success":"default",isDisabled:h,onClick:async()=>{p(t),S(1),D(L+1)},children:t})},t)})]}),(0,s.jsx)(l.Divider,{}),(0,s.jsxs)("div",{className:"flex flex-row flex-wrap w-full items-center justify-start gap-1",children:[(0,s.jsx)("div",{className:"w-16",children:"Tag"}),P(x.TagUnspecified,x.TagUnspecified),(0,s.jsx)(l.Divider,{orientation:"vertical",className:"mx-2 h-5"}),P(x.TagAll,x.TagAll),P(x.TagNo,x.TagNo),(0,s.jsx)(l.Divider,{orientation:"vertical",className:"mx-2 h-5"}),m.map(e=>P(e.uuid,e.tag))]}),(0,s.jsx)(l.Divider,{}),(0,s.jsxs)("div",{className:"flex flex-row w-full items-center justify-start gap-1",children:[(0,s.jsx)("div",{className:"w-16",children:"Cards"}),(0,s.jsx)(r.Input,{isClearable:!0,radius:"md",size:"sm",placeholder:"search question",startContent:(0,s.jsx)(f.BiSearch,{className:"mb-0.5 dark:text-white/90 text-slate-400 pointer-events-none flex-shrink-0"}),value:_,onClear:()=>k(""),onChange:e=>k(e.target.value),onKeyDown:e=>{"Enter"==e.key&&(S(1),D(L+1))}})]}),(0,s.jsxs)("div",{className:"flex flex-row items-center justify-center gap-4",children:[(0,s.jsx)("div",{children:"Page"}),(0,s.jsx)(c.Pagination,{showControls:!0,loop:!0,variant:"bordered",total:C,page:b,onChange:e=>{S(e),D(L+1)}})]}),h?(0,s.jsx)("div",{className:"flex flex-row w-full items-center justify-center gap-4",children:(0,s.jsx)(i.CircularProgress,{label:"Loading..."})}):(0,s.jsx)(d.default,{email:o,card_list:w,edit_view:g==x.FilterType.Uncomplete}),(0,s.jsxs)("div",{className:"flex flex-row items-center justify-center gap-4",children:[(0,s.jsx)("div",{children:"Page"}),(0,s.jsx)(c.Pagination,{showControls:!0,loop:!0,variant:"bordered",total:C,page:b,onChange:e=>{S(e),D(L+1)}})]})]})}}]);