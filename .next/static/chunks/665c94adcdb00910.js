(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,99749,e=>{"use strict";function t(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}e.s(["_",()=>t])},20738,e=>{"use strict";e.s(["cacheBlobInMemory",()=>a,"dropWeakCache",()=>s,"getBlobFromWeakCache",()=>n]);let t=new Map,r=new FinalizationRegistry(e=>{t.delete(e)});function a(e,a){if("undefined"==typeof WeakRef)return;let n=new WeakRef(a);t.set(e,n);try{r.register(a,e,a)}catch(e){console.log(e)}}function n(e){let r=t.get(e);if(!r)return null;let a=r.deref();return a||(t.delete(e),null)}function s(e){t.delete(e)}},73101,e=>{"use strict";e.s(["deleteBlobFromIndexedDB",()=>s,"getBlobFromIndexedDB",()=>n,"saveBlobToIndexedDB",()=>a]);let t="blobs";function r(){return new Promise((e,r)=>{let a=indexedDB.open("audio-store",1);a.onupgradeneeded=e=>{let r=e.target.result;r.objectStoreNames.contains(t)||r.createObjectStore(t,{keyPath:"uuid"})},a.onsuccess=()=>{e(a.result)},a.onerror=()=>{r(a.error)}})}async function a(e,a){let n=await r();return new Promise((r,s)=>{let o=n.transaction(t,"readwrite").objectStore(t),c={uuid:e,audioBlob:a,createdAt:Date.now()},i=o.put(c);i.onsuccess=()=>r(),i.onerror=()=>s(i.error)})}async function n(e){let a=await r();return new Promise((r,n)=>{let s=a.transaction(t,"readonly").objectStore(t).get(e);s.onsuccess=()=>{let e=s.result;r(e?e.audioBlob:null)},s.onerror=()=>n(s.error)})}async function s(e){let a=await r();return new Promise((r,n)=>{let s=a.transaction(t,"readwrite").objectStore(t).delete(e);s.onsuccess=()=>r(),s.onerror=()=>n(s.error)})}},56401,e=>{"use strict";e.s(["saveAudio",()=>r]);var t=e.i(95187),r=(0,t.createServerReference)("703aacb17952f9f9627256e672d694cddced7bf1b3",t.callServer,void 0,t.findSourceMapURL,"saveAudio")},41525,e=>{"use strict";e.s(["saveAudioDB",()=>r]);var t=e.i(95187),r=(0,t.createServerReference)("408bf7614f8dd76ded766685cf3ec4a8877e4dedbb",t.callServer,void 0,t.findSourceMapURL,"saveAudioDB")},22011,e=>{"use strict";e.s(["default",()=>u]);var t=e.i(43476),r=e.i(75157),a=e.i(35889),n=e.i(56124),s=e.i(76220),o=e.i(71645),c=e.i(70319);e.i(41525);var i=e.i(20738),l=e.i(73101);e.i(56401);var d=e.i(71508);function u(e){let{uuid:u,user_id:f}=e,[b,m]=(0,o.useState)(!1),[g,v]=(0,o.useState)("local"),[x,y]=(0,o.useState)(),[j,p]=(0,o.useState)([]),[w,S]=(0,o.useState)(!1),[h,B]=(0,o.useState)(!1),[R,D]=(0,o.useState)(),[I,U]=(0,o.useState)(""),[P,A]=(0,o.useState)(""),N=(0,o.useRef)(null),z=async()=>{U(""),A("");let e=async e=>{let t=(0,r.getUUID)();await (0,l.saveBlobToIndexedDB)(t,e),(0,i.cacheBlobInMemory)(t,e),U(URL.createObjectURL(e))},t=async(e,t)=>{let a=(0,r.getUUID)();console.log(a),await (0,l.saveBlobToIndexedDB)(a,t),(0,i.cacheBlobInMemory)(a,t),A(URL.createObjectURL(t)),D({uuid:a,user_id:f,text_uuid:u,recognized:"success"===e.status?e.data:"",audio_path:"/api/data/video/".concat(a,".mp4"),created_by:f,created_at:new Date,updated_at:new Date}),"error"===e.status&&c.toast.error(e.error)};await (0,d.toggleRecording)({mode:"video",setStateStream:y,stateRecorder:j,setStateRecorder:p,stateRecording:w,setStateRecording:S,recognize:!0,sttEngine:g,setStateProcessing:B,handleVideo:e,handleAudio:t})};return(0,o.useEffect)(()=>{N.current&&x&&(N.current.srcObject=x)},[N,x]),(0,t.jsxs)("div",{className:"flex flex-col items-center justify-center w-full my-10",children:[(0,t.jsxs)("div",{className:"flex flex-row justify-between items-center gap-2 mb-4",children:[(0,t.jsx)(n.Select,{"aria-label":"stt engine",className:"max-w-sm",selectedKeys:[g],onChange:e=>v(e.target.value),startContent:(0,t.jsx)("div",{className:"whitespace-nowrap font-bold",children:"AI Engine"}),children:d.EngineList.map(e=>(0,t.jsx)(s.SelectItem,{textValue:e.value,children:e.value},e.key))}),(0,t.jsx)(a.Button,{color:"primary",size:"sm",onPress:z,children:w?"Stop":"Start"})]}),w&&(0,t.jsx)("video",{ref:N,autoPlay:!0,muted:!0,playsInline:!0}),!w&&(0,t.jsxs)("div",{className:"flex flex-col items-center justify-center gap-4",children:[!!I&&(0,t.jsx)("video",{controls:!0,src:I}),!!P&&(0,t.jsx)("audio",{controls:!0,src:P})]}),(0,t.jsxs)("div",{className:"mt-4 text-sm text-gray-700",children:[h&&"recognizing the audio ...",(null==R?void 0:R.recognized)&&(0,t.jsx)("div",{className:"p-2 border rounded-md bg-gray-50 mt-2",children:R.recognized})]})]})}}]);