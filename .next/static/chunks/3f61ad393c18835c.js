(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,377148,e=>{"use strict";e.s(["Textarea",()=>N],377148);var t=e.i(834738),r=e.i(75540),a=e.i(273830),n=e.i(271645);function i(){return(i=Object.assign.bind()).apply(null,arguments)}var o=n.useLayoutEffect,l=function(e){var t=n.default.useRef(e);return o(function(){t.current=e}),t},s=function(e,t){if("function"==typeof e)return void e(t);e.current=t},d=function(e,t){var r=n.default.useRef();return n.default.useCallback(function(a){e.current=a,r.current&&s(r.current,null),r.current=t,t&&s(t,a)},[t])},c={"min-height":"0","max-height":"none",height:"0",visibility:"hidden",overflow:"hidden",position:"absolute","z-index":"-1000",top:"0",right:"0",display:"block"},u=function(e){Object.keys(c).forEach(function(t){e.style.setProperty(t,c[t],"important")})},f=null,g=function(e,t){var r=e.scrollHeight;return"border-box"===t.sizingStyle.boxSizing?r+t.borderSize:r-t.paddingSize},h=function(){},x=["borderBottomWidth","borderLeftWidth","borderRightWidth","borderTopWidth","boxSizing","fontFamily","fontSize","fontStyle","fontWeight","letterSpacing","lineHeight","paddingBottom","paddingLeft","paddingRight","paddingTop","tabSize","textIndent","textRendering","textTransform","width","wordBreak","wordSpacing","scrollbarGutter"],m=!!document.documentElement.currentStyle,v=function(e){var t=window.getComputedStyle(e);if(null===t)return null;var r=x.reduce(function(e,r){return e[r]=t[r],e},{}),a=r.boxSizing;if(""===a)return null;m&&"border-box"===a&&(r.width=parseFloat(r.width)+parseFloat(r.borderRightWidth)+parseFloat(r.borderLeftWidth)+parseFloat(r.paddingRight)+parseFloat(r.paddingLeft)+"px");var n=parseFloat(r.paddingBottom)+parseFloat(r.paddingTop),i=parseFloat(r.borderBottomWidth)+parseFloat(r.borderTopWidth);return{sizingStyle:r,paddingSize:n,borderSize:i}};function p(e,t,r){var a=l(r);n.useLayoutEffect(function(){var r=function(e){return a.current(e)};if(e)return e.addEventListener(t,r),function(){return e.removeEventListener(t,r)}},[])}var b=function(e,t){p(document.body,"reset",function(r){e.current.form===r.target&&t(r)})},y=function(e){p(window,"resize",e)},w=function(e){p(document.fonts,"loadingdone",e)},j=["cacheMeasurements","maxRows","minRows","onChange","onHeightChange"],S=n.forwardRef(function(e,t){var r=e.cacheMeasurements,a=e.maxRows,o=e.minRows,l=e.onChange,s=void 0===l?h:l,c=e.onHeightChange,x=void 0===c?h:c,m=function(e,t){if(null==e)return{};var r={};for(var a in e)if(({}).hasOwnProperty.call(e,a)){if(-1!==t.indexOf(a))continue;r[a]=e[a]}return r}(e,j),p=void 0!==m.value,S=n.useRef(null),B=d(S,t),R=n.useRef(0),z=n.useRef(),N=function(){var e=S.current,t=r&&z.current?z.current:v(e);if(t){z.current=t;var n,i,l,s,d,c,h,m,p,b,y,w=(n=e.value||e.placeholder||"x",void 0===(i=o)&&(i=1),void 0===(l=a)&&(l=1/0),f||((f=document.createElement("textarea")).setAttribute("tabindex","-1"),f.setAttribute("aria-hidden","true"),u(f)),null===f.parentNode&&document.body.appendChild(f),s=t.paddingSize,d=t.borderSize,h=(c=t.sizingStyle).boxSizing,Object.keys(c).forEach(function(e){f.style[e]=c[e]}),u(f),f.value=n,m=g(f,t),f.value=n,m=g(f,t),f.value="x",b=(p=f.scrollHeight-s)*i,"border-box"===h&&(b=b+s+d),m=Math.max(b,m),y=p*l,"border-box"===h&&(y=y+s+d),[m=Math.min(y,m),p]),j=w[0],B=w[1];R.current!==j&&(R.current=j,e.style.setProperty("height",j+"px","important"),x(j,{rowHeight:B}))}};return n.useLayoutEffect(N),b(S,function(){if(!p){var e=S.current.value;requestAnimationFrame(function(){var t=S.current;t&&e!==t.value&&N()})}}),y(N),w(N),n.createElement("textarea",i({},m,{onChange:function(e){p||N(),s(e)},ref:B}))}),B=e.i(619110),R=e.i(843476),z=(0,a.forwardRef)((e,a)=>{let{style:i,minRows:o=3,maxRows:l=8,cacheMeasurements:s=!1,disableAutosize:d=!1,onHeightChange:c,...u}=e,{Component:f,label:g,description:h,startContent:x,endContent:m,hasHelper:v,shouldLabelBeOutside:p,shouldLabelBeInside:b,isInvalid:y,errorMessage:w,getBaseProps:j,getLabelProps:z,getInputProps:N,getInnerWrapperProps:T,getInputWrapperProps:D,getHelperWrapperProps:A,getDescriptionProps:C,getErrorMessageProps:M,isClearable:F,getClearButtonProps:I}=(0,t.useInput)({...u,ref:a,isMultiline:!0}),[L,P]=(0,n.useState)(o>1),[k,_]=(0,n.useState)(!1),W=g?(0,R.jsx)("label",{...z(),children:g}):null,U=N(),E=d?(0,R.jsx)("textarea",{...U,style:(0,r.mergeProps)(U.style,null!=i?i:{})}):(0,R.jsx)(S,{...U,cacheMeasurements:s,"data-hide-scroll":(0,r.dataAttr)(!k),maxRows:l,minRows:o,style:(0,r.mergeProps)(U.style,null!=i?i:{}),onHeightChange:(e,t)=>{1===o&&P(e>=2*t.rowHeight),l>o&&_(e>=l*t.rowHeight),null==c||c(e,t)}}),O=(0,n.useMemo)(()=>F?(0,R.jsx)("button",{...I(),children:(0,R.jsx)(B.CloseFilledIcon,{})}):null,[F,I]),H=(0,n.useMemo)(()=>x||m?(0,R.jsxs)("div",{...T(),children:[x,E,m]}):(0,R.jsx)("div",{...T(),children:E}),[x,U,m,T]),K=y&&w,V=K||h;return(0,R.jsxs)(f,{...j(),children:[p?W:null,(0,R.jsxs)("div",{...D(),"data-has-multiple-rows":(0,r.dataAttr)(L),children:[b?W:null,H,O]}),v&&V?(0,R.jsx)("div",{...A(),children:K?(0,R.jsx)("div",{...M(),children:w}):(0,R.jsx)("div",{...C(),children:h})}):null]})});z.displayName="HeroUI.Textarea";var N=z},304361,500636,e=>{"use strict";e.s(["removeAudio",()=>r],304361);var t=e.i(95187),r=(0,t.createServerReference)("6011fc0b2061aec14856aa268c5d90ae756408e62f",t.callServer,void 0,t.findSourceMapURL,"removeAudio");e.s(["saveAudio",()=>a],500636);var a=(0,t.createServerReference)("7084d2e9b3d4d49d86e75ceaa813b9407c12fea0d7",t.callServer,void 0,t.findSourceMapURL,"saveAudio")},490939,e=>{"use strict";e.s(["saveText",()=>r]);var t=e.i(95187),r=(0,t.createServerReference)("4040ce50ed38a26b33048c6ec410de724374f0f338",t.callServer,void 0,t.findSourceMapURL,"saveText")},917648,e=>{"use strict";e.s(["highlightDifferences",()=>n]);var t=e.i(843476);function r(e){return(e=e.replace(/\s+/g," ").trim())?e.split(/(\s+|[.,!?;:\-â€”()"'â€œâ€â€žÂ«Â»â€¦])/).filter(e=>null!=e&&""!==e).filter(e=>e.trim().length>0||" "===e):[]}function a(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}let n=(e,n)=>{let i=r(e),o=r(n),l=new Map((function(e,t){let r=e.length,a=t.length,n=Array.from({length:r+1},()=>Array(a+1).fill(0));for(let i=r-1;i>=0;i--)for(let r=a-1;r>=0;r--)e[i]===t[r]?n[i][r]=1+n[i+1][r+1]:n[i][r]=Math.max(n[i+1][r],n[i][r+1]);let i=0,o=0,l=[];for(;i<r&&o<a;)e[i]===t[o]?(l.push([o,i]),i++,o++):n[i+1][o]>=n[i][o+1]?i++:o++;return l})(i,o).map(e=>[e[0],e[1]])),s=[],d=0;for(let e=0;e<o.length;e++){let r=l.get(e);if(void 0===r)s.push((0,t.jsx)("span",{style:{background:"yellow"},children:a(o[e])},"extra-".concat(e)));else{if(r>d)for(let e=d;e<r;e++)s.push((0,t.jsx)("span",{style:{background:"lightgreen"},children:a(i[e])},"missing-".concat(e)));s.push((0,t.jsx)("span",{children:a(o[e])},"match-".concat(e))),d=r+1}}for(let e=d;e<i.length;e++)s.push((0,t.jsx)("span",{style:{background:"red"},children:a(i[e])},"missing-".concat(e)));return s}},820738,e=>{"use strict";e.s(["cacheBlobInMemory",()=>a,"dropWeakCache",()=>i,"getBlobFromWeakCache",()=>n]);let t=new Map,r=new FinalizationRegistry(e=>{t.delete(e)});function a(e,a){if("undefined"==typeof WeakRef)return;let n=new WeakRef(a);t.set(e,n);try{r.register(a,e,a)}catch(e){console.log(e)}}function n(e){let r=t.get(e);if(!r)return null;let a=r.deref();return a||(t.delete(e),null)}function i(e){t.delete(e)}},673101,e=>{"use strict";e.s(["deleteBlobFromIndexedDB",()=>i,"getBlobFromIndexedDB",()=>n,"saveBlobToIndexedDB",()=>a]);let t="blobs";function r(){return new Promise((e,r)=>{let a=indexedDB.open("audio-store",1);a.onupgradeneeded=e=>{let r=e.target.result;r.objectStoreNames.contains(t)||r.createObjectStore(t,{keyPath:"uuid"})},a.onsuccess=()=>{e(a.result)},a.onerror=()=>{r(a.error)}})}async function a(e,a){let n=await r();return new Promise((r,i)=>{let o=n.transaction(t,"readwrite").objectStore(t),l={uuid:e,audioBlob:a,createdAt:Date.now()},s=o.put(l);s.onsuccess=()=>r(),s.onerror=()=>i(s.error)})}async function n(e){let a=await r();return new Promise((r,n)=>{let i=a.transaction(t,"readonly").objectStore(t).get(e);i.onsuccess=()=>{let e=i.result;r(e?e.audioBlob:null)},i.onerror=()=>n(i.error)})}async function i(e){let a=await r();return new Promise((r,n)=>{let i=a.transaction(t,"readwrite").objectStore(t).delete(e);i.onsuccess=()=>r(),i.onerror=()=>n(i.error)})}},426654,e=>{"use strict";e.s(["default",()=>S],426654);var t=e.i(843476),r=e.i(975157),a=e.i(736132),n=e.i(335889),i=e.i(356124),o=e.i(76220),l=e.i(112041),s=e.i(377148),d=e.i(271645),c=e.i(95187),u=(0,c.createServerReference)("406f1148ac8c944c123a879a5a50831e80edd1c881",c.callServer,void 0,c.findSourceMapURL,"getAudioDBAll"),f=(0,c.createServerReference)("4010580e2b2e70e4ab518276b600560b5f014c9338",c.callServer,void 0,c.findSourceMapURL,"getText"),g=(0,c.createServerReference)("40290df896b0c2cc3950fe0df32fcb966b88c77e5e",c.callServer,void 0,c.findSourceMapURL,"removeAudioDB"),h=(0,c.createServerReference)("40c48223cdf9f0523411addc8b3a5af27dc080809a",c.callServer,void 0,c.findSourceMapURL,"saveAudioDB"),x=e.i(490939),m=e.i(917648),v=e.i(473665),p=e.i(820738),b=e.i(673101),y=e.i(304361),w=e.i(500636),j=e.i(671508);function S(e){let{uuid:c,user_id:S}=e,[B,R]=(0,d.useState)(),[z,N]=(0,d.useState)(!1),[T,D]=(0,d.useState)([]),[A,C]=(0,d.useState)(1),[M,F]=(0,d.useState)(!1),[I,L]=(0,d.useState)(!1),[P,k]=(0,d.useState)("local"),[_,W]=(0,d.useState)([]),[U,E]=(0,d.useState)(!1),[O,H]=(0,d.useState)(!1),[K,V]=(0,d.useState)(),q=async()=>{if(!B)return;L(!0);let e=await (0,x.saveText)({...B,updated_at:new Date});"success"!==e.status&&(console.log(e.error),(0,a.addToast)({title:"save data error",color:"danger"})),L(!1)},G=async()=>{if(!K)return;L(!0);let e=(0,p.getBlobFromWeakCache)(K.uuid);if(e||(e=await (0,b.getBlobFromIndexedDB)(K.uuid)),!e){(0,a.addToast)({title:"Blob of audio not found",color:"danger"}),L(!1);return}let t=await (0,w.saveAudio)(e,"practice","".concat(K.uuid,".wav"));if("error"===t.status){console.log(t.error),(0,a.addToast)({title:"save data error",color:"danger"}),L(!1);return}let r=await h({uuid:K.uuid,user_id:S,text_uuid:K.text_uuid,recognized:K.recognized,audio_path:K.audio_path,created_by:S,created_at:K.created_at||new Date,updated_at:new Date});if("error"===r.status){console.log(r.error),(0,a.addToast)({title:"save data error",color:"danger"}),L(!1);return}await (0,b.deleteBlobFromIndexedDB)(K.uuid),(0,p.dropWeakCache)(K.uuid),V(void 0),(0,a.addToast)({title:"save data success",color:"success"}),L(!1),C(e=>e+1)},J=async e=>{await (0,b.deleteBlobFromIndexedDB)(e.uuid),(0,p.dropWeakCache)(e.uuid);let t=await (0,y.removeAudio)("practice","".concat(e.uuid,".wav"));if("error"===t.status){console.log(t.error),(0,a.addToast)({title:"remove data error",color:"danger"});return}let r=await g(e.uuid);if("error"===r.status){console.log(r.error),(0,a.addToast)({title:"remove data error",color:"danger"});return}(0,a.addToast)({title:"remove data success",color:"success"}),C(e=>e+1)},Q=async()=>{let e=async(e,t)=>{let n=(0,r.getUUID)();await (0,b.saveBlobToIndexedDB)(n,t),(0,p.cacheBlobInMemory)(n,t),V({uuid:n,user_id:S,text_uuid:c,audio_path:"/api/data/practice/".concat(n,".wav"),recognized:"success"===e.status?e.data:"",created_by:S,created_at:new Date,updated_at:new Date}),"error"===e.status&&(0,a.addToast)({title:e.error,color:"danger"})};await (0,j.toggleRecording)({mode:"audio",stateRecorder:_,setStateRecorder:W,stateRecording:U,setStateRecording:E,recognize:!0,sttEngine:P,setStateProcessing:H,handleAudio:e})};return(0,d.useEffect)(()=>{(async()=>{F(!0);let e=await f(c);"success"===e.status?R(e.data):(console.log(e.error),(0,a.addToast)({title:"load data error",color:"danger"}));let t=await u(c);"success"===t.status?D(t.data):(console.log(t.error),(0,a.addToast)({title:"load data error",color:"danger"})),F(!1)})()},[c,A]),(0,t.jsxs)("div",{className:"w-full space-y-4 mb-10",children:[M&&(0,t.jsx)("div",{className:"flex flex-row w-full items-center justify-center gap-4 my-4",children:(0,t.jsx)(l.Spinner,{classNames:{label:"text-foreground mt-4"},variant:"simple"})}),(null==B?void 0:B.user_id)===S?(0,t.jsxs)("div",{className:"flex flex-col w-full gap-2 my-4 p-2 rounded-lg bg-sand-300",children:[(0,t.jsx)("div",{className:"flex flex-row w-full items-end justify-end",children:(0,t.jsx)(n.Button,{variant:"solid",size:"sm",color:"primary",isDisabled:!z||I,onPress:q,children:"Save"})}),(0,t.jsx)(s.Textarea,{size:"lg",className:"w-full",classNames:{inputWrapper:"bg-sand-200",input:"text-xl"},defaultValue:B.text,onChange:e=>{R({...B,text:e.target.value}),N(!0)}})]}):(0,t.jsx)("div",{className:"flex flex-col w-full gap-2 my-4 p-2 rounded-lg bg-sand-300 text-xl",children:null==B?void 0:B.text}),(0,t.jsxs)("div",{className:"flex flex-col md:flex-row items-center justify-center gap-4 my-4",children:[(0,t.jsx)(i.Select,{className:"max-w-sm",selectedKeys:[P],onChange:e=>k(e.target.value),startContent:(0,t.jsx)("div",{className:"whitespace-nowrap font-bold",children:"AI Engine"}),children:j.EngineList.map(e=>(0,t.jsx)(o.SelectItem,{textValue:e.value,children:e.value},e.key))}),(0,t.jsx)(n.Button,{variant:"solid",color:"primary",id:"button-toggel-recording",isDisabled:!U&&O,onPress:async()=>{K&&V(void 0),await Q()},children:U?"â¹ Stop Recording":O?"Processing":"ðŸŽ¤ Read the Sentence"})]}),K&&(0,t.jsxs)("div",{className:"flex flex-col items-center justify-center w-full gap-2 my-4",children:[(0,t.jsxs)("div",{className:"flex flex-col w-full p-2 rounded-lg bg-sand-300",children:[(0,t.jsxs)("div",{className:"flex flex-row items-center justify-start",children:[(0,t.jsx)("div",{className:"text-md text-gray-400",children:"recognized from audio:"}),(0,t.jsx)(n.Button,{isIconOnly:!0,variant:"light",className:"h-fit",onPress:async()=>{let e=(0,p.getBlobFromWeakCache)(K.uuid);if(e||((e=await (0,b.getBlobFromIndexedDB)(K.uuid))?(0,p.cacheBlobInMemory)(K.uuid,e):(0,a.addToast)({title:"Blob of audio not found",color:"danger"})),e){let t=URL.createObjectURL(e),r=new Audio(t);r.play(),r.onended=()=>{URL.revokeObjectURL(t)}}},children:(0,t.jsx)(v.MdPlayCircle,{size:20})})]}),(0,t.jsx)("div",{className:"text-xl",children:(0,m.highlightDifferences)(B.text,K.recognized)})]}),(0,t.jsx)(n.Button,{variant:"solid",color:"primary",isDisabled:I,onPress:G,children:"Add & Save"})]}),T.length>0&&(0,t.jsx)("div",{className:"flex flex-col w-full gap-4 my-4 bg-sand-300",children:T.map((e,r)=>(0,t.jsxs)("div",{className:"flex flex-col w-full ps-2",children:[(0,t.jsxs)("div",{className:"flex flex-row items-center justify-start",children:[(0,t.jsxs)("div",{className:"flex flex-row items-center justify-start w-full",children:[(0,t.jsx)("div",{className:"text-md text-gray-400",children:"recognized from audio:"}),(0,t.jsx)(n.Button,{isIconOnly:!0,variant:"light",className:"h-fit",onPress:()=>{new Audio(e.audio_path).play()},children:(0,t.jsx)(v.MdPlayCircle,{size:20})})]}),(0,t.jsx)("div",{className:"flex flex-row items-center justify-end",children:(0,t.jsx)(n.Button,{isIconOnly:!0,variant:"light",color:"danger",className:"w-fit h-fit",onPress:()=>{window.confirm("Are you sure to delete?")&&J(e)},children:(0,t.jsx)(v.MdDelete,{size:20})})})]}),(0,t.jsx)("div",{className:"text-xl text-balance hyphens-auto",children:(0,m.highlightDifferences)((null==B?void 0:B.text)||"",e.recognized)}),(0,t.jsxs)("div",{className:"text-md text-gray-400",children:["by ",e.user_id]})]},"".concat(r,"-").concat(e.uuid)))})]})}}]);