(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,99749,e=>{"use strict";function a(e,a,s){return a in e?Object.defineProperty(e,a,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[a]=s,e}e.s(["_",()=>a])},58033,e=>{"use strict";e.s(["Chip",()=>g],58033);var a=e.i(73830),s=e.i(43027),t=e.i(29427),r=e.i(52841),l=e.i(84898),i=e.i(79754),o=(0,l.tv)({slots:{base:["relative","max-w-fit","min-w-min","inline-flex","items-center","justify-between","box-border","whitespace-nowrap"],content:"flex-1 text-inherit font-normal",dot:["w-2","h-2","ml-1","rounded-full"],avatar:"shrink-0",closeButton:["z-10","appearance-none","outline-solid outline-transparent","select-none","transition-opacity","opacity-70","hover:opacity-100","cursor-pointer","active:opacity-disabled","tap-highlight-transparent"]},variants:{variant:{solid:{},bordered:{base:"border-medium bg-transparent"},light:{base:"bg-transparent"},flat:{},faded:{base:"border-medium"},shadow:{},dot:{base:"border-medium border-default text-foreground bg-transparent"}},color:{default:{dot:"bg-default-400"},primary:{dot:"bg-primary"},secondary:{dot:"bg-secondary"},success:{dot:"bg-success"},warning:{dot:"bg-warning"},danger:{dot:"bg-danger"}},size:{sm:{base:"px-1 h-6 text-tiny",content:"px-1",closeButton:"text-medium",avatar:"w-4 h-4"},md:{base:"px-1 h-7 text-small",content:"px-2",closeButton:"text-large",avatar:"w-5 h-5"},lg:{base:"px-2 h-8 text-medium",content:"px-2",closeButton:"text-xl",avatar:"w-6 h-6"}},radius:{none:{base:"rounded-none"},sm:{base:"rounded-small"},md:{base:"rounded-medium"},lg:{base:"rounded-large"},full:{base:"rounded-full"}},isOneChar:{true:{},false:{}},isCloseable:{true:{},false:{}},hasStartContent:{true:{}},hasEndContent:{true:{}},isDisabled:{true:{base:"opacity-disabled pointer-events-none"}},isCloseButtonFocusVisible:{true:{closeButton:[...i.ringClasses,"ring-1","rounded-full"]}}},defaultVariants:{variant:"solid",color:"default",size:"md",radius:"full",isDisabled:!1},compoundVariants:[{variant:"solid",color:"default",class:{base:r.colorVariants.solid.default}},{variant:"solid",color:"primary",class:{base:r.colorVariants.solid.primary}},{variant:"solid",color:"secondary",class:{base:r.colorVariants.solid.secondary}},{variant:"solid",color:"success",class:{base:r.colorVariants.solid.success}},{variant:"solid",color:"warning",class:{base:r.colorVariants.solid.warning}},{variant:"solid",color:"danger",class:{base:r.colorVariants.solid.danger}},{variant:"shadow",color:"default",class:{base:r.colorVariants.shadow.default}},{variant:"shadow",color:"primary",class:{base:r.colorVariants.shadow.primary}},{variant:"shadow",color:"secondary",class:{base:r.colorVariants.shadow.secondary}},{variant:"shadow",color:"success",class:{base:r.colorVariants.shadow.success}},{variant:"shadow",color:"warning",class:{base:r.colorVariants.shadow.warning}},{variant:"shadow",color:"danger",class:{base:r.colorVariants.shadow.danger}},{variant:"bordered",color:"default",class:{base:r.colorVariants.bordered.default}},{variant:"bordered",color:"primary",class:{base:r.colorVariants.bordered.primary}},{variant:"bordered",color:"secondary",class:{base:r.colorVariants.bordered.secondary}},{variant:"bordered",color:"success",class:{base:r.colorVariants.bordered.success}},{variant:"bordered",color:"warning",class:{base:r.colorVariants.bordered.warning}},{variant:"bordered",color:"danger",class:{base:r.colorVariants.bordered.danger}},{variant:"flat",color:"default",class:{base:r.colorVariants.flat.default}},{variant:"flat",color:"primary",class:{base:r.colorVariants.flat.primary}},{variant:"flat",color:"secondary",class:{base:r.colorVariants.flat.secondary}},{variant:"flat",color:"success",class:{base:r.colorVariants.flat.success}},{variant:"flat",color:"warning",class:{base:r.colorVariants.flat.warning}},{variant:"flat",color:"danger",class:{base:r.colorVariants.flat.danger}},{variant:"faded",color:"default",class:{base:r.colorVariants.faded.default}},{variant:"faded",color:"primary",class:{base:r.colorVariants.faded.primary}},{variant:"faded",color:"secondary",class:{base:r.colorVariants.faded.secondary}},{variant:"faded",color:"success",class:{base:r.colorVariants.faded.success}},{variant:"faded",color:"warning",class:{base:r.colorVariants.faded.warning}},{variant:"faded",color:"danger",class:{base:r.colorVariants.faded.danger}},{variant:"light",color:"default",class:{base:r.colorVariants.light.default}},{variant:"light",color:"primary",class:{base:r.colorVariants.light.primary}},{variant:"light",color:"secondary",class:{base:r.colorVariants.light.secondary}},{variant:"light",color:"success",class:{base:r.colorVariants.light.success}},{variant:"light",color:"warning",class:{base:r.colorVariants.light.warning}},{variant:"light",color:"danger",class:{base:r.colorVariants.light.danger}},{isOneChar:!0,hasStartContent:!1,hasEndContent:!1,size:"sm",class:{base:"w-5 h-5 min-w-5 min-h-5"}},{isOneChar:!0,hasStartContent:!1,hasEndContent:!1,size:"md",class:{base:"w-6 h-6 min-w-6 min-h-6"}},{isOneChar:!0,hasStartContent:!1,hasEndContent:!1,size:"lg",class:{base:"w-7 h-7 min-w-7 min-h-7"}},{isOneChar:!0,isCloseable:!1,hasStartContent:!1,hasEndContent:!1,class:{base:"px-0 justify-center",content:"px-0 flex-none"}},{isOneChar:!0,isCloseable:!0,hasStartContent:!1,hasEndContent:!1,class:{base:"w-auto"}},{isOneChar:!0,variant:"dot",class:{base:"w-auto h-7 px-1 items-center",content:"px-2"}},{hasStartContent:!0,size:"sm",class:{content:"pl-0.5"}},{hasStartContent:!0,size:["md","lg"],class:{content:"pl-1"}},{hasEndContent:!0,size:"sm",class:{content:"pr-0.5"}},{hasEndContent:!0,size:["md","lg"],class:{content:"pr-1"}}]}),n=e.i(20253),c=e.i(75540),d=e.i(71645),u=e.i(19110),f=e.i(43476),m=(0,a.forwardRef)((e,r)=>{let{Component:l,children:i,slots:m,classNames:g,isDot:x,isCloseable:h,startContent:p,endContent:b,getCloseButtonProps:v,getChipProps:y}=function(e){let[r,l]=(0,a.mapPropsVariants)(e,o.variantKeys),{ref:i,as:u,children:f,avatar:m,startContent:g,endContent:x,onClose:h,classNames:p,className:b,...v}=r,y=(0,n.useDOMRef)(i),w=(0,c.clsx)(null==p?void 0:p.base,b),j=!!h,C="dot"===e.variant,{focusProps:N,isFocusVisible:V}=(0,t.useFocusRing)(),S=(0,d.useMemo)(()=>"string"==typeof f&&(null==f?void 0:f.length)===1,[f]),_=(0,d.useMemo)(()=>!!m||!!g,[m,g]),T=(0,d.useMemo)(()=>!!x||j,[x,j]),k=(0,d.useMemo)(()=>o({...l,hasStartContent:_,hasEndContent:T,isOneChar:S,isCloseable:j,isCloseButtonFocusVisible:V}),[(0,c.objectToDeps)(l),V,_,T,S,j]),{pressProps:P}=(0,s.usePress)({isDisabled:!!(null==e?void 0:e.isDisabled),onPress:h}),D=e=>(0,d.isValidElement)(e)?(0,d.cloneElement)(e,{className:(0,c.clsx)("max-h-[80%]",e.props.className)}):null;return{Component:u||"div",children:f,slots:k,classNames:p,isDot:C,isCloseable:j,startContent:((0,d.isValidElement)(m)?(0,d.cloneElement)(m,{className:k.avatar({class:null==p?void 0:p.avatar})}):null)||D(g),endContent:D(x),getCloseButtonProps:()=>({role:"button",tabIndex:0,className:k.closeButton({class:null==p?void 0:p.closeButton}),"aria-label":"close chip",...(0,c.mergeProps)(P,N)}),getChipProps:()=>({ref:y,className:k.base({class:w}),...v})}}({...e,ref:r}),w=(0,d.useMemo)(()=>x&&!p?(0,f.jsx)("span",{className:m.dot({class:null==g?void 0:g.dot})}):p,[m,p,x]),j=(0,d.useMemo)(()=>h?(0,f.jsx)("span",{...v(),children:b||(0,f.jsx)(u.CloseFilledIcon,{})}):b,[b,h,v]);return(0,f.jsxs)(l,{...y(),children:[w,(0,f.jsx)("span",{className:m.content({class:null==g?void 0:g.content}),children:i}),j]})});m.displayName="HeroUI.Chip";var g=m},89673,e=>{"use strict";e.s(["getCardAll",()=>s]);var a=e.i(95187),s=(0,a.createServerReference)("7e7a111bd66a3ef81bbc817edd70f0de99a11f92d8",a.callServer,void 0,a.findSourceMapURL,"getCardAll")},53962,e=>{"use strict";e.s(["getCardTag",()=>s]);var a=e.i(95187),s=(0,a.createServerReference)("60692b915c5c050e80f1d0a32155a947d51515ba31",a.callServer,void 0,a.findSourceMapURL,"getCardTag")},1138,e=>{"use strict";e.s(["default",()=>P],1138);var a=e.i(43476),s=e.i(71645),t=e.i(73837),r=e.i(70319),l=e.i(49649),i=e.i(86914),o=e.i(33716),n=e.i(8870),c=e.i(76331),d=e.i(32049),u=e.i(72853),f=e.i(24597),m=e.i(42976),g=e.i(35577),x=e.i(46399),h=e.i(64925),p=e.i(80229),b=e.i(29893),v=e.i(75157),y=e.i(84735),w=e.i(52315),j=e.i(53145);function C(e){let{user_id:l,card:i}=e,[o,n]=(0,s.useState)([]),[c,d]=(0,s.useState)([]),{handleSubmit:u}=(0,j.useForm)();(0,s.useEffect)(()=>{(async()=>{let e=await (0,t.getTagAll)(l);"success"===e.status&&n(e.data)})()},[l]);let m=async()=>{let e={...i,uuid:(0,v.getUUID)(),user_id:l,familiarity:0,note:(i.note?i.note+"\n":"")+'{"collect_from":'.concat(JSON.stringify(i.user_id),', "source_uuid":').concat(JSON.stringify(i.uuid),"}"),updated_at:new Date};if("success"!==(await (0,p.saveCard)(e)).status)return void r.toast.error("save card failed");r.toast.success("save card successfully"),"success"===(await (0,b.saveCardTag)({uuid:i.uuid,tag_list_new:c})).status?r.toast.success("save tag successfully"):r.toast.error("save tag failed")};return(0,a.jsx)("form",{onSubmit:u(m),children:(0,a.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,a.jsx)("div",{className:"flex flex-row items-center justify-start gap-1",children:o.length>0?(0,a.jsx)(w.CheckboxGroup,{color:"success",value:c,onValueChange:d,children:o.map(e=>(0,a.jsx)(y.Checkbox,{value:e.uuid,children:e.tag},e.uuid))}):(0,a.jsx)("div",{className:"px-1 pt-1",children:"not tag found"})}),(0,a.jsx)("div",{className:"flex flex-row items-center justify-end gap-1",children:(0,a.jsx)(f.Link,{as:"button",type:"submit",className:"bg-blue-500 rounded-md text-slate-50 px-2",children:"save"})})]})})}var N=e.i(53962),V=e.i(5483);function S(e){let{user_id:t,card:l,tag_list:i}=e,[o,n]=(0,s.useState)(!1),[c,d]=(0,s.useState)([]),[u,m]=(0,s.useState)([]),{handleSubmit:g}=(0,j.useForm)();(0,s.useEffect)(()=>{(async()=>{n(!0);let e=await (0,N.getCardTag)(t,l.uuid);"success"===e.status&&e.data.tag_list_added&&(d(e.data.tag_list_added.sort()),m(e.data.tag_list_added.filter(e=>i.map(e=>e.uuid).includes(e)).sort())),n(!1)})()},[t,l]);let x=async()=>{let e={uuid:l.uuid,tag_list_new:u.filter(e=>!c.includes(e)),tag_list_remove:c.filter(e=>!u.includes(e))};"success"===(await (0,b.saveCardTag)(e)).status?r.toast.success("save tag successfully"):r.toast.error("save tag failed")};return(0,a.jsx)("form",{onSubmit:g(x),children:(0,a.jsxs)("div",{className:"flex flex-col gap-4",children:[o?(0,a.jsx)(V.CircularProgress,{}):(0,a.jsx)(w.CheckboxGroup,{color:"success",value:u,onValueChange:e=>m(e.sort()),orientation:"vertical",children:i.map(e=>(0,a.jsx)(y.Checkbox,{value:e.uuid,children:e.tag},e.uuid))}),(0,a.jsx)("div",{className:"flex flex-row items-center justify-end gap-1",children:(0,a.jsx)(f.Link,{as:"button",type:"submit",className:"bg-blue-500 rounded-md text-slate-50 px-2",isDisabled:((e,a)=>{if(e.length!==a.length)return!1;let s=[...e].sort(),t=[...a].sort();return s.every((e,a)=>e===t[a])})(c,u),children:"save"})})]})})}var _=e.i(95187),T=(0,_.createServerReference)("607d89cbe2e906d294e66864db40125fca0430e327",_.callServer,void 0,_.findSourceMapURL,"setCardFamiliarity");function k(e){let{user_id:t,card:p,tag_list:b}=e,[v,y]=(0,s.useState)(p.familiarity),w=p.user_id===t,j=e=>w?l.FamiliarityList.map(e=>e.color)[e]:l.FamiliarityList.map(e=>e.color)[0];return(0,a.jsxs)("div",{className:"flex flex-col w-full items-start rounded-md p-1 ".concat(j(v)),children:[(0,a.jsx)("div",{className:"flex flex-row w-full items-center justify-start gap-2",children:(0,a.jsx)(f.Link,{target:"_blank",className:"text-2xl text-blue-600 hover:underline",href:"/card/".concat(p.uuid),children:(0,a.jsx)("pre",{className:"font-roboto leading-none text-wrap",children:p.question})})}),!w&&(0,a.jsx)(f.Link,{target:"_blank",className:"text-sm text-gray-500 hover:underline",href:"/card/market?user_id=".concat(p.user_id),children:"by ".concat(p.user_id)}),(0,a.jsxs)("div",{className:"flex flex-row w-full items-end justify-end gap-4",children:[w&&(0,a.jsx)(h.Tooltip,{content:"current: ".concat(v,"\n").concat(l.FamiliarityList.map(e=>e.description)[v]),children:(0,a.jsx)(i.ButtonGroup,{variant:"solid",color:"primary",children:(0,a.jsxs)(o.Dropdown,{placement:"bottom-end",children:[(0,a.jsx)(u.DropdownTrigger,{children:(0,a.jsx)(f.Link,{as:"button",isBlock:!0,className:"text-xl",children:"set familiarity"})}),(0,a.jsx)(c.DropdownMenu,{disallowEmptySelection:!0,className:"max-w-[300px]",selectionMode:"single",defaultSelectedKeys:[v],onSelectionChange:async e=>{if(e.currentKey){let a=parseInt(e.currentKey);y(a),await T(p.uuid,a)?r.toast.success("save familiarity successfully"):r.toast.error("save familiarity failed")}},children:(0,a.jsx)(d.DropdownSection,{items:l.FamiliarityList,children:l.FamiliarityList.map(e=>(0,a.jsx)(n.DropdownItem,{description:e.description,className:"".concat(j(e.value)),children:"".concat(e.value," - ").concat(e.label)},e.value))})})]})})}),w&&(0,a.jsxs)(m.Popover,{placement:"left",classNames:{content:"bg-slate-200"},children:[(0,a.jsx)(x.PopoverTrigger,{children:(0,a.jsx)(f.Link,{as:"button",isBlock:!0,className:"text-xl",children:"edit tag"})}),(0,a.jsx)(g.PopoverContent,{children:(0,a.jsx)(S,{user_id:t,card:p,tag_list:b})})]}),!w&&(0,a.jsxs)(m.Popover,{placement:"top-end",classNames:{content:"bg-slate-200"},children:[(0,a.jsx)(x.PopoverTrigger,{children:(0,a.jsx)(f.Link,{as:"button",isBlock:!0,className:"text-xl",children:"collect"})}),(0,a.jsx)(g.PopoverContent,{children:(0,a.jsx)(C,{user_id:t,card:p})})]})]})]})}function P(e){let{user_id:l,card_list:i}=e,[o,n]=(0,s.useState)([]);return(0,s.useEffect)(()=>{(async()=>{let e=await (0,t.getTagAll)(l);"success"===e.status?n(e.data):(console.log(e.error),r.toast.error("load data error"))})()},[l]),(0,a.jsx)("div",{className:"flex flex-col w-full gap-2",children:i.map(e=>(0,a.jsx)(k,{user_id:l,card:e,tag_list:o},e.uuid))})}},4365,e=>{"use strict";e.s(["default",()=>m]);var a=e.i(43476),s=e.i(71645),t=e.i(58033),r=e.i(5483),l=e.i(14060),i=e.i(212),o=e.i(98245),n=e.i(64925),c=e.i(1138),d=e.i(89673),u=e.i(49649),f=e.i(33401);function m(e){let{user_id:m,tag_list:g}=e,[x,h]=(0,s.useState)(u.FilterType.Normal),[p,b]=(0,s.useState)(!1),[v,y]=(0,s.useState)(u.TagUnspecified),[w,j]=(0,s.useState)([]),[C,N]=(0,s.useState)(1),[V,S]=(0,s.useState)(0),[_,T]=(0,s.useState)("");(0,s.useEffect)(()=>{(async()=>{b(!0);let e=await (0,d.getCardAll)(m,x,v,_,C,20);"success"===e.status?(j(e.data),S(e.total_pages||0)):console.log(e.error),b(!1)})()},[m,x,v,_,C]);let k=(e,s)=>(0,a.jsx)(t.Chip,{color:v===e?"success":"default",isDisabled:p,onClick:async()=>{y(e),N(1)},children:s},e);return(0,a.jsxs)("div",{className:"flex flex-col w-full gap-2 py-2 px-2",children:[(0,a.jsxs)("div",{className:"flex flex-row flex-wrap w-full items-center justify-start gap-1",children:[(0,a.jsx)("div",{className:"w-16",children:"Type"}),u.FilterTypeList.map(e=>{let s,r;return s=e.value,r=e.description,(0,a.jsx)(n.Tooltip,{placement:"bottom",className:"bg-slate-300",content:(0,a.jsx)("div",{className:"p-1",children:r}),children:(0,a.jsx)(t.Chip,{color:x===s?"success":"default",isDisabled:p,onClick:async()=>{h(s),N(1)},children:s})},s)})]}),(0,a.jsx)(l.Divider,{}),(0,a.jsxs)("div",{className:"flex flex-row flex-wrap w-full items-center justify-start gap-1",children:[(0,a.jsx)("div",{className:"w-16",children:"Tag"}),k(u.TagUnspecified,u.TagUnspecified),(0,a.jsx)(l.Divider,{orientation:"vertical",className:"mx-2 h-5"}),k(u.TagAll,u.TagAll),k(u.TagNo,u.TagNo),(0,a.jsx)(l.Divider,{orientation:"vertical",className:"mx-2 h-5"}),g.map(e=>k(e.uuid,e.tag))]}),(0,a.jsx)(l.Divider,{}),(0,a.jsx)("div",{className:"flex flex-row w-full items-center justify-start gap-1",children:(0,a.jsx)(i.Input,{isClearable:!0,radius:"md",size:"sm",placeholder:"search question",startContent:(0,a.jsx)(f.BiSearch,{className:"mb-0.5 dark:text-white/90 text-slate-400 pointer-events-none flex-shrink-0"}),value:_,onClear:()=>T(""),onChange:e=>T(e.target.value.trim()),onKeyDown:e=>{"Enter"==e.key&&_&&N(1)}})}),p?(0,a.jsx)("div",{className:"flex flex-row w-full items-center justify-center gap-4",children:(0,a.jsx)(r.CircularProgress,{label:"Loading..."})}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"flex flex-row items-center justify-center gap-4",children:[(0,a.jsx)("div",{children:"Page"}),(0,a.jsx)(o.Pagination,{showControls:!0,loop:!0,variant:"bordered",total:V,page:C,onChange:N})]}),(0,a.jsx)(c.default,{user_id:m,card_list:w}),(0,a.jsxs)("div",{className:"flex flex-row items-center justify-center gap-4",children:[(0,a.jsx)("div",{children:"Page"}),(0,a.jsx)(o.Pagination,{showControls:!0,loop:!0,variant:"bordered",total:V,page:C,onChange:N})]})]})]})}}]);