(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,99749,e=>{"use strict";function t(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}e.s(["_",()=>t])},72963,e=>{"use strict";e.s(["getCardAll",()=>a]);var t=e.i(95187),a=(0,t.createServerReference)("7ed32a2cae172c6328fce200a827b280585c0e2adf",t.callServer,void 0,t.findSourceMapURL,"getCardAll")},14850,e=>{"use strict";e.s(["getCardTag",()=>a]);var t=e.i(95187),a=(0,t.createServerReference)("60e9e1b18cbb65a2f9a6efbaa026e38a69d0dd7b0d",t.callServer,void 0,t.findSourceMapURL,"getCardTag")},1138,e=>{"use strict";e.s(["default",()=>k],1138);var t=e.i(43476),a=e.i(86914),s=e.i(24597),i=e.i(42976),l=e.i(35577),r=e.i(46399),c=e.i(64925),n=e.i(33716),o=e.i(8870),d=e.i(76331),u=e.i(32049),x=e.i(72853),g=e.i(71645),f=e.i(14850),m=e.i(79985),j=e.i(42593),h=e.i(84735),p=e.i(52315),v=e.i(5483),y=e.i(53145),b=e.i(70319);function w(e){let{email:a,card:i,tag_list:l}=e,[r,c]=(0,g.useState)(!1),[n,o]=(0,g.useState)(l||[]),[d,u]=(0,g.useState)([]),[x,w]=(0,g.useState)([]),{handleSubmit:S}=(0,y.useForm)();(0,g.useEffect)(()=>{(async()=>{c(!0);let e=n;if(0==n.length){let t=await (0,m.getTagAll)(a);if("success"!==t.status)return;e=t.data,o(t.data)}let t=await (0,f.getCardTag)(a,i.uuid);"success"===t.status&&t.data.tag_list_added&&(u(t.data.tag_list_added),w(t.data.tag_list_added.filter(t=>e.map(e=>e.uuid).includes(t)))),c(!1)})()},[]);let C=async()=>{let e={uuid:i.uuid,tag_list_new:x.filter(e=>!d.includes(e)),tag_list_remove:d.filter(e=>!x.includes(e))};"success"===(await (0,j.saveCardTag)(e)).status?b.toast.success("save tag successfully"):b.toast.error("save tag failed")};return(0,t.jsx)(t.Fragment,{children:r?(0,t.jsx)(v.CircularProgress,{}):(0,t.jsx)("form",{onSubmit:S(C),children:(0,t.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,t.jsx)("div",{className:"flex flex-row items-center justify-start gap-1",children:n.length>0?(0,t.jsx)(p.CheckboxGroup,{color:"success",value:x,onValueChange:w,orientation:"vertical",children:n.map(e=>(0,t.jsx)(h.Checkbox,{value:e.uuid,children:e.tag},e.uuid))}):(0,t.jsx)("div",{children:"not tag found"})}),(0,t.jsx)("div",{className:"flex flex-row items-center justify-end gap-1",children:(0,t.jsx)(s.Link,{as:"button",type:"submit",className:"bg-blue-500 rounded-md text-slate-50 px-2",children:"save"})})]})})})}var S=e.i(49649),C=e.i(95187),N=(0,C.createServerReference)("600309390cf49140ad01f5c03272122b4e6156f19d",C.callServer,void 0,C.findSourceMapURL,"setCardFamiliarity"),_=e.i(74843),P=e.i(75157);function L(e){let{email:a,card:i}=e,[l,r]=(0,g.useState)([]),[c,n]=(0,g.useState)([]),{handleSubmit:o}=(0,y.useForm)();(0,g.useEffect)(()=>{(async()=>{let e=await (0,m.getTagAll)(a);"success"===e.status&&r(e.data)})()},[]);let d=async()=>{let e={...i,uuid:(0,P.getUUID)(),user_id:a,familiarity:0,note:(i.note?i.note+"\n":"")+'{"collect_from":'.concat(JSON.stringify(i.user_id),', "source_uuid":').concat(JSON.stringify(i.uuid),"}"),updated_at:new Date};if("success"!==(await (0,_.saveCard)(e)).status)return void b.toast.error("save card failed");b.toast.success("save card successfully"),"success"===(await (0,j.saveCardTag)({uuid:i.uuid,tag_list_new:c})).status?b.toast.success("save tag successfully"):b.toast.error("save tag failed")};return(0,t.jsx)("form",{onSubmit:o(d),children:(0,t.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,t.jsx)("div",{className:"flex flex-row items-center justify-start gap-1",children:l.length>0?(0,t.jsx)(p.CheckboxGroup,{color:"success",value:c,onValueChange:n,children:l.map(e=>(0,t.jsx)(h.Checkbox,{value:e.uuid,children:e.tag},e.uuid))}):(0,t.jsx)("div",{className:"px-1 pt-1",children:"not tag found"})}),(0,t.jsx)("div",{className:"flex flex-row items-center justify-end gap-1",children:(0,t.jsx)(s.Link,{as:"button",type:"submit",className:"bg-blue-500 rounded-md text-slate-50 px-2",children:"save"})})]})})}function T(e){let{email:f,card:m,edit_view:j,tag_list:h}=e,[p,v]=(0,g.useState)(m.familiarity),y=m.user_id===f,C=e=>y?S.FamiliarityList.map(e=>e.color)[e]:S.FamiliarityList.map(e=>e.color)[0];return(0,t.jsxs)("div",{className:"flex flex-col w-full items-start rounded-md p-1 ".concat(C(p)),children:[(0,t.jsx)("div",{className:"flex flex-row w-full items-center justify-start gap-2",children:(0,t.jsx)(s.Link,{target:"_blank",href:"/card/".concat(m.uuid).concat(j?"?edit=y":""),className:"text-2xl text-blue-600 hover:underline",children:(0,t.jsx)("pre",{className:"font-roboto leading-none text-wrap",children:m.question})})}),!y&&(0,t.jsx)(s.Link,{target:"_blank",href:"/card/market?user_id=".concat(m.user_id),className:"text-sm text-gray-500 hover:underline",children:"by ".concat(m.user_id)}),(0,t.jsxs)("div",{className:"flex flex-row w-full items-end justify-end gap-4",children:[y&&(0,t.jsx)(c.Tooltip,{content:"current: ".concat(p,"\n").concat(S.FamiliarityList.map(e=>e.description)[p]),children:(0,t.jsx)(a.ButtonGroup,{variant:"solid",color:"primary",children:(0,t.jsxs)(n.Dropdown,{placement:"bottom-end",children:[(0,t.jsx)(x.DropdownTrigger,{children:(0,t.jsx)(s.Link,{as:"button",isBlock:!0,className:"text-xl",children:"set familiarity"})}),(0,t.jsx)(d.DropdownMenu,{disallowEmptySelection:!0,className:"max-w-[300px]",selectionMode:"single",defaultSelectedKeys:[p],onSelectionChange:async e=>{if(e.currentKey){let t=parseInt(e.currentKey);v(t),await N(m.uuid,t)?b.toast.success("save familiarity successfully"):b.toast.error("save familiarity failed")}},children:(0,t.jsx)(u.DropdownSection,{items:S.FamiliarityList,children:S.FamiliarityList.map(e=>(0,t.jsx)(o.DropdownItem,{description:e.description,className:"".concat(C(e.value)),children:"".concat(e.value," - ").concat(e.label)},e.value))})})]})})}),y&&(0,t.jsxs)(i.Popover,{placement:"left",classNames:{content:"bg-slate-200"},children:[(0,t.jsx)(r.PopoverTrigger,{children:(0,t.jsx)(s.Link,{as:"button",isBlock:!0,className:"text-xl",children:"edit tag"})}),(0,t.jsx)(l.PopoverContent,{children:(0,t.jsx)(w,{email:f,card:m,tag_list:h||[]})})]}),!y&&(0,t.jsxs)(i.Popover,{placement:"top-end",classNames:{content:"bg-slate-200"},children:[(0,t.jsx)(r.PopoverTrigger,{children:(0,t.jsx)(s.Link,{as:"button",isBlock:!0,className:"text-xl",children:"collect"})}),(0,t.jsx)(l.PopoverContent,{children:(0,t.jsx)(L,{email:f,card:m})})]})]})]})}function k(e){let{email:a,edit_view:s,card_list:i}=e;return(0,t.jsx)("div",{className:"flex flex-col w-full gap-2",children:i.map(e=>(0,t.jsx)(T,{email:a,card:e,edit_view:s},e.uuid))})}},77573,e=>{"use strict";e.s(["default",()=>g]);var t=e.i(43476),a=e.i(71645),s=e.i(35889),i=e.i(5483),l=e.i(98245),r=e.i(56124),c=e.i(76220),n=e.i(1138),o=e.i(72963),d=e.i(79985),u=e.i(49649),x=e.i(70319);function g(e){let{user_id_my:g}=e,[f,m]=(0,a.useState)(!1),[j,h]=(0,a.useState)([]),[p,v]=(0,a.useState)(""),[y,b]=(0,a.useState)([]),[w,S]=(0,a.useState)(1),[C,N]=(0,a.useState)(0),_=async()=>{m(!0);let e=await (0,d.getTagAll)(g);"success"===e.status?h(e.data):x.toast.error(e.error),m(!1)},P=async()=>{m(!0);let e=await (0,o.getCardAll)(g,u.FilterType.Normal,p,"",w,20);"success"===e.status?(console.log(e.total_records),b(e.data),N(e.total_pages||0)):x.toast.error(e.error),m(!1)};return(0,a.useEffect)(()=>{_(),P()},[p,w]),(0,t.jsxs)("div",{className:"flex flex-col w-full gap-2 py-2 px-2",children:[(0,t.jsx)(r.Select,{label:"Select tag",onChange:e=>v(e.target.value),endContent:f&&(0,t.jsx)(i.CircularProgress,{"aria-label":"Loading...",color:"default"}),children:j.map(e=>(0,t.jsx)(c.SelectItem,{textValue:e.tag,children:e.tag},e.uuid))}),(0,t.jsxs)("div",{className:"flex flex-col items-center justify-start gap-4",children:[(0,t.jsx)("div",{children:"delete all card under this tag"}),(0,t.jsx)("div",{className:"flex flex-row items-center justify-center gap-4",children:(0,t.jsx)(s.Button,{variant:"solid",color:"primary",id:"button-toggel-recording",isDisabled:!p,children:"Clear data"})})]}),(0,t.jsxs)("div",{className:"flex flex-row items-center justify-center gap-4",children:[(0,t.jsx)("div",{children:"Page"}),(0,t.jsx)(l.Pagination,{showControls:!0,loop:!0,variant:"bordered",total:C,page:w,onChange:S})]}),f?(0,t.jsx)("div",{className:"flex flex-row w-full items-center justify-center gap-4",children:(0,t.jsx)(i.CircularProgress,{label:"Loading..."})}):(0,t.jsx)(n.default,{email:g,card_list:y,edit_view:!1}),(0,t.jsxs)("div",{className:"flex flex-row items-center justify-center gap-4",children:[(0,t.jsx)("div",{children:"Page"}),(0,t.jsx)(l.Pagination,{showControls:!0,loop:!0,variant:"bordered",total:C,page:w,onChange:S})]})]})}},47515,e=>{"use strict";e.s(["default",()=>g]);var t=e.i(43476),a=e.i(71645),s=e.i(35889),i=e.i(5483),l=e.i(98245),r=e.i(56124),c=e.i(76220),n=e.i(1138),o=e.i(72963),d=e.i(79985),u=e.i(49649),x=e.i(70319);function g(e){let{user_id_my:g,user_id_another:f}=e,[m,j]=(0,a.useState)(!1),[h,p]=(0,a.useState)([]),[v,y]=(0,a.useState)(""),[b,w]=(0,a.useState)([]),[S,C]=(0,a.useState)(""),[N,_]=(0,a.useState)([]),[P,L]=(0,a.useState)(1),[T,k]=(0,a.useState)(0),A=async()=>{j(!0);let e=await (0,d.getTagAll)(f);"success"===e.status?p(e.data):x.toast.error(e.error);let t=await (0,d.getTagAll)(g);"success"===t.status?w(t.data):x.toast.error(t.error),j(!1)},F=async()=>{j(!0);let e=await (0,o.getCardAll)(f,u.FilterType.Normal,v,"",P,20);"success"===e.status?(console.log(e.total_records),_(e.data),k(e.total_pages||0)):x.toast.error(e.error),j(!1)};return(0,a.useEffect)(()=>{A(),F()},[v,P]),(0,t.jsxs)("div",{className:"flex flex-col w-full gap-2 py-2 px-2",children:[(0,t.jsx)(r.Select,{label:"Select tag",onChange:e=>y(e.target.value),endContent:m&&(0,t.jsx)(i.CircularProgress,{"aria-label":"Loading...",color:"default"}),children:h.map(e=>(0,t.jsx)(c.SelectItem,{textValue:e.tag,children:e.tag},e.uuid))}),(0,t.jsxs)("div",{className:"flex flex-col items-center justify-start gap-4",children:[(0,t.jsx)("div",{children:"copy to my cards"}),(0,t.jsxs)("div",{className:"flex flex-row items-center justify-center gap-4",children:[(0,t.jsx)(r.Select,{label:"Select my tag",onChange:e=>C(e.target.value),endContent:m&&(0,t.jsx)(i.CircularProgress,{"aria-label":"Loading...",color:"default"}),children:h.map(e=>(0,t.jsx)(c.SelectItem,{textValue:e.tag,children:e.tag},e.uuid))}),(0,t.jsx)(s.Button,{variant:"solid",color:"primary",id:"button-toggel-recording",isDisabled:!S||!v,children:"Collect"})]})]}),(0,t.jsxs)("div",{className:"flex flex-row items-center justify-center gap-4",children:[(0,t.jsx)("div",{children:"Page"}),(0,t.jsx)(l.Pagination,{showControls:!0,loop:!0,variant:"bordered",total:T,page:P,onChange:L})]}),m?(0,t.jsx)("div",{className:"flex flex-row w-full items-center justify-center gap-4",children:(0,t.jsx)(i.CircularProgress,{label:"Loading..."})}):(0,t.jsx)(n.default,{email:g,card_list:N,edit_view:!1}),(0,t.jsxs)("div",{className:"flex flex-row items-center justify-center gap-4",children:[(0,t.jsx)("div",{children:"Page"}),(0,t.jsx)(l.Pagination,{showControls:!0,loop:!0,variant:"bordered",total:T,page:P,onChange:L})]})]})}}]);