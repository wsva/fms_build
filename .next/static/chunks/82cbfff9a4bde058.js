(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,99749,e=>{"use strict";function t(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}e.s(["_",()=>t])},77148,e=>{"use strict";e.s(["Textarea",()=>U],77148);var t=e.i(34738),r=e.i(75540),a=e.i(73830),i=e.i(71645);function n(){return(n=Object.assign.bind()).apply(null,arguments)}var s=i.useLayoutEffect,o=function(e){var t=i.default.useRef(e);return s(function(){t.current=e}),t},l=function(e,t){if("function"==typeof e)return void e(t);e.current=t},d=function(e,t){var r=i.default.useRef();return i.default.useCallback(function(a){e.current=a,r.current&&l(r.current,null),r.current=t,t&&l(t,a)},[t])},c={"min-height":"0","max-height":"none",height:"0",visibility:"hidden",overflow:"hidden",position:"absolute","z-index":"-1000",top:"0",right:"0",display:"block"},u=function(e){Object.keys(c).forEach(function(t){e.style.setProperty(t,c[t],"important")})},f=null,v=function(e,t){var r=e.scrollHeight;return"border-box"===t.sizingStyle.boxSizing?r+t.borderSize:r-t.paddingSize},x=function(){},g=["borderBottomWidth","borderLeftWidth","borderRightWidth","borderTopWidth","boxSizing","fontFamily","fontSize","fontStyle","fontWeight","letterSpacing","lineHeight","paddingBottom","paddingLeft","paddingRight","paddingTop","tabSize","textIndent","textRendering","textTransform","width","wordBreak","wordSpacing","scrollbarGutter"],m=!!document.documentElement.currentStyle,p=function(e){var t=window.getComputedStyle(e);if(null===t)return null;var r=g.reduce(function(e,r){return e[r]=t[r],e},{}),a=r.boxSizing;if(""===a)return null;m&&"border-box"===a&&(r.width=parseFloat(r.width)+parseFloat(r.borderRightWidth)+parseFloat(r.borderLeftWidth)+parseFloat(r.paddingRight)+parseFloat(r.paddingLeft)+"px");var i=parseFloat(r.paddingBottom)+parseFloat(r.paddingTop),n=parseFloat(r.borderBottomWidth)+parseFloat(r.borderTopWidth);return{sizingStyle:r,paddingSize:i,borderSize:n}};function h(e,t,r){var a=o(r);i.useLayoutEffect(function(){var r=function(e){return a.current(e)};if(e)return e.addEventListener(t,r),function(){return e.removeEventListener(t,r)}},[])}var b=function(e,t){h(document.body,"reset",function(r){e.current.form===r.target&&t(r)})},y=function(e){h(window,"resize",e)},w=function(e){h(document.fonts,"loadingdone",e)},S=["cacheMeasurements","maxRows","minRows","onChange","onHeightChange"],j=i.forwardRef(function(e,t){var r=e.cacheMeasurements,a=e.maxRows,s=e.minRows,o=e.onChange,l=void 0===o?x:o,c=e.onHeightChange,g=void 0===c?x:c,m=function(e,t){if(null==e)return{};var r={};for(var a in e)if(({}).hasOwnProperty.call(e,a)){if(-1!==t.indexOf(a))continue;r[a]=e[a]}return r}(e,S),h=void 0!==m.value,j=i.useRef(null),R=d(j,t),L=i.useRef(0),A=i.useRef(),U=function(){var e=j.current,t=r&&A.current?A.current:p(e);if(t){A.current=t;var i,n,o,l,d,c,x,m,h,b,y,w=(i=e.value||e.placeholder||"x",void 0===(n=s)&&(n=1),void 0===(o=a)&&(o=1/0),f||((f=document.createElement("textarea")).setAttribute("tabindex","-1"),f.setAttribute("aria-hidden","true"),u(f)),null===f.parentNode&&document.body.appendChild(f),l=t.paddingSize,d=t.borderSize,x=(c=t.sizingStyle).boxSizing,Object.keys(c).forEach(function(e){f.style[e]=c[e]}),u(f),f.value=i,m=v(f,t),f.value=i,m=v(f,t),f.value="x",b=(h=f.scrollHeight-l)*n,"border-box"===x&&(b=b+l+d),m=Math.max(b,m),y=h*o,"border-box"===x&&(y=y+l+d),[m=Math.min(y,m),h]),S=w[0],R=w[1];L.current!==S&&(L.current=S,e.style.setProperty("height",S+"px","important"),g(S,{rowHeight:R}))}};return i.useLayoutEffect(U),b(j,function(){if(!h){var e=j.current.value;requestAnimationFrame(function(){var t=j.current;t&&e!==t.value&&U()})}}),y(U),w(U),i.createElement("textarea",n({},m,{onChange:function(e){h||U(),l(e)},ref:R}))}),R=e.i(19110),L=e.i(43476),A=(0,a.forwardRef)((e,a)=>{let{style:n,minRows:s=3,maxRows:o=8,cacheMeasurements:l=!1,disableAutosize:d=!1,onHeightChange:c,...u}=e,{Component:f,label:v,description:x,startContent:g,endContent:m,hasHelper:p,shouldLabelBeOutside:h,shouldLabelBeInside:b,isInvalid:y,errorMessage:w,getBaseProps:S,getLabelProps:A,getInputProps:U,getInnerWrapperProps:N,getInputWrapperProps:k,getHelperWrapperProps:C,getDescriptionProps:z,getErrorMessageProps:_,isClearable:O,getClearButtonProps:E}=(0,t.useInput)({...u,ref:a,isMultiline:!0}),[M,P]=(0,i.useState)(s>1),[F,T]=(0,i.useState)(!1),B=v?(0,L.jsx)("label",{...A(),children:v}):null,H=U(),I=d?(0,L.jsx)("textarea",{...H,style:(0,r.mergeProps)(H.style,null!=n?n:{})}):(0,L.jsx)(j,{...H,cacheMeasurements:l,"data-hide-scroll":(0,r.dataAttr)(!F),maxRows:o,minRows:s,style:(0,r.mergeProps)(H.style,null!=n?n:{}),onHeightChange:(e,t)=>{1===s&&P(e>=2*t.rowHeight),o>s&&T(e>=o*t.rowHeight),null==c||c(e,t)}}),W=(0,i.useMemo)(()=>O?(0,L.jsx)("button",{...E(),children:(0,L.jsx)(R.CloseFilledIcon,{})}):null,[O,E]),D=(0,i.useMemo)(()=>g||m?(0,L.jsxs)("div",{...N(),children:[g,I,m]}):(0,L.jsx)("div",{...N(),children:I}),[g,H,m,N]),K=y&&w,V=K||x;return(0,L.jsxs)(f,{...S(),children:[h?B:null,(0,L.jsxs)("div",{...k(),"data-has-multiple-rows":(0,r.dataAttr)(M),children:[b?B:null,D,W]}),p&&V?(0,L.jsx)("div",{...C(),children:K?(0,L.jsx)("div",{..._(),children:w}):(0,L.jsx)("div",{...z(),children:x})}):null]})});A.displayName="HeroUI.Textarea";var U=A},16863,75687,e=>{"use strict";e.s(["removeAudio",()=>r],16863);var t=e.i(95187),r=(0,t.createServerReference)("60f602269e6fdde8b2dd34de418bab3fc8fd6f767c",t.callServer,void 0,t.findSourceMapURL,"removeAudio");e.s(["saveAudio",()=>a],75687);var a=(0,t.createServerReference)("7002f4a2e36b6b1d47b5ef3f18fba9545458dc2c2c",t.callServer,void 0,t.findSourceMapURL,"saveAudio")},92744,e=>{"use strict";e.s(["default",()=>y],92744);var t=e.i(43476),r=e.i(75157),a=e.i(35889),i=e.i(56124),n=e.i(76220),s=e.i(12041),o=e.i(77148),l=e.i(71645),d=e.i(70319),c=e.i(16863),u=e.i(75687),f=e.i(71508),v=e.i(95187),x=(0,v.createServerReference)("40a75ffbd7e8840b67a5ef9f6a33c3fbe12b55faa5",v.callServer,void 0,v.findSourceMapURL,"getAnswerAll"),g=(0,v.createServerReference)("40117c90bacf875ee92e029c4a22babe228cf94993",v.callServer,void 0,v.findSourceMapURL,"getQuestion"),m=(0,v.createServerReference)("40e38e8f920cb68186ec065bb1c88a7e209880e247",v.callServer,void 0,v.findSourceMapURL,"removeAnswer"),p=(0,v.createServerReference)("40b06ac1d5ef66a0aa1431fe8a1e7db0819839d85d",v.callServer,void 0,v.findSourceMapURL,"saveAnswer"),h=e.i(24597);function b(e){let{user_id:r,item:a,handleDelete:i}=e;return(0,t.jsxs)("div",{className:"flex flex-col w-full items-start rounded-md p-1",children:[(0,t.jsx)("div",{className:"flex flex-row w-full items-center justify-start gap-2",children:a.content}),(0,t.jsxs)("div",{className:"flex flex-row w-full items-center justify-end gap-4",children:[(0,t.jsx)(h.Link,{target:"_blank",href:"/speak/practice?user_id=".concat(a.user_id),className:"text-sm text-gray-500 hover:underline w-full",children:"by ".concat(a.user_id)}),a.user_id===r&&(0,t.jsx)(h.Link,{as:"button",isBlock:!0,color:"danger",className:"text-xl",onPress:async()=>{window.confirm("Are you sure to delete?")&&await i(a)},children:"delete"})]})]})}function y(e){let{question_uuid:v,user_id:h}=e,[y,w]=(0,l.useState)(),[S,j]=(0,l.useState)([]),[R,L]=(0,l.useState)(1),[A,U]=(0,l.useState)(!1),[N,k]=(0,l.useState)(!1),[C,z]=(0,l.useState)("local"),[_,O]=(0,l.useState)("video"),[E,M]=(0,l.useState)(),[P,F]=(0,l.useState)([]),[T,B]=(0,l.useState)(!1),[H,I]=(0,l.useState)(!1),[W,D]=(0,l.useState)(),[K,V]=(0,l.useState)(),[q,G]=(0,l.useState)(),Q=(0,l.useRef)(null),J=async e=>{if(e.audio_path){let t=await (0,c.removeAudio)("ask","".concat(e.uuid,".wav"));if("error"===t.status){console.log(t.error),d.toast.error("delete failed");return}}if(e.video_path){let t=await (0,c.removeAudio)("ask","".concat(e.uuid,".mp4"));if("error"===t.status){console.log(t.error),d.toast.error("delete failed");return}}"success"===(await m(e.uuid)).status?(d.toast.success("delete success"),L(e=>e+1)):d.toast.error("delete failed")},X=async()=>{if(!q)return void alert("content is empty");if(!K)return void alert("audio is empty");let e=(0,r.getUUID)();if(k(!0),W&&"error"===(await (0,u.saveAudio)(W.data,"ask","".concat(e,".mp4"))).status){d.toast.error("save video failed"),k(!1);return}if(K&&"error"===(await (0,u.saveAudio)(K.data,"ask","".concat(e,".wav"))).status){d.toast.error("save audio failed"),k(!1);return}"success"===(await p({uuid:e,user_id:h,question_uuid:v,audio_path:K?"/api/data/ask/".concat(e,".wav"):"",video_path:W?"/api/data/ask/".concat(e,".mp4"):"",content:q,created_by:h,created_at:new Date,updated_at:new Date})).status?(d.toast.success("add success"),G(""),W&&(URL.revokeObjectURL(W.url),D(void 0)),K&&(URL.revokeObjectURL(K.url),V(void 0)),L(e=>e+1)):d.toast.error("add failed"),k(!1)},Y=async()=>{W&&(URL.revokeObjectURL(W.url),D(void 0)),K&&(URL.revokeObjectURL(K.url),V(void 0));let e=async e=>{D({data:e,url:URL.createObjectURL(e)})},t=async(e,t)=>{V({data:t,url:URL.createObjectURL(t)}),G("success"===e.status?e.data:""),"error"===e.status&&d.toast.error(e.error)};await (0,f.toggleRecording)({mode:_,setStateStream:M,stateRecorder:P,setStateRecorder:F,stateRecording:T,setStateRecording:B,recognize:!0,sttEngine:C,setStateProcessing:I,handleVideo:e,handleAudio:t})};return(0,l.useEffect)(()=>{let e=async()=>{U(!0);let e=await x(v);"success"===e.status?j(e.data):(console.log(e.error),d.toast.error("load data error")),U(!1)};(async()=>{U(!0);let e=await g(v);"success"===e.status?w(e.data):(console.log(e.error),d.toast.error("load data error")),U(!1)})(),e(),Q.current&&E&&(Q.current.srcObject=E)},[v,R,Q,E]),(0,t.jsxs)("div",{className:"w-full space-y-4 mb-10",children:[!!y&&(y.user_id===h?(0,t.jsx)("div",{className:"flex flex-col w-full gap-2 my-4 p-2 rounded-lg bg-sand-300",children:(0,t.jsx)("div",{className:"flex flex-col w-full gap-2 my-4 p-2 rounded-lg bg-sand-300 text-xl",children:y.title})}):(0,t.jsx)("div",{className:"flex flex-col w-full gap-2 my-4 p-2 rounded-lg bg-sand-300 text-xl",children:y.title})),(0,t.jsxs)("div",{className:"flex flex-col lg:flex-row items-center justify-center gap-4 my-4",children:[(0,t.jsx)(i.Select,{"aria-label":"stt engine",className:"max-w-sm",selectedKeys:[C],onChange:e=>z(e.target.value),startContent:(0,t.jsx)("div",{className:"whitespace-nowrap font-bold",children:"AI Engine"}),children:f.EngineList.map(e=>(0,t.jsx)(n.SelectItem,{textValue:e.value,children:e.value},e.key))}),(0,t.jsxs)(i.Select,{"aria-label":"stt engine",className:"max-w-sm",selectedKeys:[_],onChange:e=>O(e.target.value),startContent:(0,t.jsx)("div",{className:"whitespace-nowrap font-bold",children:"Mode"}),children:[(0,t.jsx)(n.SelectItem,{textValue:"video",children:"video"},"video"),(0,t.jsx)(n.SelectItem,{textValue:"audio",children:"audio"},"audio")]}),(0,t.jsx)(a.Button,{variant:"solid",color:"primary",id:"button-toggel-recording",isDisabled:!T&&H,onPress:async()=>{await Y()},children:T?"â¹ Stop Recording (Ctrl+A)":H?"Processing":"ðŸŽ¤ Read a Sentence (Ctrl+A)"})]}),T?(0,t.jsx)("video",{ref:Q,autoPlay:!0,muted:!0,playsInline:!0}):(0,t.jsxs)("div",{className:"flex flex-col items-center justify-center w-full gap-2 my-4",children:[!!K&&(0,t.jsx)("audio",{controls:!0,src:K.url}),!!W&&(0,t.jsx)("video",{controls:!0,src:W.url}),(0,t.jsx)(o.Textarea,{size:"lg",className:"w-full",label:"content",classNames:{inputWrapper:"bg-sand-200",input:"text-xl"},value:q,onChange:e=>G(e.target.value)}),(0,t.jsx)(a.Button,{variant:"solid",color:"primary",id:"button-add-save",isDisabled:N,onPress:X,children:"Add & Save (Ctrl+S)"})]}),A&&(0,t.jsx)("div",{className:"flex flex-row w-full items-center justify-center gap-4 my-4",children:(0,t.jsx)(s.Spinner,{classNames:{label:"text-foreground mt-4"},variant:"simple"})}),(0,t.jsx)("div",{className:"flex flex-col w-full gap-4 my-4",children:S.map((e,r)=>(0,t.jsx)(b,{user_id:h,item:e,handleDelete:J},"".concat(r,"-").concat(e.uuid)))})]})}}]);