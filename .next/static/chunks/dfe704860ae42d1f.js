(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,99749,e=>{"use strict";function t(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}e.s(["_",()=>t])},3099,e=>{"use strict";e.s(["getCardAll",()=>a]);var t=e.i(95187),a=(0,t.createServerReference)("7ec4f279cabcbfbd17e6b3c2b897030eaf8ba1909b",t.callServer,void 0,t.findSourceMapURL,"getCardAll")},83144,e=>{"use strict";e.s(["getCardTag",()=>a]);var t=e.i(95187),a=(0,t.createServerReference)("6090fbf9b231a72637064a929999629b3fdc9bf8c6",t.callServer,void 0,t.findSourceMapURL,"getCardTag")},1138,e=>{"use strict";e.s(["default",()=>k],1138);var t=e.i(43476),a=e.i(71645),s=e.i(61707),l=e.i(70319),r=e.i(49649),i=e.i(86914),c=e.i(33716),n=e.i(8870),o=e.i(76331),d=e.i(32049),u=e.i(72853),x=e.i(24597),f=e.i(42976),g=e.i(35577),m=e.i(46399),p=e.i(64925),j=e.i(84305),h=e.i(40298),v=e.i(75157),b=e.i(84735),y=e.i(52315),w=e.i(53145);function S(e){let{user_id:r,card:i}=e,[c,n]=(0,a.useState)([]),[o,d]=(0,a.useState)([]),{handleSubmit:u}=(0,w.useForm)();(0,a.useEffect)(()=>{(async()=>{let e=await (0,s.getTagAll)(r);"success"===e.status&&n(e.data)})()},[r]);let f=async()=>{let e={...i,uuid:(0,v.getUUID)(),user_id:r,familiarity:0,note:(i.note?i.note+"\n":"")+'{"collect_from":'.concat(JSON.stringify(i.user_id),', "source_uuid":').concat(JSON.stringify(i.uuid),"}"),updated_at:new Date};if("success"!==(await (0,j.saveCard)(e)).status)return void l.toast.error("save card failed");l.toast.success("save card successfully"),"success"===(await (0,h.saveCardTag)({uuid:i.uuid,tag_list_new:o})).status?l.toast.success("save tag successfully"):l.toast.error("save tag failed")};return(0,t.jsx)("form",{onSubmit:u(f),children:(0,t.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,t.jsx)("div",{className:"flex flex-row items-center justify-start gap-1",children:c.length>0?(0,t.jsx)(y.CheckboxGroup,{color:"success",value:o,onValueChange:d,children:c.map(e=>(0,t.jsx)(b.Checkbox,{value:e.uuid,children:e.tag},e.uuid))}):(0,t.jsx)("div",{className:"px-1 pt-1",children:"not tag found"})}),(0,t.jsx)("div",{className:"flex flex-row items-center justify-end gap-1",children:(0,t.jsx)(x.Link,{as:"button",type:"submit",className:"bg-blue-500 rounded-md text-slate-50 px-2",children:"save"})})]})})}var C=e.i(83144),N=e.i(5483);function _(e){let{user_id:s,card:r,tag_list:i}=e,[c,n]=(0,a.useState)(!1),[o,d]=(0,a.useState)([]),[u,f]=(0,a.useState)([]),{handleSubmit:g}=(0,w.useForm)();(0,a.useEffect)(()=>{(async()=>{n(!0);let e=await (0,C.getCardTag)(s,r.uuid);"success"===e.status&&e.data.tag_list_added&&(d(e.data.tag_list_added.sort()),f(e.data.tag_list_added.filter(e=>i.map(e=>e.uuid).includes(e)).sort())),n(!1)})()},[s,r]);let m=async()=>{let e={uuid:r.uuid,tag_list_new:u.filter(e=>!o.includes(e)),tag_list_remove:o.filter(e=>!u.includes(e))};"success"===(await (0,h.saveCardTag)(e)).status?l.toast.success("save tag successfully"):l.toast.error("save tag failed")};return(0,t.jsx)("form",{onSubmit:g(m),children:(0,t.jsxs)("div",{className:"flex flex-col gap-4",children:[c?(0,t.jsx)(N.CircularProgress,{}):(0,t.jsx)(y.CheckboxGroup,{color:"success",value:u,onValueChange:e=>f(e.sort()),orientation:"vertical",children:i.map(e=>(0,t.jsx)(b.Checkbox,{value:e.uuid,children:e.tag},e.uuid))}),(0,t.jsx)("div",{className:"flex flex-row items-center justify-end gap-1",children:(0,t.jsx)(x.Link,{as:"button",type:"submit",className:"bg-blue-500 rounded-md text-slate-50 px-2",isDisabled:((e,t)=>{if(e.length!==t.length)return!1;let a=[...e].sort(),s=[...t].sort();return a.every((e,t)=>e===s[t])})(o,u),children:"save"})})]})})}var P=e.i(95187),T=(0,P.createServerReference)("6083de0887c409ccfb597c93df6e9eb3afdb4710c6",P.callServer,void 0,P.findSourceMapURL,"setCardFamiliarity");function L(e){let{user_id:s,card:j,tag_list:h}=e,[v,b]=(0,a.useState)(j.familiarity),y=j.user_id===s,w=e=>y?r.FamiliarityList.map(e=>e.color)[e]:r.FamiliarityList.map(e=>e.color)[0];return(0,t.jsxs)("div",{className:"flex flex-col w-full items-start rounded-md p-1 ".concat(w(v)),children:[(0,t.jsx)("div",{className:"flex flex-row w-full items-center justify-start gap-2",children:(0,t.jsx)(x.Link,{target:"_blank",className:"text-2xl text-blue-600 hover:underline",href:"/card/".concat(j.uuid),children:(0,t.jsx)("pre",{className:"font-roboto leading-none text-wrap",children:j.question})})}),!y&&(0,t.jsx)(x.Link,{target:"_blank",className:"text-sm text-gray-500 hover:underline",href:"/card/market?user_id=".concat(j.user_id),children:"by ".concat(j.user_id)}),(0,t.jsxs)("div",{className:"flex flex-row w-full items-end justify-end gap-4",children:[y&&(0,t.jsx)(p.Tooltip,{content:"current: ".concat(v,"\n").concat(r.FamiliarityList.map(e=>e.description)[v]),children:(0,t.jsx)(i.ButtonGroup,{variant:"solid",color:"primary",children:(0,t.jsxs)(c.Dropdown,{placement:"bottom-end",children:[(0,t.jsx)(u.DropdownTrigger,{children:(0,t.jsx)(x.Link,{as:"button",isBlock:!0,className:"text-xl",children:"set familiarity"})}),(0,t.jsx)(o.DropdownMenu,{disallowEmptySelection:!0,className:"max-w-[300px]",selectionMode:"single",defaultSelectedKeys:[v],onSelectionChange:async e=>{if(e.currentKey){let t=parseInt(e.currentKey);b(t),await T(j.uuid,t)?l.toast.success("save familiarity successfully"):l.toast.error("save familiarity failed")}},children:(0,t.jsx)(d.DropdownSection,{items:r.FamiliarityList,children:r.FamiliarityList.map(e=>(0,t.jsx)(n.DropdownItem,{description:e.description,className:"".concat(w(e.value)),children:"".concat(e.value," - ").concat(e.label)},e.value))})})]})})}),y&&(0,t.jsxs)(f.Popover,{placement:"left",classNames:{content:"bg-slate-200"},children:[(0,t.jsx)(m.PopoverTrigger,{children:(0,t.jsx)(x.Link,{as:"button",isBlock:!0,className:"text-xl",children:"edit tag"})}),(0,t.jsx)(g.PopoverContent,{children:(0,t.jsx)(_,{user_id:s,card:j,tag_list:h})})]}),!y&&(0,t.jsxs)(f.Popover,{placement:"top-end",classNames:{content:"bg-slate-200"},children:[(0,t.jsx)(m.PopoverTrigger,{children:(0,t.jsx)(x.Link,{as:"button",isBlock:!0,className:"text-xl",children:"collect"})}),(0,t.jsx)(g.PopoverContent,{children:(0,t.jsx)(S,{user_id:s,card:j})})]})]})]})}function k(e){let{user_id:r,card_list:i}=e,[c,n]=(0,a.useState)([]);return(0,a.useEffect)(()=>{(async()=>{let e=await (0,s.getTagAll)(r);"success"===e.status?n(e.data):(console.log(e.error),l.toast.error("load data error"))})()},[r]),(0,t.jsx)("div",{className:"flex flex-col w-full gap-2",children:i.map(e=>(0,t.jsx)(L,{user_id:r,card:e,tag_list:c},e.uuid))})}},77573,e=>{"use strict";e.s(["default",()=>f]);var t=e.i(43476),a=e.i(71645),s=e.i(35889),l=e.i(5483),r=e.i(98245),i=e.i(56124),c=e.i(76220),n=e.i(1138),o=e.i(3099),d=e.i(61707),u=e.i(49649),x=e.i(70319);function f(e){let{user_id_my:f}=e,[g,m]=(0,a.useState)(!1),[p,j]=(0,a.useState)([]),[h,v]=(0,a.useState)(""),[b,y]=(0,a.useState)([]),[w,S]=(0,a.useState)(1),[C,N]=(0,a.useState)(0);return(0,a.useEffect)(()=>{let e=async()=>{m(!0);let e=await (0,o.getCardAll)(f,u.FilterType.Normal,h,"",w,20);"success"===e.status?(y(e.data),N(e.total_pages||0)):x.toast.error(e.error),m(!1)};(async()=>{m(!0);let e=await (0,d.getTagAll)(f);"success"===e.status?j(e.data):(console.log(e.error),x.toast.error("load data error")),m(!1)})(),e()},[f,h,w]),(0,t.jsxs)("div",{className:"flex flex-col w-full gap-2 py-2 px-2",children:[(0,t.jsx)(i.Select,{label:"Tag",labelPlacement:"outside-left",onChange:e=>v(e.target.value),endContent:g&&(0,t.jsx)(l.CircularProgress,{"aria-label":"Loading...",color:"default"}),children:p.map(e=>(0,t.jsx)(c.SelectItem,{textValue:e.tag,children:e.tag},e.uuid))}),(0,t.jsx)("div",{className:"flex flex-row items-center justify-center gap-4",children:(0,t.jsx)(s.Button,{variant:"solid",color:"primary",id:"button-toggel-recording",isDisabled:!h,children:"delete all cards under this tag"})}),!g&&C>1&&(0,t.jsxs)("div",{className:"flex flex-row items-center justify-center gap-4",children:[(0,t.jsx)("div",{children:"Page"}),(0,t.jsx)(r.Pagination,{showControls:!0,loop:!0,variant:"bordered",total:C,page:w,onChange:S})]}),g?(0,t.jsx)("div",{className:"flex flex-row w-full items-center justify-center gap-4",children:(0,t.jsx)(l.CircularProgress,{label:"Loading..."})}):(0,t.jsx)(n.default,{user_id:f,card_list:b}),!g&&C>1&&(0,t.jsxs)("div",{className:"flex flex-row items-center justify-center gap-4",children:[(0,t.jsx)("div",{children:"Page"}),(0,t.jsx)(r.Pagination,{showControls:!0,loop:!0,variant:"bordered",total:C,page:w,onChange:S})]})]})}},47515,e=>{"use strict";e.s(["default",()=>f]);var t=e.i(43476),a=e.i(71645),s=e.i(35889),l=e.i(5483),r=e.i(98245),i=e.i(56124),c=e.i(76220),n=e.i(1138),o=e.i(3099),d=e.i(61707),u=e.i(49649),x=e.i(70319);function f(e){let{user_id_my:f,user_id_another:g}=e,[m,p]=(0,a.useState)(!1),[j,h]=(0,a.useState)([]),[v,b]=(0,a.useState)(""),[y,w]=(0,a.useState)([]),[S,C]=(0,a.useState)(""),[N,_]=(0,a.useState)([]),[P,T]=(0,a.useState)(1),[L,k]=(0,a.useState)(0);return(0,a.useEffect)(()=>{let e=async()=>{p(!0);let e=await (0,d.getTagAll)(g);"success"===e.status?h(e.data):(console.log(e.error),x.toast.error("load data error")),p(!1)},t=async()=>{p(!0);let e=await (0,o.getCardAll)(g,u.FilterType.Normal,v,"",P,20);"success"===e.status?(_(e.data),k(e.total_pages||0)):x.toast.error(e.error),p(!1)};(async()=>{p(!0);let e=await (0,d.getTagAll)(f);"success"===e.status?w(e.data):(console.log(e.error),x.toast.error("load data error")),p(!1)})(),e(),t()},[f,g,v,P]),(0,t.jsxs)("div",{className:"flex flex-col w-full gap-2 py-2 px-2",children:[(0,t.jsx)(i.Select,{label:"Tag",labelPlacement:"outside-left",onChange:e=>b(e.target.value),endContent:m&&(0,t.jsx)(l.CircularProgress,{"aria-label":"Loading...",color:"default"}),children:j.map(e=>(0,t.jsx)(c.SelectItem,{textValue:e.tag,children:e.tag},e.uuid))}),(0,t.jsxs)("div",{className:"flex flex-col items-start justify-center gap-4 bg-sand-300 rounded-lg p-2",children:[(0,t.jsx)("div",{children:"copy to my cards"}),(0,t.jsxs)("div",{className:"flex flex-col lg:flex-row items-center justify-center w-full gap-4",children:[(0,t.jsx)(i.Select,{label:"Copy to",labelPlacement:"outside-left",onChange:e=>C(e.target.value),endContent:m&&(0,t.jsx)(l.CircularProgress,{"aria-label":"Loading...",color:"default"}),children:y.map(e=>(0,t.jsx)(c.SelectItem,{textValue:e.tag,children:e.tag},e.uuid))}),(0,t.jsx)(s.Button,{variant:"solid",color:"primary",id:"button-toggel-recording",isDisabled:!S||!v,children:"Collect"})]})]}),!m&&L>1&&(0,t.jsxs)("div",{className:"flex flex-row items-center justify-center gap-4",children:[(0,t.jsx)("div",{children:"Page"}),(0,t.jsx)(r.Pagination,{showControls:!0,loop:!0,variant:"bordered",total:L,page:P,onChange:T})]}),m?(0,t.jsx)("div",{className:"flex flex-row w-full items-center justify-center gap-4",children:(0,t.jsx)(l.CircularProgress,{label:"Loading..."})}):(0,t.jsx)(n.default,{user_id:f,card_list:N}),!m&&L>1&&(0,t.jsxs)("div",{className:"flex flex-row items-center justify-center gap-4",children:[(0,t.jsx)("div",{children:"Page"}),(0,t.jsx)(r.Pagination,{showControls:!0,loop:!0,variant:"bordered",total:L,page:P,onChange:T})]})]})}}]);