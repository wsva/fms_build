(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,77148,e=>{"use strict";e.s(["Textarea",()=>z],77148);var t=e.i(34738),i=e.i(75540),a=e.i(73830),r=e.i(71645);function n(){return(n=Object.assign.bind()).apply(null,arguments)}var s=r.useLayoutEffect,l=function(e){var t=r.default.useRef(e);return s(function(){t.current=e}),t},o=function(e,t){if("function"==typeof e)return void e(t);e.current=t},u=function(e,t){var i=r.default.useRef();return r.default.useCallback(function(a){e.current=a,i.current&&o(i.current,null),i.current=t,t&&o(t,a)},[t])},d={"min-height":"0","max-height":"none",height:"0",visibility:"hidden",overflow:"hidden",position:"absolute","z-index":"-1000",top:"0",right:"0",display:"block"},c=function(e){Object.keys(d).forEach(function(t){e.style.setProperty(t,d[t],"important")})},f=null,m=function(e,t){var i=e.scrollHeight;return"border-box"===t.sizingStyle.boxSizing?i+t.borderSize:i-t.paddingSize},g=function(){},x=["borderBottomWidth","borderLeftWidth","borderRightWidth","borderTopWidth","boxSizing","fontFamily","fontSize","fontStyle","fontWeight","letterSpacing","lineHeight","paddingBottom","paddingLeft","paddingRight","paddingTop","tabSize","textIndent","textRendering","textTransform","width","wordBreak","wordSpacing","scrollbarGutter"],h=!!document.documentElement.currentStyle,v=function(e){var t=window.getComputedStyle(e);if(null===t)return null;var i=x.reduce(function(e,i){return e[i]=t[i],e},{}),a=i.boxSizing;if(""===a)return null;h&&"border-box"===a&&(i.width=parseFloat(i.width)+parseFloat(i.borderRightWidth)+parseFloat(i.borderLeftWidth)+parseFloat(i.paddingRight)+parseFloat(i.paddingLeft)+"px");var r=parseFloat(i.paddingBottom)+parseFloat(i.paddingTop),n=parseFloat(i.borderBottomWidth)+parseFloat(i.borderTopWidth);return{sizingStyle:i,paddingSize:r,borderSize:n}};function p(e,t,i){var a=l(i);r.useLayoutEffect(function(){var i=function(e){return a.current(e)};if(e)return e.addEventListener(t,i),function(){return e.removeEventListener(t,i)}},[])}var y=function(e,t){p(document.body,"reset",function(i){e.current.form===i.target&&t(i)})},b=function(e){p(window,"resize",e)},w=function(e){p(document.fonts,"loadingdone",e)},j=["cacheMeasurements","maxRows","minRows","onChange","onHeightChange"],S=r.forwardRef(function(e,t){var i=e.cacheMeasurements,a=e.maxRows,s=e.minRows,l=e.onChange,o=void 0===l?g:l,d=e.onHeightChange,x=void 0===d?g:d,h=function(e,t){if(null==e)return{};var i={};for(var a in e)if(({}).hasOwnProperty.call(e,a)){if(-1!==t.indexOf(a))continue;i[a]=e[a]}return i}(e,j),p=void 0!==h.value,S=r.useRef(null),_=u(S,t),R=r.useRef(0),C=r.useRef(),z=function(){var e=S.current,t=i&&C.current?C.current:v(e);if(t){C.current=t;var r,n,l,o,u,d,g,h,p,y,b,w=(r=e.value||e.placeholder||"x",void 0===(n=s)&&(n=1),void 0===(l=a)&&(l=1/0),f||((f=document.createElement("textarea")).setAttribute("tabindex","-1"),f.setAttribute("aria-hidden","true"),c(f)),null===f.parentNode&&document.body.appendChild(f),o=t.paddingSize,u=t.borderSize,g=(d=t.sizingStyle).boxSizing,Object.keys(d).forEach(function(e){f.style[e]=d[e]}),c(f),f.value=r,h=m(f,t),f.value=r,h=m(f,t),f.value="x",y=(p=f.scrollHeight-o)*n,"border-box"===g&&(y=y+o+u),h=Math.max(y,h),b=p*l,"border-box"===g&&(b=b+o+u),[h=Math.min(b,h),p]),j=w[0],_=w[1];R.current!==j&&(R.current=j,e.style.setProperty("height",j+"px","important"),x(j,{rowHeight:_}))}};return r.useLayoutEffect(z),y(S,function(){if(!p){var e=S.current.value;requestAnimationFrame(function(){var t=S.current;t&&e!==t.value&&z()})}}),b(z),w(z),r.createElement("textarea",n({},h,{onChange:function(e){p||z(),o(e)},ref:_}))}),_=e.i(19110),R=e.i(43476),C=(0,a.forwardRef)((e,a)=>{let{style:n,minRows:s=3,maxRows:l=8,cacheMeasurements:o=!1,disableAutosize:u=!1,onHeightChange:d,...c}=e,{Component:f,label:m,description:g,startContent:x,endContent:h,hasHelper:v,shouldLabelBeOutside:p,shouldLabelBeInside:y,isInvalid:b,errorMessage:w,getBaseProps:j,getLabelProps:C,getInputProps:z,getInnerWrapperProps:T,getInputWrapperProps:L,getHelperWrapperProps:N,getDescriptionProps:F,getErrorMessageProps:k,isClearable:B,getClearButtonProps:E}=(0,t.useInput)({...c,ref:a,isMultiline:!0}),[M,P]=(0,r.useState)(s>1),[D,I]=(0,r.useState)(!1),H=m?(0,R.jsx)("label",{...C(),children:m}):null,A=z(),O=u?(0,R.jsx)("textarea",{...A,style:(0,i.mergeProps)(A.style,null!=n?n:{})}):(0,R.jsx)(S,{...A,cacheMeasurements:o,"data-hide-scroll":(0,i.dataAttr)(!D),maxRows:l,minRows:s,style:(0,i.mergeProps)(A.style,null!=n?n:{}),onHeightChange:(e,t)=>{1===s&&P(e>=2*t.rowHeight),l>s&&I(e>=l*t.rowHeight),null==d||d(e,t)}}),q=(0,r.useMemo)(()=>B?(0,R.jsx)("button",{...E(),children:(0,R.jsx)(_.CloseFilledIcon,{})}):null,[B,E]),W=(0,r.useMemo)(()=>x||h?(0,R.jsxs)("div",{...T(),children:[x,O,h]}):(0,R.jsx)("div",{...T(),children:O}),[x,A,h,T]),U=b&&w,V=U||g;return(0,R.jsxs)(f,{...j(),children:[p?H:null,(0,R.jsxs)("div",{...L(),"data-has-multiple-rows":(0,i.dataAttr)(M),children:[y?H:null,W,q]}),v&&V?(0,R.jsx)("div",{...N(),children:U?(0,R.jsx)("div",{...k(),children:w}):(0,R.jsx)("div",{...F(),children:g})}):null]})});C.displayName="HeroUI.Textarea";var z=C},83208,e=>{"use strict";e.s(["getCardTag",()=>i]);var t=e.i(95187),i=(0,t.createServerReference)("600a01824a728f8ad4612519932942e824b6f2f0e2",t.callServer,void 0,t.findSourceMapURL,"getCardTag")},27115,e=>{"use strict";e.s(["SelectSection",()=>t],27115);var t=e.i(99817).BaseSection},76732,e=>{"use strict";e.s(["default",()=>_],76732);var t=e.i(43476),i=e.i(75157),a=e.i(35889),r=e.i(86914),n=e.i(84735),s=e.i(52315),l=e.i(14060),o=e.i(24597),u=e.i(56124),d=e.i(76220),c=e.i(27115),f=e.i(77148),m=e.i(71645),g=e.i(18566),x=e.i(53145),h=e.i(70319),v=e.i(83208),p=e.i(50609),y=e.i(95187),b=(0,y.createServerReference)("4024cfaddc46aeff5fc62a7c4ca54449e2795d5c5b",y.callServer,void 0,y.findSourceMapURL,"removeCard"),w=e.i(71706),j=e.i(40268),S=e.i(49649);function _(e){let{card_ext:y,email:_,edit_view:R,simple:C,create_new:z}=e,T=(0,g.useSearchParams)(),[L,N]=(0,m.useState)(R),[F,k]=(0,m.useState)(),[B,E]=(0,m.useState)([]),[M,P]=(0,m.useState)([]),[D,I]=(0,m.useState)([]),{register:H,handleSubmit:A,formState:O,watch:q}=(0,x.useForm)({}),W=(0,m.useRef)(null),{ref:U,...V}=H("answer"),K=(0,m.useRef)(null);(0,m.useEffect)(()=>{(async()=>{let e=await (0,p.getTagAll)(_);if("success"!==e.status)return;E(e.data);let t=y.uuid&&y.user_id===_?y.uuid:(0,i.getUUID)();k({uuid:t,user_id:_,question:y.question||"",suggestion:y.suggestion||"",answer:y.answer||"",familiarity:y.familiarity&&y.user_id===_?y.familiarity:0,note:y.note||"",created_at:y.created_at||new Date,updated_at:y.updated_at||new Date});let a=await (0,v.getCardTag)(_,t);"success"===a.status&&a.data.tag_list_added&&(P(a.data.tag_list_added),I((y.tag_list_suggestion?Array.from(new Set([...a.data.tag_list_added,...y.tag_list_suggestion])):a.data.tag_list_added).filter(t=>e.data.map(e=>e.uuid).includes(t))))})();let e=e=>{let t=navigator.userAgent.includes("Mac");if(t&&e.metaKey&&"s"===e.key||!t&&e.ctrlKey&&"s"===e.key){var i;e.preventDefault(),null==(i=W.current)||i.requestSubmit()}};return window.addEventListener("keydown",e),()=>{window.removeEventListener("keydown",e)}},[]);let G=e=>{if(y){let t=(0,i.getProperty)(y,e);if(t)return t}let t=T.get(e);if(t)return decodeURIComponent(t)},J=e=>S.FamiliarityList.map(e=>e.color)[e],Q=async(e,t)=>{if(!K.current)return;let i=K.current,a=i.selectionStart,r=i.selectionEnd,n=i.value,s=n.slice(0,a)+e+n.slice(a,r)+t+n.slice(r);i.value=s,K.current.value=s,setTimeout(()=>{i.focus();let n=e.length+t.length;a<r?i.setSelectionRange(a,r+n):i.setSelectionRange(a+n,r+n)},0)},X=async e=>F?(e.familiarity||(e.familiarity=0),"string"==typeof e.familiarity&&(e.familiarity=parseInt(e.familiarity||"0",10)),"success"!==(await (0,w.saveCard)({...F,...e,created_at:(null==F?void 0:F.created_at)?F.created_at:new Date,updated_at:new Date})).status)?void h.toast.error("save card failed"):(h.toast.success("save card success"),"success"!==(await (0,j.saveCardTag)({uuid:F.uuid,tag_list_new:D.filter(e=>!M.includes(e)),tag_list_remove:M.filter(e=>!D.includes(e))})).status)?void h.toast.error("save tag failed"):(h.toast.success("save tag successfully"),P(D),void(z&&setTimeout(()=>{window.location.reload()},1e3))):void h.toast.error("loading");return(0,t.jsx)("form",{ref:W,onSubmit:A(X),children:(0,t.jsxs)("div",{className:"w-full space-y-4 mb-10 px-2",children:[F&&F.user_id!==_&&(0,t.jsx)("div",{className:"flex flex-row my-1 items-start justify-start gap-4",children:(0,t.jsx)(o.Link,{className:"text-blue-500 underline",target:"_blank",href:"/card/others?user_id=".concat(F.user_id),children:F.user_id})}),(0,t.jsxs)("div",{className:"flex flex-row my-1 items-end justify-end gap-4",children:[(0,t.jsx)(a.Button,{color:"primary",variant:"solid",size:"sm",onPress:()=>N(!L),children:L?"View":"Edit"}),(0,t.jsx)(a.Button,{color:"primary",type:"submit",variant:"solid",size:"sm",isLoading:O.isSubmitting,children:"Save"}),(0,t.jsx)(a.Button,{color:"danger",variant:"solid",size:"sm",onPress:async()=>{(null==F?void 0:F.uuid)&&("success"==(await b(F.uuid)).status?h.toast.error("remove card successfully"):h.toast.error("remove card failed"))},children:"Remove"})]}),L?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(f.Textarea,{label:"question",classNames:{input:"text-xl leading-tight font-roboto"},defaultValue:G("question")||"",...H("question")}),!C&&(0,t.jsx)(u.Select,{"aria-label":"select familiarity",selectionMode:"single",defaultSelectedKeys:["".concat(q("familiarity",G("familiarity")||0))],...H("familiarity"),children:(0,t.jsx)(c.SelectSection,{items:S.FamiliarityList,children:S.FamiliarityList.map(e=>(0,t.jsx)(d.SelectItem,{className:"".concat(J(e.value)),children:"".concat(e.value," - ").concat(e.label)},e.value))})}),(0,t.jsx)(s.CheckboxGroup,{color:"success",value:D,onValueChange:I,orientation:"horizontal",children:B.map(e=>(0,t.jsx)(n.Checkbox,{value:e.uuid,children:e.tag},e.uuid))}),!C&&(0,t.jsx)(f.Textarea,{label:"suggestion",classNames:{input:"text-xl leading-tight font-roboto"},minRows:1,maxRows:3,defaultValue:G("suggestion")||"",...H("suggestion")}),(0,t.jsxs)("div",{className:"flex flex-col gap-1 px-3 py-0.5 bg-default-100 hover:bg-default-200 rounded-medium",children:[(0,t.jsx)("label",{className:"text-foreground-500 text-small pb-0.5 pe-2 max-w-full text-ellipsis overflow-hidden",children:"answer"}),(0,t.jsxs)(r.ButtonGroup,{size:"sm",radius:"none",className:"flex flex-row items-center justify-start gap-1",children:[["#","â¬Œ","â– ","=","â‰ˆ","âž¤","ðŸ¡†"].map((e,i)=>(0,t.jsx)(a.Button,{isIconOnly:!0,className:"text-xl",onPress:()=>Q(e,""),children:e},"char1-".concat(i))),["Ã¤","Ã„","Ã¶","Ã–","Ã¼","Ãœ","ÃŸ","Ã©","â‚¬"].map((e,i)=>(0,t.jsx)(a.Button,{isIconOnly:!0,className:"text-xl",onPress:()=>Q(e,""),children:e},"char2-".concat(i))),[["B","**","**"],["â€žâ€œ","â€ž","â€œ"],["â€šâ€˜","â€š","â€˜"],["C","`````\n","\n`````"]].map((e,i)=>(0,t.jsx)(a.Button,{isIconOnly:!0,className:"text-xl",onPress:()=>Q(e[1],e[2]),children:e[0]},"char3-".concat(i)))]}),(0,t.jsx)("textarea",{className:"w-full text-xl leading-tight font-roboto px-1.5 outline-none bg-transparent resize-none",defaultValue:G("answer")||"",rows:10,autoComplete:"off",autoCorrect:"off",spellCheck:"false",...V,ref:e=>{U(e),K.current=e}})]}),(0,t.jsx)(f.Textarea,{label:"note",classNames:{input:"text-xl leading-tight font-roboto"},defaultValue:G("note")||"",...H("note")})]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("pre",{className:"text-3xl leading-tight font-roboto font-bold text-wrap",children:q("question",G("question")||"")}),(0,t.jsx)(l.Divider,{}),(0,t.jsx)(u.Select,{"aria-label":"select familiarity",selectionMode:"single",isDisabled:!0,defaultSelectedKeys:["".concat(q("familiarity",G("familiarity")||0))],...H("familiarity"),children:(0,t.jsx)(c.SelectSection,{items:S.FamiliarityList,children:S.FamiliarityList.map(e=>(0,t.jsx)(d.SelectItem,{className:"".concat(J(e.value)),children:"".concat(e.value," - ").concat(e.label)},e.value))})}),(0,t.jsx)(s.CheckboxGroup,{color:"success",value:D,onValueChange:I,orientation:"horizontal",isDisabled:!0,children:B.filter(e=>D.includes(e.uuid)).map(e=>(0,t.jsx)(n.Checkbox,{value:e.uuid,children:e.tag},e.uuid))}),(0,t.jsx)(l.Divider,{}),(0,t.jsx)("div",{className:"text-md font-roboto mx-8",children:q("suggestion",G("suggestion")||"")}),(0,t.jsx)(l.Divider,{}),(0,t.jsx)("div",{className:"MD my-1 text-xl leading-tight font-roboto indent-0 whitespace-pre-wrap break-words hyphens-auto",dangerouslySetInnerHTML:{__html:(0,i.getHTML)(q("answer",G("answer"))||"")}}),(0,t.jsx)(l.Divider,{}),(0,t.jsx)("pre",{className:"text-md font-roboto mx-8",children:q("note",G("note")||"")})]})]})})}}]);