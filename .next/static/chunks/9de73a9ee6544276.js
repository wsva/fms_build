(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,99749,e=>{"use strict";function a(e,a,t){return a in e?Object.defineProperty(e,a,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[a]=t,e}e.s(["_",()=>a])},93665,e=>{"use strict";e.s(["getCardTag",()=>t]);var a=e.i(95187),t=(0,a.createServerReference)("600acc3b7ccbe62e1d2a931afbbce62a9354c9d837",a.callServer,void 0,a.findSourceMapURL,"getCardTag")},25497,e=>{"use strict";e.s(["getCardAll",()=>t]);var a=e.i(95187),t=(0,a.createServerReference)("7e82e87da519196c223f96a69910e5354aeeba4919",a.callServer,void 0,a.findSourceMapURL,"getCardAll")},1138,e=>{"use strict";e.s(["default",()=>k],1138);var a=e.i(43476),t=e.i(71645),s=e.i(70307),r=e.i(70319),l=e.i(49649),i=e.i(86914),c=e.i(33716),o=e.i(8870),n=e.i(76331),d=e.i(32049),u=e.i(72853),f=e.i(24597),x=e.i(42976),g=e.i(35577),m=e.i(46399),p=e.i(64925),j=e.i(79406),h=e.i(40041),v=e.i(75157),y=e.i(84735),b=e.i(52315),S=e.i(53145);function w(e){let{user_id:l,card:i}=e,[c,o]=(0,t.useState)([]),[n,d]=(0,t.useState)([]),{handleSubmit:u}=(0,S.useForm)();(0,t.useEffect)(()=>{(async()=>{let e=await (0,s.getTagAll)(l);"success"===e.status&&o(e.data)})()},[l]);let x=async()=>{let e={...i,uuid:(0,v.getUUID)(),user_id:l,familiarity:0,note:(i.note?i.note+"\n":"")+'{"collect_from":'.concat(JSON.stringify(i.user_id),', "source_uuid":').concat(JSON.stringify(i.uuid),"}"),updated_at:new Date};if("success"!==(await (0,j.saveCard)(e)).status)return void r.toast.error("save card failed");r.toast.success("save card successfully"),"success"===(await (0,h.saveCardTag)({uuid:i.uuid,tag_list_new:n})).status?r.toast.success("save tag successfully"):r.toast.error("save tag failed")};return(0,a.jsx)("form",{onSubmit:u(x),children:(0,a.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,a.jsx)("div",{className:"flex flex-row items-center justify-start gap-1",children:c.length>0?(0,a.jsx)(b.CheckboxGroup,{color:"success",value:n,onValueChange:d,children:c.map(e=>(0,a.jsx)(y.Checkbox,{value:e.uuid,children:e.tag},e.uuid))}):(0,a.jsx)("div",{className:"px-1 pt-1",children:"not tag found"})}),(0,a.jsx)("div",{className:"flex flex-row items-center justify-end gap-1",children:(0,a.jsx)(f.Link,{as:"button",type:"submit",className:"bg-blue-500 rounded-md text-slate-50 px-2",children:"save"})})]})})}var C=e.i(93665),N=e.i(5483);function _(e){let{user_id:s,card:l,tag_list:i}=e,[c,o]=(0,t.useState)(!1),[n,d]=(0,t.useState)([]),[u,x]=(0,t.useState)([]),{handleSubmit:g}=(0,S.useForm)();(0,t.useEffect)(()=>{(async()=>{o(!0);let e=await (0,C.getCardTag)(s,l.uuid);"success"===e.status&&e.data.tag_list_added&&(d(e.data.tag_list_added.sort()),x(e.data.tag_list_added.filter(e=>i.map(e=>e.uuid).includes(e)).sort())),o(!1)})()},[s,l,i]);let m=async()=>{let e={uuid:l.uuid,tag_list_new:u.filter(e=>!n.includes(e)),tag_list_remove:n.filter(e=>!u.includes(e))};"success"===(await (0,h.saveCardTag)(e)).status?r.toast.success("save tag successfully"):r.toast.error("save tag failed")};return(0,a.jsx)("form",{onSubmit:g(m),children:(0,a.jsxs)("div",{className:"flex flex-col gap-4",children:[c?(0,a.jsx)(N.CircularProgress,{}):(0,a.jsx)(b.CheckboxGroup,{color:"success",value:u,onValueChange:e=>x(e.sort()),orientation:"vertical",children:i.map(e=>(0,a.jsx)(y.Checkbox,{value:e.uuid,children:e.tag},e.uuid))}),(0,a.jsx)("div",{className:"flex flex-row items-center justify-end gap-1",children:(0,a.jsx)(f.Link,{as:"button",type:"submit",className:"bg-blue-500 rounded-md text-slate-50 px-2",isDisabled:((e,a)=>{if(e.length!==a.length)return!1;let t=[...e].sort(),s=[...a].sort();return t.every((e,a)=>e===s[a])})(n,u),children:"save"})})]})})}var P=e.i(95187),L=(0,P.createServerReference)("600aeb535da8e349604b18451aef76601010af57fa",P.callServer,void 0,P.findSourceMapURL,"setCardFamiliarity");function T(e){let{user_id:s,card:j,tag_list:h}=e,[v,y]=(0,t.useState)(j.familiarity),b=j.user_id===s,S=e=>b?l.FamiliarityList.map(e=>e.color)[e]:l.FamiliarityList.map(e=>e.color)[0];return(0,a.jsxs)("div",{className:"flex flex-col w-full items-start rounded-md p-1 ".concat(S(v)),children:[(0,a.jsx)("div",{className:"flex flex-row w-full items-center justify-start gap-2",children:(0,a.jsx)(f.Link,{target:"_blank",className:"text-2xl text-blue-600 hover:underline",href:"/card/".concat(j.uuid),children:(0,a.jsx)("pre",{className:"font-roboto leading-none text-wrap",children:j.question})})}),!b&&(0,a.jsx)(f.Link,{target:"_blank",className:"text-sm text-gray-500 hover:underline",href:"/card/market?user_id=".concat(j.user_id),children:"by ".concat(j.user_id)}),(0,a.jsxs)("div",{className:"flex flex-row w-full items-end justify-end gap-4",children:[b&&(0,a.jsx)(p.Tooltip,{content:"current: ".concat(v,"\n").concat(l.FamiliarityList.map(e=>e.description)[v]),children:(0,a.jsx)(i.ButtonGroup,{variant:"solid",color:"primary",children:(0,a.jsxs)(c.Dropdown,{placement:"bottom-end",children:[(0,a.jsx)(u.DropdownTrigger,{children:(0,a.jsx)(f.Link,{as:"button",isBlock:!0,className:"text-xl",children:"set familiarity"})}),(0,a.jsx)(n.DropdownMenu,{disallowEmptySelection:!0,className:"max-w-[300px]",selectionMode:"single",defaultSelectedKeys:[v],onSelectionChange:async e=>{if(e.currentKey){let a=parseInt(e.currentKey);y(a),await L(j.uuid,a)?r.toast.success("save familiarity successfully"):r.toast.error("save familiarity failed")}},children:(0,a.jsx)(d.DropdownSection,{items:l.FamiliarityList,children:l.FamiliarityList.map(e=>(0,a.jsx)(o.DropdownItem,{description:e.description,className:"".concat(S(e.value)),children:"".concat(e.value," - ").concat(e.label)},e.value))})})]})})}),b&&(0,a.jsxs)(x.Popover,{placement:"left",classNames:{content:"bg-slate-200"},children:[(0,a.jsx)(m.PopoverTrigger,{children:(0,a.jsx)(f.Link,{as:"button",isBlock:!0,className:"text-xl",children:"edit tag"})}),(0,a.jsx)(g.PopoverContent,{children:(0,a.jsx)(_,{user_id:s,card:j,tag_list:h})})]}),!b&&(0,a.jsxs)(x.Popover,{placement:"top-end",classNames:{content:"bg-slate-200"},children:[(0,a.jsx)(m.PopoverTrigger,{children:(0,a.jsx)(f.Link,{as:"button",isBlock:!0,className:"text-xl",children:"collect"})}),(0,a.jsx)(g.PopoverContent,{children:(0,a.jsx)(w,{user_id:s,card:j})})]})]})]})}function k(e){let{user_id:l,card_list:i}=e,[c,o]=(0,t.useState)([]);return(0,t.useEffect)(()=>{(async()=>{let e=await (0,s.getTagAll)(l);"success"===e.status?o(e.data):(console.log(e.error),r.toast.error("load data error"))})()},[l]),(0,a.jsx)("div",{className:"flex flex-col w-full gap-2",children:i.map(e=>(0,a.jsx)(T,{user_id:l,card:e,tag_list:c},e.uuid))})}},50200,e=>{"use strict";e.s(["default",()=>d],50200);var a=e.i(43476),t=e.i(71645),s=e.i(5483),r=e.i(56124),l=e.i(76220),i=e.i(70319),c=e.i(95187),o=(0,c.createServerReference)("0015d2478315bfaad8b28b600c7fd11f69a15e2725",c.callServer,void 0,c.findSourceMapURL,"getUserIDAll"),n=e.i(18566);function d(e){let{user_id_my:c}=e,[d,u]=(0,t.useState)(!1),[f,x]=(0,t.useState)([]),g=(0,n.useRouter)();return(0,t.useEffect)(()=>{(async()=>{u(!0);let e=await o();"success"===e.status?x(e.data):(console.log(e.error),i.toast.error("load data error")),u(!1)})()},[]),(0,a.jsx)("div",{className:"flex flex-col w-full gap-2 py-2 px-2",children:d?(0,a.jsx)("div",{className:"flex flex-row w-full items-center justify-center gap-4",children:(0,a.jsx)(s.CircularProgress,{label:"Loading..."})}):(0,a.jsx)(r.Select,{label:"Select User ID",labelPlacement:"outside-left",onChange:e=>g.push("/card/manage?user_id=".concat(encodeURIComponent(e.target.value))),endContent:d&&(0,a.jsx)(s.CircularProgress,{"aria-label":"Loading...",color:"default"}),children:[(0,a.jsxs)(l.SelectItem,{textValue:c,children:["My Own ID: ",c]},c),...f.filter(e=>e!==c).map(e=>(0,a.jsx)(l.SelectItem,{textValue:e,children:e},e))]})})}},77573,e=>{"use strict";e.s(["default",()=>m],77573);var a=e.i(43476),t=e.i(71645),s=e.i(35889),r=e.i(5483),l=e.i(98245),i=e.i(56124),c=e.i(76220),o=e.i(1138),n=e.i(25497),d=e.i(70307),u=e.i(49649),f=e.i(70319),x=e.i(95187),g=(0,x.createServerReference)("7f9a35e0facff4aca4460f241abc67eb1e2cb2988c",x.callServer,void 0,x.findSourceMapURL,"removeCardsByTag");function m(e){let{user_id_my:x}=e,[m,p]=(0,t.useState)(!1),[j,h]=(0,t.useState)([]),[v,y]=(0,t.useState)(""),[b,S]=(0,t.useState)([]),[w,C]=(0,t.useState)(1),[N,_]=(0,t.useState)(1),[P,L]=(0,t.useState)(0),[T,k]=(0,t.useState)(!1);return(0,t.useEffect)(()=>{let e=async()=>{p(!0);let e=await (0,n.getCardAll)(x,u.FilterType.Normal,v,"",N,20);"success"===e.status?(S(e.data),L(e.total_pages||0)):f.toast.error(e.error),p(!1)};(async()=>{p(!0);let e=await (0,d.getTagAll)(x);"success"===e.status?h(e.data):(console.log(e.error),f.toast.error("load data error")),p(!1)})(),e()},[x,v,N,w]),(0,a.jsxs)("div",{className:"flex flex-col w-full gap-2 py-2 px-2",children:[(0,a.jsx)(i.Select,{label:"Tag",labelPlacement:"outside-left",onChange:e=>y(e.target.value),endContent:m&&(0,a.jsx)(r.CircularProgress,{"aria-label":"Loading...",color:"default"}),children:j.map(e=>(0,a.jsx)(c.SelectItem,{textValue:e.tag,children:e.tag},e.uuid))}),(0,a.jsx)("div",{className:"flex flex-row items-center justify-center gap-4",children:(0,a.jsx)(s.Button,{variant:"solid",color:"primary",id:"button-toggel-recording",isDisabled:!v||T,onPress:async()=>{if(window.confirm("Are you sure to delete all cards with this tag?")){k(!0);let e=await g(x,v);"success"===e.status?(f.toast.success("clear data success"),C(e=>e+1)):(console.log(e.error),f.toast.error("clear data failed")),k(!1)}},children:"delete all cards under this tag"})}),m?(0,a.jsx)("div",{className:"flex flex-row w-full items-center justify-center gap-4",children:(0,a.jsx)(r.CircularProgress,{label:"Loading..."})}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"flex flex-row items-center justify-center gap-4",children:[(0,a.jsx)("div",{children:"Page"}),(0,a.jsx)(l.Pagination,{showControls:!0,loop:!0,variant:"bordered",total:P,page:N,onChange:_})]}),(0,a.jsx)(o.default,{user_id:x,card_list:b}),(0,a.jsxs)("div",{className:"flex flex-row items-center justify-center gap-4",children:[(0,a.jsx)("div",{children:"Page"}),(0,a.jsx)(l.Pagination,{showControls:!0,loop:!0,variant:"bordered",total:P,page:N,onChange:_})]})]})]})}},47515,e=>{"use strict";e.s(["default",()=>m],47515);var a=e.i(43476),t=e.i(71645),s=e.i(35889),r=e.i(5483),l=e.i(98245),i=e.i(56124),c=e.i(76220),o=e.i(1138),n=e.i(25497),d=e.i(70307),u=e.i(49649),f=e.i(70319),x=e.i(95187),g=(0,x.createServerReference)("7f474419ab8ed645884cc6516388bff1af6889cecd",x.callServer,void 0,x.findSourceMapURL,"copyCardsByTag");function m(e){let{user_id_my:x,user_id_another:m}=e,[p,j]=(0,t.useState)(!1),[h,v]=(0,t.useState)([]),[y,b]=(0,t.useState)(""),[S,w]=(0,t.useState)([]),[C,N]=(0,t.useState)(""),[_,P]=(0,t.useState)([]),[L,T]=(0,t.useState)(1),[k,R]=(0,t.useState)(1),[A,D]=(0,t.useState)(0),[U,F]=(0,t.useState)(!1);return(0,t.useEffect)(()=>{let e=async()=>{j(!0);let e=await (0,d.getTagAll)(m);"success"===e.status?v(e.data):(console.log(e.error),f.toast.error("load data error")),j(!1)},a=async()=>{j(!0);let e=await (0,n.getCardAll)(m,u.FilterType.Normal,y,"",k,20);"success"===e.status?(P(e.data),D(e.total_pages||0)):f.toast.error(e.error),j(!1)};(async()=>{j(!0);let e=await (0,d.getTagAll)(x);"success"===e.status?w(e.data):(console.log(e.error),f.toast.error("load data error")),j(!1)})(),e(),a()},[x,m,y,k,L]),(0,a.jsxs)("div",{className:"flex flex-col w-full gap-2 py-2 px-2",children:[(0,a.jsx)(i.Select,{label:"Tag",labelPlacement:"outside-left",onChange:e=>b(e.target.value),endContent:p&&(0,a.jsx)(r.CircularProgress,{"aria-label":"Loading...",color:"default"}),children:h.map(e=>(0,a.jsx)(c.SelectItem,{textValue:e.tag,children:e.tag},e.uuid))}),(0,a.jsxs)("div",{className:"flex flex-col items-start justify-center gap-4 bg-sand-300 rounded-lg p-2",children:[(0,a.jsx)("div",{children:"copy to my cards"}),(0,a.jsxs)("div",{className:"flex flex-col lg:flex-row items-center justify-center w-full gap-4",children:[(0,a.jsx)(i.Select,{label:"Copy to",labelPlacement:"outside-left",onChange:e=>N(e.target.value),endContent:p&&(0,a.jsx)(r.CircularProgress,{"aria-label":"Loading...",color:"default"}),children:S.map(e=>(0,a.jsx)(c.SelectItem,{textValue:e.tag,children:e.tag},e.uuid))}),(0,a.jsx)(s.Button,{variant:"solid",color:"primary",id:"button-toggel-recording",isDisabled:!C||!y||U,onPress:async()=>{if(window.confirm("Are you sure to copy all cards to your account?")){F(!0);let e=await g(m,y,x,C);"success"===e.status?(f.toast.success("clear data success"),T(e=>e+1)):(console.log(e.error),f.toast.error("clear data failed")),F(!1)}},children:"Collect"})]})]}),p?(0,a.jsx)("div",{className:"flex flex-row w-full items-center justify-center gap-4",children:(0,a.jsx)(r.CircularProgress,{label:"Loading..."})}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"flex flex-row items-center justify-center gap-4",children:[(0,a.jsx)("div",{children:"Page"}),(0,a.jsx)(l.Pagination,{showControls:!0,loop:!0,variant:"bordered",total:A,page:k,onChange:R})]}),(0,a.jsx)(o.default,{user_id:x,card_list:_}),(0,a.jsxs)("div",{className:"flex flex-row items-center justify-center gap-4",children:[(0,a.jsx)("div",{children:"Page"}),(0,a.jsx)(l.Pagination,{showControls:!0,loop:!0,variant:"bordered",total:A,page:k,onChange:R})]})]})]})}}]);