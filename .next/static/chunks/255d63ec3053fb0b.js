(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,99749,e=>{"use strict";function t(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}e.s(["_",()=>t])},24597,e=>{"use strict";e.s(["Link",()=>x],24597);var t=e.i(84898),a=e.i(79754),r=(0,t.tv)({base:["relative inline-flex items-center outline-solid outline-transparent tap-highlight-transparent",...a.dataFocusVisibleClasses],variants:{size:{sm:"text-small",md:"text-medium",lg:"text-large"},color:{foreground:"text-foreground",primary:"text-primary",secondary:"text-secondary",success:"text-success",warning:"text-warning",danger:"text-danger"},underline:{none:"no-underline",hover:"hover:underline",always:"underline",active:"active:underline",focus:"focus:underline"},isBlock:{true:["px-2","py-1","hover:after:opacity-100","after:content-['']","after:inset-0","after:opacity-0","after:w-full","after:h-full","after:rounded-xl","after:transition-background","after:absolute"],false:"hover:opacity-hover active:opacity-disabled transition-opacity"},isDisabled:{true:"opacity-disabled cursor-default pointer-events-none"},disableAnimation:{true:"after:transition-none transition-none"}},compoundVariants:[{isBlock:!0,color:"foreground",class:"hover:after:bg-foreground/10"},{isBlock:!0,color:"primary",class:"hover:after:bg-primary/20"},{isBlock:!0,color:"secondary",class:"hover:after:bg-secondary/20"},{isBlock:!0,color:"success",class:"hover:after:bg-success/20"},{isBlock:!0,color:"warning",class:"hover:after:bg-warning/20"},{isBlock:!0,color:"danger",class:"hover:after:bg-danger/20"},{underline:["hover","always","active","focus"],class:"underline-offset-4"}],defaultVariants:{color:"primary",size:"md",isBlock:!1,underline:"none",isDisabled:!1}}),s=e.i(69080),i=e.i(50179),n=e.i(11458),o=e.i(49962),l=e.i(43027),d=e.i(73830),c=e.i(95494),u=e.i(20253),f=e.i(29427),v=e.i(75540),m=e.i(71645),h=e.i(43476),g=e=>(0,h.jsxs)("svg",{"aria-hidden":"true",fill:"none",focusable:"false",height:"1em",shapeRendering:"geometricPrecision",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",viewBox:"0 0 24 24",width:"1em",...e,children:[(0,h.jsx)("path",{d:"M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"}),(0,h.jsx)("path",{d:"M15 3h6v6"}),(0,h.jsx)("path",{d:"M10 14L21 3"})]}),p=(0,d.forwardRef)((e,t)=>{let{Component:a,children:p,showAnchorIcon:x,anchorIcon:b=(0,h.jsx)(g,{className:"flex mx-1 text-current self-center"}),getLinkProps:y}=function(e){var t,a,h,g;let p=(0,c.useProviderContext)(),[x,b]=(0,d.mapPropsVariants)(e,r.variantKeys),{ref:y,as:j,children:S,anchorIcon:w,isExternal:k=!1,showAnchorIcon:R=!1,autoFocus:B=!1,className:_,onPress:z,onPressStart:P,onPressEnd:L,onClick:M,...N}=x,C=(0,u.useDOMRef)(y),D=null!=(a=null!=(t=null==e?void 0:e.disableAnimation)?t:null==p?void 0:p.disableAnimation)&&a,{linkProps:U}=function(e,t){let{elementType:a="a",onPress:r,onPressStart:d,onPressEnd:c,onClick:u,isDisabled:f,...v}=e,m={};"a"!==a&&(m={role:"link",tabIndex:f?void 0:0});let{focusableProps:h}=(0,o.useFocusable)(e,t),{pressProps:g,isPressed:p}=(0,l.usePress)({onClick:u,onPress:r,onPressStart:d,onPressEnd:c,isDisabled:f,ref:t}),x=(0,s.filterDOMProps)(v,{labelable:!0,isLink:"a"===a}),b=(0,i.mergeProps)(h,g),y=(0,n.useRouter)(),j=(0,n.useLinkProps)(e);return{isPressed:p,linkProps:(0,i.mergeProps)(x,j,{...b,...m,"aria-disabled":f||void 0,"aria-current":e["aria-current"],onClick:t=>{var a;null==(a=g.onClick)||a.call(g,t),(0,n.handleLinkClick)(t,y,e.href,e.routerOptions)}})}}({...N,onPress:z,onPressStart:P,onPressEnd:L,onClick:M,isDisabled:e.isDisabled,elementType:"".concat(j)},C),{isFocused:I,isFocusVisible:O,focusProps:T}=(0,f.useFocusRing)({autoFocus:B});k&&(N.rel=null!=(h=N.rel)?h:"noopener noreferrer",N.target=null!=(g=N.target)?g:"_blank");let A=(0,m.useMemo)(()=>r({...b,disableAnimation:D,className:_}),[(0,v.objectToDeps)(b),D,_]);return{Component:j||"a",children:S,anchorIcon:w,showAnchorIcon:R,getLinkProps:(0,m.useCallback)(()=>({ref:C,className:A,"data-focus":(0,v.dataAttr)(I),"data-disabled":(0,v.dataAttr)(e.isDisabled),"data-focus-visible":(0,v.dataAttr)(O),...(0,v.mergeProps)(T,U,N)}),[A,I,O,T,U,N])}}({ref:t,...e});return(0,h.jsx)(a,{...y(),children:(0,h.jsxs)(h.Fragment,{children:[p,x&&b]})})});p.displayName="HeroUI.Link";var x=p},77148,e=>{"use strict";e.s(["Textarea",()=>_],77148);var t=e.i(34738),a=e.i(75540),r=e.i(73830),s=e.i(71645);function i(){return(i=Object.assign.bind()).apply(null,arguments)}var n=s.useLayoutEffect,o=function(e){var t=s.default.useRef(e);return n(function(){t.current=e}),t},l=function(e,t){if("function"==typeof e)return void e(t);e.current=t},d=function(e,t){var a=s.default.useRef();return s.default.useCallback(function(r){e.current=r,a.current&&l(a.current,null),a.current=t,t&&l(t,r)},[t])},c={"min-height":"0","max-height":"none",height:"0",visibility:"hidden",overflow:"hidden",position:"absolute","z-index":"-1000",top:"0",right:"0",display:"block"},u=function(e){Object.keys(c).forEach(function(t){e.style.setProperty(t,c[t],"important")})},f=null,v=function(e,t){var a=e.scrollHeight;return"border-box"===t.sizingStyle.boxSizing?a+t.borderSize:a-t.paddingSize},m=function(){},h=["borderBottomWidth","borderLeftWidth","borderRightWidth","borderTopWidth","boxSizing","fontFamily","fontSize","fontStyle","fontWeight","letterSpacing","lineHeight","paddingBottom","paddingLeft","paddingRight","paddingTop","tabSize","textIndent","textRendering","textTransform","width","wordBreak","wordSpacing","scrollbarGutter"],g=!!document.documentElement.currentStyle,p=function(e){var t=window.getComputedStyle(e);if(null===t)return null;var a=h.reduce(function(e,a){return e[a]=t[a],e},{}),r=a.boxSizing;if(""===r)return null;g&&"border-box"===r&&(a.width=parseFloat(a.width)+parseFloat(a.borderRightWidth)+parseFloat(a.borderLeftWidth)+parseFloat(a.paddingRight)+parseFloat(a.paddingLeft)+"px");var s=parseFloat(a.paddingBottom)+parseFloat(a.paddingTop),i=parseFloat(a.borderBottomWidth)+parseFloat(a.borderTopWidth);return{sizingStyle:a,paddingSize:s,borderSize:i}};function x(e,t,a){var r=o(a);s.useLayoutEffect(function(){var a=function(e){return r.current(e)};if(e)return e.addEventListener(t,a),function(){return e.removeEventListener(t,a)}},[])}var b=function(e,t){x(document.body,"reset",function(a){e.current.form===a.target&&t(a)})},y=function(e){x(window,"resize",e)},j=function(e){x(document.fonts,"loadingdone",e)},S=["cacheMeasurements","maxRows","minRows","onChange","onHeightChange"],w=s.forwardRef(function(e,t){var a=e.cacheMeasurements,r=e.maxRows,n=e.minRows,o=e.onChange,l=void 0===o?m:o,c=e.onHeightChange,h=void 0===c?m:c,g=function(e,t){if(null==e)return{};var a={};for(var r in e)if(({}).hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;a[r]=e[r]}return a}(e,S),x=void 0!==g.value,w=s.useRef(null),k=d(w,t),R=s.useRef(0),B=s.useRef(),_=function(){var e=w.current,t=a&&B.current?B.current:p(e);if(t){B.current=t;var s,i,o,l,d,c,m,g,x,b,y,j=(s=e.value||e.placeholder||"x",void 0===(i=n)&&(i=1),void 0===(o=r)&&(o=1/0),f||((f=document.createElement("textarea")).setAttribute("tabindex","-1"),f.setAttribute("aria-hidden","true"),u(f)),null===f.parentNode&&document.body.appendChild(f),l=t.paddingSize,d=t.borderSize,m=(c=t.sizingStyle).boxSizing,Object.keys(c).forEach(function(e){f.style[e]=c[e]}),u(f),f.value=s,g=v(f,t),f.value=s,g=v(f,t),f.value="x",b=(x=f.scrollHeight-l)*i,"border-box"===m&&(b=b+l+d),g=Math.max(b,g),y=x*o,"border-box"===m&&(y=y+l+d),[g=Math.min(y,g),x]),S=j[0],k=j[1];R.current!==S&&(R.current=S,e.style.setProperty("height",S+"px","important"),h(S,{rowHeight:k}))}};return s.useLayoutEffect(_),b(w,function(){if(!x){var e=w.current.value;requestAnimationFrame(function(){var t=w.current;t&&e!==t.value&&_()})}}),y(_),j(_),s.createElement("textarea",i({},g,{onChange:function(e){x||_(),l(e)},ref:k}))}),k=e.i(19110),R=e.i(43476),B=(0,r.forwardRef)((e,r)=>{let{style:i,minRows:n=3,maxRows:o=8,cacheMeasurements:l=!1,disableAutosize:d=!1,onHeightChange:c,...u}=e,{Component:f,label:v,description:m,startContent:h,endContent:g,hasHelper:p,shouldLabelBeOutside:x,shouldLabelBeInside:b,isInvalid:y,errorMessage:j,getBaseProps:S,getLabelProps:B,getInputProps:_,getInnerWrapperProps:z,getInputWrapperProps:P,getHelperWrapperProps:L,getDescriptionProps:M,getErrorMessageProps:N,isClearable:C,getClearButtonProps:D}=(0,t.useInput)({...u,ref:r,isMultiline:!0}),[U,I]=(0,s.useState)(n>1),[O,T]=(0,s.useState)(!1),A=v?(0,R.jsx)("label",{...B(),children:v}):null,E=_(),F=d?(0,R.jsx)("textarea",{...E,style:(0,a.mergeProps)(E.style,null!=i?i:{})}):(0,R.jsx)(w,{...E,cacheMeasurements:l,"data-hide-scroll":(0,a.dataAttr)(!O),maxRows:o,minRows:n,style:(0,a.mergeProps)(E.style,null!=i?i:{}),onHeightChange:(e,t)=>{1===n&&I(e>=2*t.rowHeight),o>n&&T(e>=o*t.rowHeight),null==c||c(e,t)}}),H=(0,s.useMemo)(()=>C?(0,R.jsx)("button",{...D(),children:(0,R.jsx)(k.CloseFilledIcon,{})}):null,[C,D]),W=(0,s.useMemo)(()=>h||g?(0,R.jsxs)("div",{...z(),children:[h,F,g]}):(0,R.jsx)("div",{...z(),children:F}),[h,E,g,z]),V=y&&j,K=V||m;return(0,R.jsxs)(f,{...S(),children:[x?A:null,(0,R.jsxs)("div",{...P(),"data-has-multiple-rows":(0,a.dataAttr)(U),children:[b?A:null,W,H]}),p&&K?(0,R.jsx)("div",{...L(),children:V?(0,R.jsx)("div",{...N(),children:j}):(0,R.jsx)("div",{...M(),children:m})}):null]})});B.displayName="HeroUI.Textarea";var _=B},3415,e=>{"use strict";e.s(["removeBook",()=>a]);var t=e.i(95187),a=(0,t.createServerReference)("4033b522ebeb1a2d79d42427dac8ee38fb7ff6c8e5",t.callServer,void 0,t.findSourceMapURL,"removeBook")},94358,e=>{"use strict";e.s(["saveBook",()=>a]);var t=e.i(95187),a=(0,t.createServerReference)("4034d4f9b4a0bce55f9f999f352b7f04e48c627097",t.callServer,void 0,t.findSourceMapURL,"saveBook")},22980,e=>{"use strict";e.s(["default",()=>C],22980);var t=e.i(43476),a=e.i(71645),r=e.i(35889),s=e.i(12041),i=e.i(24597),n=e.i(77148),o=e.i(64925),l=e.i(73665),d=e.i(71508),c=e.i(70319);function u(e){return(e=e.replace(/\s+/g," ").trim())?e.split(/(\s+|[.,!?;:\-â€”()"'â€œâ€â€žÂ«Â»â€¦])/).filter(e=>null!=e&&""!==e).filter(e=>e.trim().length>0||" "===e):[]}function f(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}var v=e.i(95187),m=(0,v.createServerReference)("60a7cf5dba0891e624e5cedd27b1f70241153b8f34",v.callServer,void 0,v.findSourceMapURL,"removeAudio"),h=(0,v.createServerReference)("707142c7e23c3e36f12ee3106812a99288fe0f71bd",v.callServer,void 0,v.findSourceMapURL,"saveAudio"),g=(0,v.createServerReference)("401218469ca26f3a848a312a5c84569cbd1a46ad72",v.callServer,void 0,v.findSourceMapURL,"removeSentence"),p=(0,v.createServerReference)("40f5266c6f2b7a67540c13b3ee0e1eccae835b54b5",v.callServer,void 0,v.findSourceMapURL,"saveSentence");function x(e){let{user_id:s,item:v,onUpdate:x,onDelete:b}=e,[y,j]=(0,a.useState)(!1),[S,w]=(0,a.useState)(!1),[k,R]=(0,a.useState)(v),[B,_]=(0,a.useState)(!1),z=(0,a.useRef)([]),P=(0,a.useRef)(null),L=async()=>{k.modified_fs&&k.audioBlob&&("success"===(await h(k.audioBlob,"reading","".concat(k.uuid,".wav"))).status?(c.toast.success("save audio success"),R({...k,modified_fs:!1})):c.toast.error("save audio failed")),k.modified_db&&("success"===(await p({...k,audio_path:"/api/data/reading/".concat(k.uuid,".wav"),created_by:s,created_at:k.created_at||new Date,updated_at:new Date})).status?(c.toast.success("save sentence success"),R({...k,modified_db:!1})):c.toast.error("save sentence failed")),x(k)},M=async()=>"success"!==(await m("reading","".concat(k.uuid,".wav"))).status?void c.toast.error("save audio failed"):(c.toast.success("save audio success"),"success"!==(await g(k.uuid)).status)?void c.toast.error("save sentence failed"):(c.toast.success("save sentence success"),void b(k.uuid));return(0,t.jsxs)("div",{className:"flex flex-col w-full gap-2 p-2 bg-sand-300",children:[(0,t.jsxs)("div",{className:"flex flex-col",children:[(0,t.jsx)("div",{className:"text-md text-gray-400",children:"recognized from audio:"}),(0,t.jsx)("div",{className:"text-xl",children:((e,a)=>{let r=u(e),s=u(a),{matchesB:i}=function(e,t){let a=e.length,r=t.length,s=Array.from({length:a+1},()=>Array(r+1).fill(0));for(let i=a-1;i>=0;i--)for(let a=r-1;a>=0;a--)e[i]===t[a]?s[i][a]=1+s[i+1][a+1]:s[i][a]=Math.max(s[i+1][a],s[i][a+1]);let i=0,n=0,o=[];for(;i<a&&n<r;)e[i]===t[n]?(o.push(n),i++,n++):s[i+1][n]>=s[i][n+1]?i++:n++;return{matchesB:o}}(r,s),n=new Set(i);return s.map((e,a)=>n.has(a)?(0,t.jsx)("span",{children:f(e)},a):(0,t.jsx)("span",{style:{background:"#ffeb3b"},children:f(e)},a))})(k.original,k.recognized)})]}),B?(0,t.jsx)(n.Textarea,{label:"original text",size:"lg",className:"w-full",classNames:{inputWrapper:"bg-sand-200",input:"text-xl"},defaultValue:k.original,onChange:e=>{R({...k,original:e.target.value,modified_db:!0}),x(k)}}):(0,t.jsxs)("div",{className:"flex flex-col",children:[(0,t.jsx)("div",{className:"text-md text-gray-400",children:"original text:"}),(0,t.jsx)("div",{className:"text-xl",children:k.original})]}),(0,t.jsxs)("div",{className:"flex flex-row items-center justify-start",children:[(0,t.jsx)("div",{className:"text-red-500 w-full",children:k.modified_db||k.modified_fs?"unsaved":""}),(0,t.jsx)(o.Tooltip,{placement:"bottom",content:"edit original",children:(0,t.jsx)(r.Button,{isIconOnly:!0,variant:"light",onPress:()=>_(!B),children:B?(0,t.jsx)(l.MdEditOff,{size:30}):(0,t.jsx)(l.MdEdit,{size:30})})}),(0,t.jsx)(o.Tooltip,{placement:"bottom",content:"save",children:(0,t.jsx)(r.Button,{isIconOnly:!0,variant:"light",onPress:L,children:(0,t.jsx)(l.MdOutlineSave,{size:30})})}),(0,t.jsx)(o.Tooltip,{placement:"bottom",content:"re-record",children:(0,t.jsx)(r.Button,{isIconOnly:!0,variant:"light",isDisabled:!y&&S,onPress:()=>{(0,d.toggleRecording)(y,j,z,P,!0,w,e=>{console.log(e)},(e,t)=>{"success"===e.status?(R({...k,recognized:e.data,audioBlob:t,modified_db:!0,modified_fs:!0}),x(k)):c.toast.error(e.error)})},children:y?(0,t.jsx)(l.MdMic,{size:30}):(0,t.jsx)(l.MdMicOff,{size:30})})}),(0,t.jsx)(o.Tooltip,{placement:"bottom",content:"play audio",children:(0,t.jsx)(r.Button,{isIconOnly:!0,variant:"light",onPress:()=>{new Audio(k.audioBlob?URL.createObjectURL(k.audioBlob):k.audio_path).play()},children:(0,t.jsx)(l.MdPlayCircle,{size:30})})}),(0,t.jsx)(o.Tooltip,{placement:"bottom",content:"download audio",children:(0,t.jsx)(r.Button,{isIconOnly:!0,variant:"light",as:i.Link,href:k.audioBlob?URL.createObjectURL(k.audioBlob):k.audio_path,download:"reading_".concat(k.uuid,".wav"),children:(0,t.jsx)(l.MdDownloadForOffline,{size:30})})}),(0,t.jsx)(o.Tooltip,{content:"delete",children:(0,t.jsx)(r.Button,{isIconOnly:!0,variant:"light",onPress:M,children:(0,t.jsx)(l.MdDelete,{size:30})})})]})]})}var b=e.i(75157),y=(0,v.createServerReference)("404e39daa266800bfab84af6a3ff8c8bb4b665070a",v.callServer,void 0,v.findSourceMapURL,"getBookAll"),j=e.i(3415),S=e.i(94358),w=e.i(212),k=e.i(56124),R=e.i(76220);function B(e){let{user_id:s,onSelect:i}=e,[n,o]=(0,a.useState)([]),[l,d]=(0,a.useState)(""),[u,f]=(0,a.useState)(!1),[v,m]=(0,a.useState)(!1),h=async()=>{let e=await y(s);"success"===e.status&&o(e.data)},g=async()=>{if(!s)return void c.toast.error("not logged in");m(!0),"success"===(await (0,S.saveBook)({uuid:(0,b.getUUID)(),user_id:s,name:l,created_by:s,created_at:new Date,updated_at:new Date})).status?(c.toast.success("save book success"),d("")):c.toast.error("save book failed"),m(!1)},p=async e=>{m(!0),"success"===(await (0,j.removeBook)(e)).status?c.toast.success("delete book success"):c.toast.error("delete book failed"),m(!1)};return(0,a.useEffect)(()=>{h()},[l]),(0,t.jsxs)("div",{className:"flex flex-col gap-1 w-full",children:[(0,t.jsx)(k.Select,{label:"Select book",onChange:async e=>{let t=e.target.value;await i(t)},children:n.map(e=>(0,t.jsx)(R.SelectItem,{textValue:e.name,children:e.name},e.uuid))}),(0,t.jsxs)("div",{className:"flex flex-row gap-1",children:[(0,t.jsx)(r.Button,{size:"sm",radius:"full",onPress:()=>f(!u),children:u?"finish":"edit"}),(0,t.jsx)(r.Button,{size:"sm",radius:"full",onPress:h,children:"refresh"})]}),u&&(0,t.jsxs)("div",{className:"flex flex-col gap-1 w-full",children:[(0,t.jsxs)("div",{className:"flex flex-row items-center justify-start gap-2",children:[(0,t.jsx)(w.Input,{label:"Name of Book",size:"sm",onChange:e=>d(e.target.value)}),(0,t.jsx)(r.Button,{size:"sm",radius:"full",isDisabled:v,onPress:g,children:"add"})]}),n.map(e=>(0,t.jsxs)("div",{className:"flex flex-row items-center justify-start px-2 gap-2 bg-sand-300",children:[e.name,(0,t.jsx)(r.Button,{size:"sm",radius:"full",onPress:()=>p(e.uuid),children:"delete"})]},e.uuid))]})]})}var _=(0,v.createServerReference)("407f93ffd293bb40245876d20b937dffb4f78fb3e9",v.callServer,void 0,v.findSourceMapURL,"getSentenceAll"),z=(0,v.createServerReference)("40ec7e8fdc94232e6bd976e3bbead4c41e1bc9e0cc",v.callServer,void 0,v.findSourceMapURL,"getChapterAll"),P=(0,v.createServerReference)("403e8dda2c014db1a9522ebc9af1bb1eb29bad6fc3",v.callServer,void 0,v.findSourceMapURL,"removeChapter"),L=(0,v.createServerReference)("408f391ab831c77f31a6c2112a8ba200423efa97e3",v.callServer,void 0,v.findSourceMapURL,"saveChapter");function M(e){let{user_id:s,book_uuid:i,onSelect:n}=e,[o,l]=(0,a.useState)([]),[d,u]=(0,a.useState)(""),[f,v]=(0,a.useState)(""),[m,h]=(0,a.useState)(!1),[g,p]=(0,a.useState)(!1),x=async()=>{let e=await z(i);"success"===e.status&&l(e.data)},y=async()=>s?i?void(p(!0),"success"===(await L({uuid:(0,b.getUUID)(),book_uuid:i,order_num:parseInt(d,10),name:f,created_by:s,created_at:new Date,updated_at:new Date})).status?(c.toast.success("save chapter success"),v("")):c.toast.error("save chapter failed"),p(!1)):void c.toast.error("no book selected"):void c.toast.error("not logged in"),j=async e=>{p(!0),"success"===(await P(e)).status?c.toast.success("delete chapter success"):c.toast.error("delete chapter failed"),p(!1)};return(0,a.useEffect)(()=>{x()},[i,f]),(0,t.jsxs)("div",{className:"flex flex-col gap-1 w-full",children:[(0,t.jsx)(k.Select,{label:"Select chapter",onChange:async e=>{let t=e.target.value;await n(t)},children:o.map(e=>(0,t.jsxs)(R.SelectItem,{textValue:"".concat(e.order_num,", ").concat(e.name),children:[e.order_num,", ",e.name]},e.uuid))}),(0,t.jsxs)("div",{className:"flex flex-row gap-1",children:[(0,t.jsx)(r.Button,{size:"sm",radius:"full",onPress:()=>h(!m),children:m?"finish":"edit"}),(0,t.jsx)(r.Button,{size:"sm",radius:"full",onPress:x,children:"refresh"})]}),m&&(0,t.jsxs)("div",{className:"flex flex-col gap-1 w-full",children:[(0,t.jsxs)("div",{className:"flex flex-row items-center justify-start gap-2",children:[(0,t.jsx)(w.Input,{label:"Order",type:"number",size:"sm",className:"w-1/5",onChange:e=>u(e.target.value)}),(0,t.jsx)(w.Input,{label:"Name of Book",size:"sm",onChange:e=>v(e.target.value)}),(0,t.jsx)(r.Button,{size:"sm",radius:"full",isDisabled:g,onPress:y,children:"add"})]}),o.map(e=>(0,t.jsxs)("div",{className:"flex flex-row items-center justify-start gap-2 bg-sand-300",children:[e.order_num," - ",e.name,(0,t.jsx)(r.Button,{size:"sm",radius:"full",onPress:()=>j(e.uuid),children:"delete"})]},e.uuid))]})]})}var N=e.i(47264);function C(e){let{email:i}=e,[n,o]=(0,a.useState)(""),[l,u]=(0,a.useState)(""),[f,v]=(0,a.useState)(!1),[m,g]=a.default.useState(!1),[y,j]=(0,a.useState)([]),[S,w]=a.default.useState(!1),[k,R]=a.default.useState(!1),z=(0,a.useRef)([]),P=(0,a.useRef)(null),L=async e=>{R(!0);let t=await _(e);"success"===t.status&&j(t.data.map(e=>({...(0,b.toExactType)(e),modified_db:!1,modified_fs:!1}))),R(!1)},C=e=>{j(t=>t.map(t=>t.uuid===e.uuid?e:t))},D=e=>{j(t=>t.filter(t=>t.uuid!==e))},U=async()=>{try{await Promise.all(y.map(async(e,t)=>{if(e.modified_fs&&e.audioBlob){let t=await h(e.audioBlob,"reading","".concat(e.uuid,".wav"));if("error"===t.status)throw Error("save audio failed");j(t=>t.map(t=>t.uuid===e.uuid?{...t,modified_fs:!1}:t))}if(e.modified_db){let a=await p({uuid:e.uuid,chapter_uuid:l,order_num:t,original:e.original,recognized:e.recognized,audio_path:"/api/data/reading/".concat(e.uuid,".wav"),created_by:i,created_at:e.created_at||new Date,updated_at:new Date});if("error"===a.status)throw Error("save sentence failed");j(t=>t.map(t=>t.uuid===e.uuid?{...t,modified_db:!1}:t))}return!0})),c.toast.success("All sentences saved successfully!")}catch(e){c.toast.error(e.message||"Failed to save sentences")}},I=async()=>{w(await (0,N.checkSTTServiceStatus)())};return(0,a.useEffect)(()=>{let e=e=>{if(e.ctrlKey&&"y"===e.key){e.preventDefault();let t=document.getElementById("button-toggel-recording");null==t||t.click()}};document.addEventListener("keydown",e),I();let t=setInterval(I,3e4);return()=>{clearInterval(t),window.removeEventListener("keydown",e)}},[f,m]),(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"flex flex-row gap-4 my-2",children:(0,t.jsxs)(r.Button,{size:"sm",variant:"solid",color:S?"success":"danger",onPress:I,children:["Speech-to-Text service is ",S?"available":"not available",", click to refresh"]})}),(0,t.jsxs)("div",{className:"flex flex-row gap-4 my-2",children:[(0,t.jsx)(B,{user_id:i,onSelect:async e=>{o(e)}}),(0,t.jsx)(M,{user_id:i,book_uuid:n,onSelect:async e=>{u(e),await L(e)}})]}),(0,t.jsxs)("div",{className:"flex flex-row items-center justify-center gap-4 my-2",children:[(0,t.jsx)(r.Button,{variant:"solid",color:"primary",id:"button-toggel-recording",isDisabled:!f&&m,onPress:()=>{n&&l?(0,d.toggleRecording)(f,v,z,P,S,g,e=>{console.log(e)},(e,t)=>{"success"===e.status?j(a=>[...a,{uuid:(0,b.getUUID)(),chapter_uuid:"",order_num:y.length,original:e.data,recognized:e.data,audioBlob:t,modified_db:!0,modified_fs:!0}]):c.toast.error(e.error)}):alert("select book and chapter first")},children:f?"â¹ Stop Recording (Ctrl+Y)":"ðŸŽ¤ Speak a Sentence (Ctrl+Y)"}),(0,t.jsx)(r.Button,{variant:"solid",color:"primary",onPress:U,children:"save all sentences"})]}),k&&(0,t.jsx)(s.Spinner,{classNames:{label:"text-foreground mt-4"},variant:"simple"}),y.length>0&&(0,t.jsx)("div",{className:"flex flex-col items-start justify-start w-full gap-2 my-8",children:[...y].reverse().map(e=>(0,t.jsx)(x,{user_id:i,item:e,onUpdate:C,onDelete:D},e.uuid))})]})}},75977,e=>{e.v(t=>Promise.all(["static/chunks/1301d5d9c51b8254.js"].map(t=>e.l(t))).then(()=>t(40588)))}]);